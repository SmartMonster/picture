<head><meta charset="utf-8"><meta name="Keywords" content="极客时间,极客邦,极客邦科技,极客邦控股,极客时间App,专栏订阅,极客新闻,二叉树,极客Live,QCon,左耳听风,AI技术内参,大航海时代,陈皓,徐飞,洪亮劼,霍泰稳,池建强,Selina,Gary,InfoQ,极客搜索"><meta name="description" content="极客时间是极客邦科技出品的一款 IT 内容知识服务 App，内容包含专栏订阅、极客新闻、热点专题、直播、视频和音频等多形式的知识内容，并设有陈皓专栏、徐飞专栏、洪亮劼专栏等专栏供订阅。"><link rel="apple-touch-icon" sizes="180x180" href="//static001.geekbang.org/static/icon/time/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="//static001.geekbang.org/static/icon/time/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="//static001.geekbang.org/static/icon/time/favicon-16x16.png"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,viewport-fit=cover"><meta name="format-detection" content="telephone=no"><title>极客时间 | 02  | 日志系统：一条SQL更新语句是如何执行的？</title><script src="https://hm.baidu.com/hm.js?022f847c4e3acd44d4a2481d9187f1e6"></script><script async="" src="https://www.google-analytics.com/analytics.js"></script><script type="text/javascript" async="" src="https://s1.pstatp.com/bytecom/resource/track_log/src/toutiao-track-log.js"></script><script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.3.2.js"></script><script type="text/javascript" src="//at.alicdn.com/t/font_372689_nw1guejwd2q.js"></script><script type="text/javascript">if(!('flex' in document.documentElement.style) && !navigator.userAgent.match(/spider|googlebot|bingbot|geekbang|yahoo! Slurp/i)){
        window.location.href = 'https://static001.geekbang.org/static/common/browser_update/index.html'
      }</script><script type="text/javascript">;(function(root) {
        root._tt_config = true;
        var ta = document.createElement('script'); ta.type = 'text/javascript'; ta.async = true;
        ta.src = document.location.protocol + '//' + 's1.pstatp.com/bytecom/resource/track_log/src/toutiao-track-log.js';
        ta.onerror = function () {
            var request = new XMLHttpRequest();
            var web_url = window.encodeURIComponent(window.location.href);
            var js_url  = ta.src;
            var url = '//ad.toutiao.com/link_monitor/cdn_failed?web_url=' + web_url + '&js_url=' + js_url + '&convert_id=1606932352132152';
            request.open('GET', url, true);
            request.send(null);
        }
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ta, s);
      })(window);</script><link href="https://static001.geekbang.org/static/time/css/app.ba234b84d2a03d8399088e4f3c67606c.css" rel="stylesheet"><style type="text/css" abt="234"></style><script>//remove 17173 video ad
doAdblock();
function doAdblock(){
    (function() {
        function A() {}
        A.prototype = {
            rules: {
                '17173_in':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/PreloaderFile(Customer)?\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_in_20150522.swf"
                },
                '17173_out':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/PreloaderFileFirstpage\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_out_20150522.swf"
                },
                '17173_live':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/Player_stream(_firstpage)?\.swf/,
                    'replace':"http://swf.adtchrome.com/17173_stream_20150522.swf"
                },
                '17173_live_out':{
                    'find':/http:\/\/f\.v\.17173cdn\.com\/(\d+\/)?flash\/Player_stream_(custom)?Out\.swf/,
                    'replace':"http://swf.adtchrome.com/17173.out.Live.swf"
                }
            },
            _done: null,
            get done() {
                if(!this._done) {
                    this._done = new Array();
                }
                return this._done;
            },
            addAnimations: function() {
                var style = document.createElement('style');
                style.type = 'text/css';
                style.innerHTML = 'object,embed{\
                -webkit-animation-duration:.001s;-webkit-animation-name:playerInserted;\
                -ms-animation-duration:.001s;-ms-animation-name:playerInserted;\
                -o-animation-duration:.001s;-o-animation-name:playerInserted;\
                animation-duration:.001s;animation-name:playerInserted;}\
                @-webkit-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @-ms-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @-o-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}\
                @keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}';
                document.getElementsByTagName('head')[0].appendChild(style);
            },
            animationsHandler: function(e) {
                if(e.animationName === 'playerInserted') {
                    this.replace(e.target);
                }
            },
            replace: function(elem) {
                if(this.done.indexOf(elem) != -1) return;
                this.done.push(elem);
                var player = elem.data || elem.src;
                if(!player) return;
                var i, find, replace = false;
                for(i in this.rules) {
                    find = this.rules[i]['find'];
                    if(find.test(player)) {
                        replace = this.rules[i]['replace'];
                        if('function' === typeof this.rules[i]['preHandle']) {
                            this.rules[i]['preHandle'].bind(this, elem, find, replace, player)();
                        }else{
                            this.reallyReplace.bind(this, elem, find, replace)();
                        }
                        break;
                    }
                }
            },
            reallyReplace: function(elem, find, replace) {
                elem.data && (elem.data = elem.data.replace(find, replace)) || elem.src && ((elem.src = elem.src.replace(find, replace)) && (elem.style.display = 'block'));
                var b = elem.querySelector("param[name='movie']");
                this.reloadPlugin(elem);
            },
            reloadPlugin: function(elem) {
                var nextSibling = elem.nextSibling;
                var parentNode = elem.parentNode;
                parentNode.removeChild(elem);
                var newElem = elem.cloneNode(true);
                this.done.push(newElem);
                if(nextSibling) {
                    parentNode.insertBefore(newElem, nextSibling);
                } else {
                    parentNode.appendChild(newElem);
                }
            },
            init: function() {
                var handler = this.animationsHandler.bind(this);
                document.body.addEventListener('webkitAnimationStart', handler, false);
                document.body.addEventListener('msAnimationStart', handler, false);
                document.body.addEventListener('oAnimationStart', handler, false);
                document.body.addEventListener('animationstart', handler, false);
                this.addAnimations();
            }
        };
        new A().init();
    })();
}
//remove baidu search ad
if(document.URL.indexOf('www.baidu.com') >= 0){
    if(document && document.getElementsByTagName && document.getElementById && document.body){
        var aa = function(){
            var all = document.body.querySelectorAll("#content_left div,#content_left table");
            for(var i = 0; i < all.length; i++){
                if(/display:\s?(table|block)\s!important/.test(all[i].getAttribute("style"))){all[i].style.display= "none";all[i].style.visibility='hidden';}
            }
            all = document.body.querySelectorAll('.result.c-container[id="1"]');
            //if(all.length == 1) return;
            for(var i = 0; i < all.length; i++){
                if(all[i].innerHTML && all[i].innerHTML.indexOf('广告')>-1){
                    all[i].style.display= "none";all[i].style.visibility='hidden';
                }
            }
        }
        aa();
        document.getElementById('wrapper_wrapper').addEventListener('DOMSubtreeModified',aa)
    };
}
//remove sohu video ad
if (document.URL.indexOf("tv.sohu.com") >= 0){
    if (document.cookie.indexOf("fee_status=true")==-1){document.cookie='fee_status=true'};
}
//remove 56.com video ad
if (document.URL.indexOf("56.com") >= 0){
    if (document.cookie.indexOf("fee_status=true")==-1){document.cookie='fee_status=true'};
}
//fore iqiyi enable html5 player function
if (document.URL.indexOf("iqiyi.com") >= 0){
    if (document.cookie.indexOf("player_forcedType=h5_VOD")==-1){
        document.cookie='player_forcedType=h5_VOD'
        if(localStorage.reloadTime && Date.now() - parseInt(localStorage.reloadTime)<60000){
            console.log('no reload')
        }else{
            location.reload()
            localStorage.reloadTime = Date.now();
        }
    }
}
</script><style type="text/css">object,embed{                -webkit-animation-duration:.001s;-webkit-animation-name:playerInserted;                -ms-animation-duration:.001s;-ms-animation-name:playerInserted;                -o-animation-duration:.001s;-o-animation-name:playerInserted;                animation-duration:.001s;animation-name:playerInserted;}                @-webkit-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-ms-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @-o-keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}                @keyframes playerInserted{from{opacity:0.99;}to{opacity:1;}}</style><style type="text/css">.hljs-ln{border-collapse:collapse}.hljs-ln td{padding:0}.hljs-ln-n:before{content:attr(data-line-number)}</style><style type="text/css">.d4s24Cak_0{background:#000}._2XuSxNZp_0{opacity:0}.Wc3vzb2A_0{opacity:1}._2iHgUKTE_0{max-width:46.25rem;min-height:100vh;margin:0 auto;background:#fff;-webkit-transition:background-color .3s ease;transition:background-color .3s ease}._2iHgUKTE_0 ._2Q4AqmzS_0{color:#888}._2iHgUKTE_0 ._2Q4AqmzS_0,._2iHgUKTE_0 ._24aDcC1__0{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;height:35px;display:inline-block;font-size:15px;text-align:center;line-height:36px}._2iHgUKTE_0 ._24aDcC1__0{color:#fff;background-color:#fa8919;font-weight:500}._2iHgUKTE_0 ._2_jLRfDz_0{padding-left:22px;padding-right:22px}._2iHgUKTE_0 ._3h_65ACq_0{color:#fa8919;font-size:15px;font-weight:600;line-height:24px;border-radius:5px;padding:12px;background-color:#f6f7fb;margin-top:20px}._2iHgUKTE_0 ._3h_65ACq_0 ._1_J2p49N_0{font-size:12px}._2iHgUKTE_0 .yXXuK9Bz_0{padding-top:25px;padding-bottom:52px}._2iHgUKTE_0 ._3QuafcgX_0{color:#353535;font-weight:700;line-height:30px;font-size:22px}._2iHgUKTE_0 ._2dsK9OZI_0{color:#999;font-size:14px;font-weight:500;margin-top:5px;margin-bottom:10px}._2iHgUKTE_0 ._1dC78n85_0.PlJBpIgH_0 video-webkit-media-controls-fullscreen-button{display:none}._2iHgUKTE_0 ._1hOtWUmw_0{border-radius:6px;vertical-align:top;margin-bottom:24px;width:100%}._2iHgUKTE_0 ._2qqGfSEe_0{margin-top:24px}._2iHgUKTE_0 ._1fMbLOUg_0{color:#b2b2b2;padding-bottom:20px;font-size:13px;font-weight:400}._2iHgUKTE_0 ._1fMbLOUg_0 ._3suBPDWW_0{font-size:15px}._2iHgUKTE_0 .JDGVVLCG_0{width:100%;margin:20px 0}._2iHgUKTE_0 ._2xLk5jLr_0{overflow:hidden;padding-top:10px;margin-bottom:-30px}._2iHgUKTE_0 ._2xLk5jLr_0 a._24aDcC1__0{float:right;height:20px;font-size:12px;line-height:20px;padding:4px 8px;cursor:pointer}._2iHgUKTE_0 .DU0gW1Le_0{padding-top:32px;border-top:10px solid #f6f7fb;-webkit-transition:border-top .3s ease;transition:border-top .3s ease;position:relative}._2iHgUKTE_0 .DU0gW1Le_0 h2{color:#353535;position:relative;z-index:1;margin-bottom:1rem;font-weight:700;font-size:19px}._2iHgUKTE_0 .DU0gW1Le_0 .kZAdYTZh_0{font-size:16px;margin-left:5px}._2iHgUKTE_0 ._3XC20_-x_0{position:absolute;z-index:2;background:#fa8919;font-size:13px;color:#fff;text-align:center;height:28px;width:80px;line-height:28px;-webkit-box-shadow:4px 5px 20px 1px rgba(250,137,25,.24);box-shadow:4px 5px 20px 1px rgba(250,137,25,.24);border-radius:28px;right:22px;top:32px}._2iHgUKTE_0 ._3qEE98dE_0{z-index:10;cursor:pointer}._2iHgUKTE_0 ._3PNMKN7j_0{cursor:pointer;padding-top:24px;padding-bottom:24px;position:relative}._2iHgUKTE_0 ._3PNMKN7j_0:before{content:" ";height:.5px;background:#e8e8e8;position:absolute;top:0;left:0;-webkit-box-sizing:border-box;box-sizing:border-box;left:22px;right:22px}._2iHgUKTE_0 ._3PNMKN7j_0 ._2d0QwC3-_0{height:38px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}._2iHgUKTE_0 ._3PNMKN7j_0 ._2d0QwC3-_0 ._36LfGj1s_0{-webkit-box-flex:0;-ms-flex:0 0 62px;flex:0 0 62px;text-align:center;color:#888;font-size:14px;border-radius:10px;height:22px;line-height:22px;background:#f6f7fb;font-weight:400}._2iHgUKTE_0 ._3PNMKN7j_0 ._2d0QwC3-_0 ._3TIVUaKt_0{margin-left:10px;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;color:#888;font-size:15px;height:22px;line-height:22px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;font-weight:400}._2TWMGtY9_0{height:60px;background:transparent}._3Qjp-kmf_0{font-size:15px;color:#888;line-height:24px;border-left:3px solid #e8e8e8;padding-left:15px}._2XiJsOMl_0,.EVkpJjEr_0{-webkit-transition:all .3s ease;transition:all .3s ease}._2Nz371_y_0 ._1HRajYpk_0,._321aphJv_0 ._2GrpjiZ7_0{-webkit-transform:translateX(-508px);transform:translateX(-508px)}._2Nz371_y_0 ._2GrpjiZ7_0,._321aphJv_0 ._1HRajYpk_0{-webkit-transform:translateX(508px);transform:translateX(508px)}.PlJBpIgH_0 ._2dsK9OZI_0{font-weight:700}.PlJBpIgH_0 ._3PNMKN7j_0:before{height:1px}@media only screen and (max-width:769px){._15MzZzCR_0{display:none!important}}@media only screen and (min-width:740px){.d4s24Cak_0{background:#fff}}._9Z9oach0_0{background:#f6f0e0}._9Z9oach0_0 .DU0gW1Le_0{border-top:10px solid #efe6cf}._9Z9oach0_0 ._3PNMKN7j_0:before{background:#e5d8b5}._9Z9oach0_0 ._3PNMKN7j_0 ._2d0QwC3-_0 ._36LfGj1s_0{background:#efe6cf}._9Z9oach0_0 ._3h_65ACq_0{background-color:#efe6cf}._3Xivw4-f_0{background:#353535}._3Xivw4-f_0 ._2dsK9OZI_0,._3Xivw4-f_0 ._3QuafcgX_0{color:silver}._3Xivw4-f_0 .DU0gW1Le_0{border-top:10px solid #3e3e3e}._3Xivw4-f_0 ._3PNMKN7j_0:before{background:#4c4c4c}._3Xivw4-f_0 ._3PNMKN7j_0 ._2d0QwC3-_0 ._36LfGj1s_0{background:#3e3e3e;color:silver}._3Xivw4-f_0 ._3PNMKN7j_0 ._2d0QwC3-_0 ._3TIVUaKt_0,._3Xivw4-f_0 .DU0gW1Le_0 h2{color:silver}._3Xivw4-f_0 ._3h_65ACq_0{background-color:#3e3e3e}.KPNfF2Ub_0{margin-bottom:24px}.SHMajuUT_0{padding-top:40px!important;padding-bottom:82px!important}._2HYUpEDK_0{position:fixed;top:0;bottom:0;width:100%;z-index:-1}</style><style type="text/css">.C3Euvro5_0{height:58px}._1mmSdAtq_0{width:100%;height:58px;background:#fbfbfb;position:absolute;top:0;left:0;z-index:20;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0 22px;-webkit-transition:opacity .35s;transition:opacity .35s;opacity:0;pointer-events:none;-webkit-box-shadow:0 2px 3px 0 hsla(0,0%,89%,.38);box-shadow:0 2px 3px 0 hsla(0,0%,89%,.38)}._1mmSdAtq_0 a{width:76px;height:30px;text-align:center;border-radius:15px;font-size:13px;background:#fa8919;color:#fff;line-height:30px;font-weight:500}._3J4dp-oG_0{opacity:1;pointer-events:auto}.Qmt5mthp_0{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:start;-ms-flex-pack:start;justify-content:flex-start}.Qmt5mthp_0 i{width:40px;height:40px;background-image:url("http://static001.geekbang.org/static/icon/time/apple-touch-icon.png");background-position:0 0;background-repeat:no-repeat;background-size:contain;border-radius:8px;-webkit-box-shadow:0 0 3px 0 hsla(0,0%,89%,.38);box-shadow:0 0 3px 0 hsla(0,0%,89%,.38)}.Qmt5mthp_0 h2{font-size:16px;color:#595757;font-weight:500;margin-left:16px}.Qmt5mthp_0 h2 span{font-weight:400;font-size:13px;color:#888}</style><style type="text/css">._3HCtER94_0{height:30px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding-left:18px;padding-right:22px;font-size:15px;color:#888;padding-top:20px}.XPK3khh7_0{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;font-size:17px;font-weight:400}.u9KJ6z9x_0{width:16px;font-size:12px;text-align:left;margin-right:4px}.S8msnNlD_0{-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;font-weight:400}._3FTQNYev_0{width:20px;text-align:center;display:inline-block;vertical-align:top}</style><style type="text/css">._1Bg5E78Y_0{width:100%;height:60px;background:#fff;-webkit-transition:background-color .3s ease;transition:background-color .3s ease;-webkit-box-sizing:border-box;box-sizing:border-box;padding-left:18px;padding-right:12px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;border-radius:6px 30px 30px 6px;-webkit-box-shadow:0 3px 25px 4px rgba(140,163,191,.14);box-shadow:0 3px 25px 4px rgba(140,163,191,.14)}._1Bg5E78Y_0 ._2Ha38TVL_0{border-radius:50%;width:40px;height:40px;-webkit-box-shadow:0 1px 3px 2px rgba(0,0,0,.1);box-shadow:0 1px 3px 2px rgba(0,0,0,.1);position:relative}._1Bg5E78Y_0 ._1iA2uC1V_0{background-repeat:no-repeat;background-position:0 0;background-size:300px;background-color:#fff;border-radius:50%;width:40px;height:40px;position:absolute;top:0;left:0}._1Bg5E78Y_0 ._1WF5YSBJ_0{background:rgba(0,0,0,.15)}._1Bg5E78Y_0 ._2Kms_g0F_0{width:40px;height:40px;line-height:40px;text-align:center;border-radius:50%;z-index:2;position:relative}._1Bg5E78Y_0 .MH1rcCm7_0 ._2Kms_g0F_0{color:#fff;margin-left:2px}._1Bg5E78Y_0 ._1KuRDTHn_0 ._2Kms_g0F_0{color:#fff}._1Bg5E78Y_0 .MH1rcCm7_0 ._1iA2uC1V_0{-webkit-animation:HvzpPu2i_0 4s linear infinite;animation:HvzpPu2i_0 4s linear infinite;-webkit-animation-play-state:paused;animation-play-state:paused}._1Bg5E78Y_0 ._1KuRDTHn_0 ._1iA2uC1V_0{-webkit-animation:HvzpPu2i_0 4s linear infinite;animation:HvzpPu2i_0 4s linear infinite;-webkit-animation-play-state:running;animation-play-state:running}._1Bg5E78Y_0 ._1qj_iPD7_0{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;margin-right:10px}._1Bg5E78Y_0 ._1qj_iPD7_0 h3{color:#353535;font-size:15.25px;margin:0;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}._1Bg5E78Y_0 ._1qj_iPD7_0 p{margin:0;margin-top:.125rem;font-size:12px;font-weight:500;line-height:1rem;color:#999}._1Bg5E78Y_0 ._3PhVtlEa_0{width:20px;height:20px;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;position:relative;color:#999;font-size:18px;line-height:20px;text-align:center;margin-right:20px}._1Bg5E78Y_0 ._1l6e3976_0{width:10px;height:10px;line-height:10px;text-align:center;position:absolute;bottom:-3px;right:-5px;color:#fa8919;background:#fff;font-size:10px;-webkit-transition:background-color .2s ease;transition:background-color .2s ease}._1W0qSnju_0{-webkit-box-shadow:0 3px 25px 4px hsla(42,28%,65%,.14);box-shadow:0 3px 25px 4px hsla(42,28%,65%,.14)}._1W0qSnju_0,._1W0qSnju_0 ._1l6e3976_0{background:#f6f0e0}._1W0qSnju_0 ._2Ha38TVL_0{-webkit-box-shadow:0 1px 2px 2px hsla(42,28%,65%,.14);box-shadow:0 1px 2px 2px hsla(42,28%,65%,.14)}._2SRR-E_O_0{background:#4d4d4d;-webkit-box-shadow:none;box-shadow:none}._2SRR-E_O_0 ._3PhVtlEa_0{color:#fff}._2SRR-E_O_0 ._1l6e3976_0{background:#4d4d4d}._2SRR-E_O_0 ._1qj_iPD7_0 h3,._2SRR-E_O_0 ._1qj_iPD7_0 p{color:silver}._2vBNygJQ_0 ._1qj_iPD7_0 p{font-weight:700}@-webkit-keyframes HvzpPu2i_0{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}@keyframes HvzpPu2i_0{to{-webkit-transform:rotate(1turn);transform:rotate(1turn)}}</style><style type="text/css">._29HP61GA_0{font-weight:400;color:#353535;line-height:1.76;white-space:normal;word-break:normal;font-size:17px;-webkit-transition:background-color .3s ease;transition:background-color .3s ease}._29HP61GA_0 .MathJax_Display{overflow:auto}._29HP61GA_0 .poster{position:fixed;left:-10000px;top:-10000px;overflow:hidden;padding:1rem;background:#ececec}._29HP61GA_0 .richcontent-pre-copy{font-size:13px;color:#888;position:absolute;right:1em;top:.5em;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}._29HP61GA_0 .richcontent-pre-copy .iconfont{font-size:12px;margin-right:.2em}._29HP61GA_0 a{color:#fa8919;border-bottom:1px solid #fa8919}._29HP61GA_0 img{display:block;max-width:100%;position:relative;left:50%;-webkit-transform:translateX(-50%);transform:translateX(-50%);background-color:#eee;vertical-align:top;border-radius:0}._29HP61GA_0 audio,._29HP61GA_0 video{width:100%;background-color:#eee}._29HP61GA_0 pre{margin-top:16px;padding:34px 0 30px;margin-bottom:30px;position:relative;overflow:hidden;border-radius:6px;background:rgba(246,247,251,.749);border:0}._29HP61GA_0 pre code{font-size:12px;font-family:Consolas,Liberation Mono,Menlo,monospace,Courier;display:block;-webkit-box-sizing:border-box;box-sizing:border-box;margin-left:16px;margin-right:16px;overflow-x:auto}._29HP61GA_0 hr{border:none;margin-top:1.5rem;margin-bottom:1.5rem;border-top:1px solid #f5f5f5;height:1px;background:none}._29HP61GA_0 h1,._29HP61GA_0 h2,._29HP61GA_0 h3,._29HP61GA_0 h4,._29HP61GA_0 h5{margin-bottom:20px;margin-top:0;font-weight:700}._29HP61GA_0 b,._29HP61GA_0 strong{font-weight:700}._29HP61GA_0 h1{font-size:21px}._29HP61GA_0 h2{font-size:20px}._29HP61GA_0 h3{font-size:19px}._29HP61GA_0 h4{font-size:18px}._29HP61GA_0 h5{font-size:17px}._29HP61GA_0 p{font-weight:400;color:#353535;margin-top:0;margin-bottom:30px;word-break:break-word}._29HP61GA_0 blockquote{margin-top:0;margin-bottom:34px;border-left:3px solid #e8e8e8;padding-left:17px;color:#353535}._29HP61GA_0 blockquote p{margin-top:0;margin-bottom:0}._29HP61GA_0 ol,._29HP61GA_0 ul{margin-bottom:30px}._29HP61GA_0 ol p,._29HP61GA_0 ul p{margin-top:0;margin-bottom:0}._29HP61GA_0 ol{list-style:decimal;margin-left:20px}._29HP61GA_0 ul li{padding-left:17px;position:relative;margin-bottom:10px}._29HP61GA_0 ul li:after{content:"";height:6px;width:6px;border-radius:50%;background:#353535;position:absolute;top:10px;left:0}._29HP61GA_0 .orange{color:#fa8919}._29HP61GA_0 .reference{color:#888}._29HP61GA_0 table.hljs-ln{margin-bottom:0;border-spacing:0;border-collapse:collapse}._29HP61GA_0 table.hljs-ln,._29HP61GA_0 table.hljs-ln tbody,._29HP61GA_0 table.hljs-ln td,._29HP61GA_0 table.hljs-ln tr{-webkit-box-sizing:border-box;box-sizing:border-box}._29HP61GA_0 table.hljs-ln td{padding:0;border:0}._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers{min-width:15px;font-size:12px;color:rgba(27,31,35,.3);text-align:right;white-space:nowrap;cursor:pointer;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}._29HP61GA_0 table.hljs-ln td.hljs-ln-code,._29HP61GA_0 table.hljs-ln td.hljs-ln-numbers{font-family:SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;line-height:20px;vertical-align:top}._29HP61GA_0 table.hljs-ln td.hljs-ln-code{position:relative;padding-right:10px;padding-left:10px;overflow:visible;font-size:13px;color:#666;word-wrap:normal;white-space:pre}._2gMcXXSK_0{font-size:15px}._2gMcXXSK_0 h1{font-size:19px}._2gMcXXSK_0 h2{font-size:18px}._2gMcXXSK_0 h3{font-size:17px}._2gMcXXSK_0 h4{font-size:16px}._2gMcXXSK_0 h5{font-size:15px}._2gMcXXSK_0 p{margin-bottom:26px}._2gMcXXSK_0 blockquote{margin-bottom:30px}._2gMcXXSK_0 ol,._2gMcXXSK_0 ul{margin-bottom:26px}._1-IhkAAb_0{font-size:19px}._1-IhkAAb_0 h1{font-size:23px}._1-IhkAAb_0 h2{font-size:22px}._1-IhkAAb_0 h3{font-size:21px}._1-IhkAAb_0 h4{font-size:20px}._1-IhkAAb_0 h5{font-size:19px}._1Xjr5LRK_0 table.hljs-ln td.hljs-ln-code,._1Xjr5LRK_0 table.hljs-ln td.hljs-ln-numbers{font-family:monospace}._1XhbM4Sp_0 pre{background:hsla(43,50%,87%,.749)}._1XhbM4Sp_0 blockquote{border-color:#efe6cf}._2wERfXHe_0 h1,._2wERfXHe_0 h2,._2wERfXHe_0 h3,._2wERfXHe_0 h4,._2wERfXHe_0 h5,._2wERfXHe_0 p{color:silver}._2wERfXHe_0 blockquote{border-color:#3e3e3e}._2wERfXHe_0 li,._2wERfXHe_0 strong{color:silver}._2wERfXHe_0 pre{background:rgba(62,62,62,.749)}._2wERfXHe_0 img{opacity:.9}._2wERfXHe_0 ul li:after{background:silver}._2wERfXHe_0 table.hljs-ln td.hljs-ln-numbers{color:#b2b2b2}._2wERfXHe_0 table.hljs-ln td.hljs-ln-code{color:silver}</style><style type="text/css">.reJj6Thl_0{list-style-position:inside;width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;margin-top:40px}.reJj6Thl_0 a{border-bottom:none}.reJj6Thl_0 ._2273kGdT_0{width:35px;height:35px;-ms-flex-negative:0;flex-shrink:0;border-radius:50%}.reJj6Thl_0:last-child ._2CG0SquK_0{border-bottom:none}.reJj6Thl_0 ._2CG0SquK_0{margin-left:.5rem;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;padding-bottom:25px;border-bottom:.5px solid #e8e8e8;-webkit-transition:border-bottom .3s ease;transition:border-bottom .3s ease;overflow:hidden}.reJj6Thl_0 ._2CG0SquK_0 ._304R4gla_0{width:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding-bottom:10px}.reJj6Thl_0 ._2CG0SquK_0 ._3M6kV3zb_0{color:#4c4c4c;font-size:16px;font-weight:400;white-space:normal;word-break:normal;line-height:1.6;overflow:hidden;display:-webkit-box;-webkit-line-clamp:5;-webkit-box-orient:vertical}.reJj6Thl_0 ._2CG0SquK_0 ._3D2NkqD6_0{overflow:auto;-webkit-line-clamp:unset}.reJj6Thl_0 ._2CG0SquK_0 ._1H1Z49Dr_0{color:#888;font-size:11px;line-height:1;margin-top:4px}.reJj6Thl_0 ._2CG0SquK_0 ._18Dng5rT_0{color:#353535;font-size:14px;font-weight:700;height:20px;line-height:20px}.reJj6Thl_0 ._1bkbsnjg_0{height:15px;line-height:15px;width:30px;overflow:hidden;font-size:10px;color:#fff;background:#cbcbcb;text-align:center;display:inline-block;border-radius:3px;vertical-align:top;margin-top:2px}.reJj6Thl_0 ._2eMTs2JE_0{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:26px}.reJj6Thl_0 ._1YQBH3WC_0{color:#999;font-size:13px;margin-left:42px;width:20px;text-align:center}.reJj6Thl_0 ._13n1j2Zp_0{color:#999;font-size:11px;width:20px;margin-left:38px;text-align:center}.reJj6Thl_0 ._2P4B1Hdm_0{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;font-size:15.25px;text-decoration:none}.reJj6Thl_0 ._2P4B1Hdm_0 i{color:#999;display:inline-block;font-size:15px;margin-right:4px;height:27px;width:15px;margin-top:-2px}.reJj6Thl_0 ._2P4B1Hdm_0 i._2A421P4G_0{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAtCAYAAADV2ImkAAAF3ElEQVRoQ82ZeYwcxRXGv696umfWB47N7s7MGmIwwVyCCJxDQRbiCAJxSBCEIZIBKeGKHAMC1jN2BAwEdmYMBv7gBiMOEQICETDEXAoxiREgQMICoigKBFl4e3eJY3vxbs/0dH9RzzQYW7sw3jXQ/Wd31atfvX5V9d5XxCSe+sruH8o3d5OYD3ALoXUEHh4NsHb6cndoEqbH7cqJGvX6OueZVOppiAfuaEMBxHeA8F7bCx9laeiziY4xVr8JA9dWZIuUuRaAMzaQhhXiLsc0fs/Cp8O7C3pCwFtKe8zKZKauInEaIAl4AdJaY/gLiQcDmgKQgBoUlqUK7koS2h3QEwKu9fUcSKMnQRxMwFMYLnaWDdyvEqb4HbkzIVwNcm4LUNsMwkWpwuCfvjNgv5w7WuQaEBlCrqDTncLA6028M2F583t+ZiFcA3Ja8530oRNaP+HyT/47WegJediv9BRFlePB/2Hb2xbw8q2bvgxTL2d/BfJukCkANUAXOQX3we8EuF7JrwVxVNN70LPpgnvqziBb+6bvmTHTngFxZORjgKvWjfb/5pgSGpOB3mUPD/flutIWNwBIRwOHUm+m6N60M4SWIO3PzldBXBqHxWoHtXNY/N+WbxXYL+d6ZbgiXlCBHeAwLnc/2BnilRJSCzK5q0ReHf+J551g2yIuH55UHO+Sh0evz8+xbP0V4D4x8CtOwT12LI/pQtj1ufnrSBSj76RWfzbinTuztHnzt+LhaPU3fpS/FlBBiBaSgpA8JbO0//mxAP61BOk5e+UrAC5rhQSe2uI1zu2e5MnXtofr5a7DYVKPADgoPiyec1RbNF5MqtQzpd4R3kHwvNba1GO2557HEurfuIclsL4i+zDBXwI0gAZD6fxMcWD1eIOrMnNGg+k/CDyp6V/xHqfYf/FkYJuhpRJSNSd7orF4Qih2jGXQgnpERrHa3Bkk3e947mKW4I0L3Jfrqlt4meBh8R95X+Ib7QBbQLSTfOJTf+/Y132bCxF83o/1cvfFMOY2gFY7xgRt9BnMn7Z0yP2q9iPVWXvZSK8XMLMdu+NOHFpviEtSM9zXeBF8+tXcgMDutoxKAwQX2sX+V7+uvW7ozPspO/Lo3l/Xto3vmxCGvXZt4CHWq/ntWdSM74PO9O39fQ8a3gAErXUi6iZnxF3GNk6raFsL5uZOD4AzDJFpA2p7EzEjah7AOVHYxov2AzvFk3cAto64AKbrkC86hls3IHj3IWCkVTyE0JXppe7NuytV/KpJqASnnsldRvAaEFNaAOGvEwsc8X1UQmZ2R+7PAI9p7hDQM4kGjiD9SrYomjgz1MeJB66Vs2fRmD+2wkd+4oEblezZIc2jcbwr8cC1au4agqVWDGMw+cCV/BMkzohDYm2igaO0wc/k342K3QjYSLcnGnhbtbPHof2mhNmxhxcnGrh+Y/anCM2zADqjBIrAcYkGrlVyC0ncBzDKFzYLODLRwH45d4UMb2iltXo/CHFKYoEjXcCv5G8BcUmzJARe8ky4KLnALdlrFcCzW4ecHtjsBUsSC7y1NL0z0zH18TjxEYVyyuu/KrHAWjlrb7/hrAF4SFNwhHqdgntbYoG9aucBFuy/CegCsEkhzk8v638qscC1SvZQ0rwVCeZRHWkYLrSXDq5LLLBf7T5esF6MT7j/qKFT078beC+xwPVq7k6AsY6h9bZqR0WiTSKBvRXd+5nQvANyj3hLu90pur9tpphfrpqTUITqxmx3IzBPiljQgoVnW+GP2TvwXqKAo5PNq2aPNTBXEvo5WoKjL/G6dLH/+s8r7B08bPY/GfxerKQ2r1OGEP77BaAWa9DSnYH0BELulhuhCMK2NVWhmSfgRFGHUugGI/0uunXSY6OjI4tnlLZfR7BezTXalal2SQyZTGOpAWKdnTLn8IqNkdr/xRNJVc+1FMYkPNEtKv5Jo0dSI9Y9LG38dGcqejd3/cCqW7eKPH78W81vcjIKIQyReEvi06EJ/pIeGfx4PDns/4ipxbY8O33UAAAAAElFTkSuQmCC) no-repeat 50%;background-size:15px}.reJj6Thl_0 ._2P4B1Hdm_0 span{color:#888;font-size:13px;font-weight:400}.reJj6Thl_0 ._2P4B1Hdm_0 span._2A421P4G_0{color:#fa8919}.reJj6Thl_0 ._2r3UB1GX_0{font-size:13px;color:#b2b2b2;height:16px;padding-top:8px}.reJj6Thl_0 ._2r3UB1GX_0 span{font-weight:500}.reJj6Thl_0 ._2r3UB1GX_0 i,.reJj6Thl_0 ._2r3UB1GX_0 span{height:16px;line-height:16px;display:inline-block;vertical-align:top}.reJj6Thl_0 ._2xNIY4NG_0{margin-top:10px}.reJj6Thl_0 ._2xNIY4NG_0 ._33BLbmw4_0{color:#888;font-size:14px;font-weight:400;white-space:normal;word-break:normal;background:#f6f7fb;-webkit-transition:background .3s ease;transition:background .3s ease;border-radius:10px;padding:18px;overflow-x:scroll}.reJj6Thl_0 ._2xNIY4NG_0 ._1H1Z49Dr_0{color:#888;font-size:9px}._0X_LEcd_0 ._2xNIY4NG_0 ._33BLbmw4_0{background:#efe6cf}.cGm0Q9aA_0 ._2CG0SquK_0{border-bottom:1px solid #4c4c4c}.cGm0Q9aA_0 ._2CG0SquK_0 ._1H1Z49Dr_0,.cGm0Q9aA_0 ._2CG0SquK_0 ._3M6kV3zb_0,.cGm0Q9aA_0 ._2CG0SquK_0 ._18Dng5rT_0{color:silver}.cGm0Q9aA_0 ._2xNIY4NG_0 ._33BLbmw4_0{color:silver;background:#3e3e3e}.cGm0Q9aA_0 ._1YQBH3WC_0,.cGm0Q9aA_0 ._2P4B1Hdm_0 i,.cGm0Q9aA_0 ._2P4B1Hdm_0 span,.cGm0Q9aA_0 ._13n1j2Zp_0{color:#999}._2Gn7zqLg_0 ._1bkbsnjg_0{line-height:18px}</style></head><body><svg aria-hidden="true" style="position: absolute; width: 0px; height: 0px; overflow: hidden;"><symbol id="icon-android" viewBox="0 0 1024 1024"><path d="M862.778202 640.174593c-17.774874 0-32.175395-13.876101-32.175395-30.980825L830.602807 414.807258c0-17.134486 14.399495-30.981851 32.175395-30.981851 17.773847 0 32.203104 13.847365 32.203104 30.981851l0 194.385484C894.981306 626.298492 880.553076 640.174593 862.778202 640.174593zM380.771249 151.679606 380.771249 151.679606l-56.204315-70.516577c-3.83925-4.829593-2.675467-11.578298 2.619023-15.097354 5.293464-3.520082 12.682557-2.443532 16.523859 2.385035l58.093665 72.901612c33.367912-14.662218 70.603809-22.865138 109.905574-22.865138 39.302791 0 76.509952 8.203946 109.875812 22.865138l58.094691-72.901612c3.83925-4.829593 11.258104-5.905117 16.552594-2.385035 5.265755 3.520082 6.429537 10.268787 2.589261 15.097354l-56.204315 70.516577c64.726402 35.578483 111.504491 96.640099 124.53803 168.465162L256.233218 320.144767C269.295493 248.319705 316.042794 187.258088 380.771249 151.679606zM622.341222 254.749242 622.341222 254.749242c17.716377 0 32.058401-13.439939 32.058401-29.992534 0-16.552594-14.34305-29.963798-32.058401-29.963798-17.65788 0-32.028639 13.411204-32.028639 29.963798C590.312583 241.309303 604.683343 254.749242 622.341222 254.749242zM401.01839 254.749242 401.01839 254.749242c17.716377 0 32.028639-13.439939 32.028639-29.992534 0-16.552594-14.312263-29.963798-32.028639-29.963798-17.687641 0-32.029665 13.411204-32.029665 29.963798C368.988724 241.309303 383.330748 254.749242 401.01839 254.749242zM161.221798 640.174593 161.221798 640.174593c-17.803609 0-32.20413-13.876101-32.20413-30.980825L129.017668 414.807258c0-17.134486 14.400521-30.981851 32.20413-30.981851 17.773847 0 32.175395 13.847365 32.175395 30.981851l0 194.385484C193.397193 626.298492 178.995645 640.174593 161.221798 640.174593zM766.691258 718.719625 766.691258 718.719625c0 31.011613-25.658625 56.117082-57.3096 56.117082l-40.116617 0 0 131.868626c0 29.440404-24.349114 53.294859-54.42888 53.294859-30.079766 0-54.42888-23.854455-54.42888-53.294859L560.407282 774.836707l-97.425191 0 0 131.868626c0 29.440404-24.378875 53.294859-54.429906 53.294859-30.050004 0-54.42888-23.854455-54.42888-53.294859L354.123306 774.836707l-40.116617 0c-31.621213 0-57.308573-25.10547-57.308573-56.117082L256.698115 384.348801l509.992117 0L766.690232 718.719625z"></path></symbol><symbol id="icon-apple" viewBox="0 0 1024 1024"><path d="M791.489559 544.090212c-1.290235-129.678896 105.758341-191.876433 110.550644-194.968902-60.149545-88.022725-153.845209-100.085402-187.24797-101.478037-79.748834-8.069091-155.586003 46.939992-196.074818 46.939992-40.365935 0-102.809232-45.752156-168.959395-44.543841-86.916809 1.290235-167.054762 50.544459-211.803402 128.38866-90.295997 156.691919-23.121837 388.831888 64.880408 515.930313 43.007846 62.197537 94.289582 132.075047 161.627581 129.576496 64.839448-2.580471 89.35392-41.96337 167.751079-41.96337s100.43356 41.96337 169.041315 40.673134c69.77511-1.290235 113.991272-63.405853 156.691919-125.78771 49.397583-72.171262 69.73415-142.028292 70.921986-145.632759-1.556474-0.696318-136.068633-52.244293-137.399828-207.133978zM662.568421 163.511735c35.737472-43.356005 59.862826-103.505549 53.288769-163.511735-51.486536 2.088953-113.868392 34.283397-150.81418 77.557482-33.136521 38.379383-62.156577 99.634843-54.374205 158.432713 57.466674 4.485104 116.121184-29.204375 151.899616-72.457981z"></path></symbol><symbol id="icon-arrowright1" viewBox="0 0 1024 1024"><path d="M267.649318 918.655743 308.671617 959.678042 756.349659 512 308.671617 64.322981 267.649318 105.34528 674.305061 512Z"></path></symbol><symbol id="icon-ok" viewBox="0 0 1024 1024"><path d="M997.12174459 172.27043777c-16.65294032-15.61730971-42.91653278-14.87165566-58.53513703 1.82270988L386.13981108 762.29120758l-301.78276187-297.35026283c-16.32153853-16.07298718-42.54370576-15.90728628-58.61669294 0.41425224-16.07298718 16.27881876-15.86586107 42.54241122 0.45567747 58.57526772l332.02317589 327.09357417c0.12427568 0.12427568 0.28997657 0.1657009 0.41295772 0.28997657 0.12557022 0.12427568 0.16699543 0.28997657 0.2912711 0.41425225 2.60978915 2.48551348 5.75810623 3.89397111 8.78214765 5.55098011 1.49001355 0.86992972 2.77549005 2.15411168 4.34835405 2.77549006 4.88817651 1.90556034 10.0663296 2.89976573 15.20305745 2.89976571 5.42670444 0 10.85340887-1.07705584 15.90728629-3.23116753 1.69972875-0.70422882 3.02404141-2.15411168 4.59819994-3.06546662 3.10689185-1.82270989 6.33805938-3.3554432 8.98927377-6.0480828 0.12427568-0.12427568 0.1657009-0.33140179 0.28997657-0.45567748 0.08285045-0.12557022 0.24855135-0.16699543 0.37282701-0.2912711l581.48717354-619.05855778C1014.6433201 214.19276515 1013.77339038 187.97059792 997.12174459 172.27043777z"></path></symbol><symbol id="icon-leftarrow1" viewBox="0 0 1024 1024"><path d="M266.163989 512.035816 266.163989 512.035816c-0.992607 13.43294 3.208065 26.929326 13.338796 37.123502l396.655995 396.499429c18.788925 18.691711 48.957015 18.72548 67.867714 0.033769 18.755156-18.788925 18.466584-48.957015-0.062422-67.706031L377.856837 512.069585l366.077559-366.042767c18.49626-18.657942 18.62315-49.113581-0.097214-67.774593-18.853393-18.657942-49.113581-18.657942-67.805292-0.029676l-396.528082 396.817678C269.436522 485.33264 265.171382 498.828003 266.163989 512.035816L266.163989 512.035816z"></path></symbol><symbol id="icon-shezhi" viewBox="0 0 1024 1024"><path d="M640.516 888.95C640.516 888.95 640.516 888.95 640.516 888.95c-13.9-0.002-27.404-6.01-36.132-16.066-11.886-13.62-49.55-49.036-80.378-49.036-30.616 0-68.862 35.622-79.844 48.1-8.706 9.886-22.12 15.79-35.882 15.79-6.556 0-12.742-1.314-18.39-3.908l-0.988-0.452-93.706-54.758-0.93-0.68c-17.06-12.484-23.554-36.89-15.102-56.782 0.064-0.152 8.642-20.834 8.642-39.696 0-57.234-44.558-103.804-99.332-103.804l-3.32 0c-0.202 0.008-0.402 0.01-0.604 0.01-15.69 0-28.462-14.56-32.542-37.104-0.328-1.804-7.998-44.562-7.998-78.244 0-33.69 7.668-76.446 7.994-78.248 4.134-22.826 17.186-37.492 33.15-37.096l3.322 0c54.772 0 99.332-46.566 99.332-103.804 0-18.854-8.574-39.534-8.662-39.742-8.442-19.87-1.906-44.274 15.224-56.714l0.968-0.706 98.898-56.764 1.028-0.458c5.57-2.482 11.668-3.738 18.128-3.738 13.73 0 27.174 5.774 35.958 15.448 11.704 12.808 48.704 46.116 78.65 46.116 29.662 0 66.438-32.652 78.1-45.232 8.732-9.478 22.078-15.152 35.678-15.152 6.59 0 12.802 1.302 18.462 3.872l0.998 0.454 95.52 55.458 0.944 0.688c17.088 12.464 23.598 36.874 15.138 56.776-0.062 0.152-8.642 20.836-8.642 39.694 0 57.24 44.562 103.804 99.332 103.804l3.32 0c15.944-0.37 29.016 14.268 33.146 37.096 0.33 1.802 8 44.558 8 78.246 0 33.684-7.67 76.442-8 78.246-4.13 22.826-17.202 37.436-33.148 37.094l-3.318 0c-54.77 0-99.332 46.57-99.332 103.804 0 18.856 8.574 39.53 8.66 39.738 8.44 19.86 1.916 44.264-15.188 56.72l-0.958 0.698-97.126 56.098-1.01 0.458C653.016 887.682 646.936 888.95 640.516 888.95L640.516 888.95zM637.564 841.126c0.436 0.296 1.66 0.804 2.95 0.804 0.056 0 0.104 0 0.15-0.004l90.744-52.418c-2.19-5.314-12.208-31.124-12.208-58.044 0-80.51 60.684-146.488 136.756-150.62 1.098-6.316 7.04-41.854 7.04-68.526 0-26.664-5.94-62.194-7.038-68.528-76.074-4.128-136.758-70.108-136.758-150.62 0-26.958 10.048-52.8 12.22-58.076l-89.276-51.834c-0.102-0.008-0.226-0.012-0.372-0.012-1.522 0-2.946 0.58-3.416 0.91-1.496 1.608-14.44 15.322-33.028 28.988-27.512 20.23-53.536 30.486-77.334 30.486-24.034 0-50.262-10.458-77.954-31.086-18.702-13.93-31.702-27.906-33.204-29.546-0.476-0.336-1.916-0.932-3.45-0.932-0.12 0-0.226 0.002-0.318 0.008l-92.468 53.076c2.216 5.384 12.196 31.146 12.196 58.016 0 80.51-60.682 146.49-136.758 150.62-1.096 6.324-7.04 41.862-7.04 68.528 0 26.664 5.942 62.194 7.042 68.528 76.076 4.128 136.756 70.108 136.756 150.618 0 27.01-10.084 52.898-12.234 58.108l87.518 51.142c0.056 0.004 0.122 0.004 0.194 0.004 1.28 0 2.494-0.492 2.922-0.78 1.636-1.838 14.71-16.296 33.534-30.714 28.066-21.496 54.736-32.392 79.27-32.392 24.77 0 51.636 11.104 79.87 33.012C622.808 824.538 635.932 839.264 637.564 841.126L637.564 841.126zM524.326 650.038c-72.942 0-132.284-62.018-132.284-138.242 0-76.222 59.342-138.238 132.284-138.238 72.944 0 132.286 62.014 132.286 138.238C656.612 588.02 597.27 650.038 524.326 650.038L524.326 650.038zM524.326 420.578c-48.13 0-87.29 40.92-87.29 91.216 0 50.298 39.16 91.218 87.29 91.218 48.134 0 87.292-40.92 87.292-91.218C611.62 461.498 572.462 420.578 524.326 420.578L524.326 420.578z"></path></symbol><symbol id="icon-yinliang-copy" viewBox="0 0 1024 1024"><path d="M678.569984 354.628608c-2.898944-7.727104-8.73472-13.999104-16.164864-17.391616-6.076416-3.41504-13.274112-4.893696-20.66432-3.729408-17.586176 2.770944-29.575168 19.423232-26.774528 37.19168 1.586176 10.061824 7.575552 18.320384 15.665152 23.092224 31.039488 33.216512 50.143232 77.703168 50.143232 126.763008 0 53.681152-22.890496 101.904384-59.286528 135.862272-6.747136 5.82144-11.02336 14.427136-11.02336 24.0384 0 17.531904 14.212096 31.744 31.745024 31.744 8.97536 0 17.074176-3.730432 22.847488-9.71776 6.161408-3.576832 10.970112-9.237504 13.513728-16.031744 39.776256-43.931648 64.222208-101.956608 64.222208-165.894144C742.791168 456.604672 718.345216 398.590976 678.569984 354.628608z"></path><path d="M789.633024 238.830592c-5.279744-10.749952-16.3328-18.152448-29.118464-18.152448-17.907712 0-32.425984 14.518272-32.425984 32.427008 0 11.754496 6.254592 22.048768 15.619072 27.73504 54.951936 57.501696 88.880128 135.248896 88.880128 221.06624 0 96.089088-42.518528 182.078464-109.546496 240.768l0.124928 0.145408c-10.517504 5.219328-17.752064 16.063488-17.752064 28.601344 0 17.626112 14.288896 31.915008 31.915008 31.915008 10.4704 0 19.762176-5.042176 25.581568-12.829696 0.280576-0.333824 0.562176-0.667648 0.831488-1.012736l0.080896 0.080896c80.111616-70.1184 130.968576-172.84096 130.968576-287.6672C894.793728 399.910912 854.69696 307.396608 789.633024 238.830592z"></path><path d="M448.487424 183.721984 289.050624 346.851328 191.880192 346.851328c-41.570304 0-62.021632 22.37952-62.021632 62.032896l0 206.718976c0 39.005184 21.098496 62.042112 62.021632 62.042112l97.171456 0 159.435776 163.109888c45.809664 43.02336 115.52256 24.064 115.52256-47.366144L564.009984 231.07584C564.009984 158.90944 493.427712 141.606912 448.487424 183.721984zM501.989376 761.613312c0 46.959616-20.816896 20.632576-42.176512-0.446464-37.228544-36.745216-93.476864-96.119808-139.710464-145.563648l-86.875136 0c-31.434752 0-41.347072-10.541056-41.347072-41.347072L191.880192 450.22208c0-30.152704 10.559488-41.337856 41.347072-41.337856l87.842816 0c45.993984-49.707008 101.695488-108.972032 138.902528-145.384448 21.117952-20.663296 42.015744-47.586304 42.015744 1.302528C501.989376 365.810688 501.989376 662.644736 501.989376 761.613312z"></path></symbol><symbol id="icon-quanping" viewBox="0 0 1024 1024"><path d="M223.744 590.336h-37.376v242.176h241.664v-36.864H223.744v-205.312z" fill=""></path><path d="M443.392 847.872H171.008v-273.408h68.096v205.312h204.288z" fill=""></path><path d="M201.728 817.152h210.944v-6.144H208.384v-205.312h-6.656zM573.952 795.136v37.376h242.176v-241.664h-36.864v204.288z" fill=""></path><path d="M831.488 847.872H558.08v-68.096h205.312v-204.288h67.584v272.384z" fill=""></path><path d="M589.312 817.152h211.968v-210.944h-6.144v204.288h-205.312v6.656zM428.544 228.864v-37.888H185.856v242.176h36.864V228.864z" fill=""></path><path d="M238.08 448.512H170.496V175.616h273.408v68.096H238.08z" fill=""></path><path d="M201.216 417.792h6.144V213.504h205.312v-6.656H201.216zM778.24 433.664h37.888V191.488h-242.176v36.864H778.24z" fill=""></path><path d="M831.488 449.024H762.88V243.712h-204.288V176.128h272.384v272.896z" fill=""></path><path d="M793.6 418.304h6.656V206.848h-210.944v6.144H793.6z" fill=""></path></symbol><symbol id="icon-zhongxinbofang" viewBox="0 0 1024 1024"><path d="M585.00608 88.21248c-237.89056 0-431.44704 193.99168-431.44704 432.42496a432.55296 432.55296 0 0 0 2.52416 46.7968L68.6592 478.94528a34.14016 34.14016 0 0 0-48.5632 47.98464l141.49632 143.20128a47.0528 47.0528 0 0 0 33.67936 14.03904c0.02048 0 0.04096 0 0.0256 0.03584a47.22688 47.22688 0 0 0 33.65376-14.09024l141.45024-143.1808a34.16064 34.16064 0 0 0-48.5632-47.98976l-95.80032 96.9728a368.37888 368.37888 0 0 1-4.20864-55.28064c0-200.79104 162.93376-364.16 363.18208-364.16 200.27392 0 363.20256 163.36384 363.20256 364.16 0 200.77056-162.93376 364.10368-363.20256 364.10368a359.84896 359.84896 0 0 1-257.664-107.52 320.49664 320.49664 0 0 1-8.192-8.4992 34.14016 34.14016 0 0 0-48.78848 47.74912 427.8528 427.8528 0 0 0 314.64448 136.52992c237.90592 0 431.46752-193.95072 431.46752-432.36864-0.00512-238.42816-193.56672-432.41984-431.47264-432.41984z" fill="#7B7B7B"></path></symbol><symbol id="icon-bofang" viewBox="0 0 1024 1024"><path d="M139.7 64.9v894.2L884.3 512z" fill="#5C5C5C"></path></symbol><symbol id="icon-quxiaoquanping" viewBox="0 0 1024 1024"><path d="M17.066667 795.306667h211.626666V1006.933333h141.653334V653.653333H17.066667v141.653334z m211.626666-566.613334H17.066667v141.653334h353.28V17.066667h-141.653334v211.626666zM653.653333 1006.933333h141.653334V795.306667H1006.933333v-141.653334H653.653333V1006.933333z m141.653334-778.24V17.066667h-141.653334v353.28H1006.933333v-141.653334H795.306667z"></path></symbol><symbol id="icon-play1" viewBox="0 0 1024 1024"><path d="M512 0C229.76 0 0 229.76 0 512s229.76 512 512 512 512-229.76 512-512-229.76-512-512-512z m0 960c-247.04 0-448-200.96-448-448s200.96-448 448-448 448 200.96 448 448-200.96 448-448 448zM435.2 277.76a35.712 35.712 0 0 0-19.84-7.04c-16.64 0-32 12.8-32 32v418.56c0 19.2 15.36 32 32 32 7.04 0 14.08-1.92 19.84-7.04l257.92-209.28a32 32 0 0 0 0-49.92L435.2 277.76z m11.52 376.32V369.92L622.08 512l-175.36 142.08z" fill="#444444"></path></symbol><symbol id="icon-ic_replay_px" viewBox="0 0 1024 1024"><path d="M512 213.333333V42.666667L298.666667 256l213.333333 213.333333v-170.666666c141.44 0 256 114.56 256 256s-114.56 256-256 256-256-114.56-256-256H170.666667c0 188.586667 152.746667 341.333333 341.333333 341.333333s341.333333-152.746667 341.333333-341.333333-152.746667-341.333333-341.333333-341.333334z" fill=""></path></symbol><symbol id="icon-done" viewBox="0 0 1024 1024"><path d="M511.67197 0.765403a511.617298 511.617298 0 1 0 511.726642 511.562627A511.617298 511.617298 0 0 0 511.67197 0.765403z m293.477416 378.819861l-330.927496 330.872825a46.197544 46.197544 0 0 1-65.60598 0L218.686599 520.255419a46.416231 46.416231 0 0 1 65.60598-65.60598l157.235664 157.454352 298.124507-298.179178a46.361559 46.361559 0 0 1 68.230218 62.763054 38.270155 38.270155 0 0 1-2.788254 2.952269z"></path></symbol><symbol id="icon-shanchu1" viewBox="0 0 1024 1024"><path d="M32.035491 1023.976262a32.000116 32.000116 0 0 1-22.644446-54.62129l456.915116-457.380572L9.391045 54.454191A32.000116 32.000116 0 0 1 54.679937 9.235117l479.419925 480.025018a31.976844 31.976844 0 0 1 0 45.219074l-479.419925 480.025018a31.813934 31.813934 0 0 1-22.644446 9.472035z m960.143128 0a31.813934 31.813934 0 0 1-22.644446-9.309125l-479.419926-480.025018a31.976844 31.976844 0 0 1 0-45.219074L969.534173 9.398027a32.000116 32.000116 0 0 1 45.288892 45.219073L557.907949 511.9744l456.915116 457.310754a32.000116 32.000116 0 0 1-22.644446 54.691108z"></path></symbol><symbol id="icon-zanting" viewBox="0 0 1024 1024"><path d="M119.289 0h181.567v1024H119.289zM721.759 0h182.952v1024H721.759z"></path></symbol><symbol id="icon-praise" viewBox="0 0 1024 1024"><path d="M287.922748 327.842488c-4.421079 2.275555-13.328252 6.664126-20.853838 10.402538l-12.369268 6.176507-11.556569-7.476825a95.638334 95.638334 0 0 0-51.655103-16.416505H95.362017A95.45954 95.45954 0 0 0 0 415.776442v512.812617A95.45954 95.45954 0 0 0 95.362017 1023.999837h96.125953a92.355033 92.355033 0 0 0 76.930019-41.122533l9.4273-13.815871 16.253966 4.063492c26.006345 6.339047 67.535227 16.091426 123.708933 28.932059A937.853819 937.853819 0 0 0 608.971078 1023.999837H784.091304c54.385769 0 92.745128-20.479997 113.972807-60.952371A1093.339255 1093.339255 0 0 0 1023.999837 444.87104c0-57.376499-46.990215-97.036175-90.729636-109.551728-31.597709-8.289522-100.238206-9.752379-195.25889-12.027935l-75.808495-1.787936 3.44584-26.493964a621.892981 621.892981 0 0 0 3.559619-79.644432C669.208275 108.73903 589.937684 0 512.113696 0a95.898397 95.898397 0 0 0-95.394524 94.59808c-1.771682 144.822834-81.464876 208.2133-128.796424 233.244408z"></path></symbol><symbol id="icon-play" viewBox="0 0 1024 1024"><path d="M900.506923 407.270163L246.46493 18.029536C229.112396 8.498257 170.621177-13.647951 125.641949 11.862238S70.388562 69.470411 70.388562 90.775624v845.340374c0 14.156753-5.606635 59.149998 57.902522 79.614216a160.672139 160.672139 0 0 0 118.173846-6.868128l654.041993-389.240627c23.828198-14.156753 52.912617-45.83424 52.912616-109.749878s-31.453222-87.323338-52.912616-102.601418zM253.879705 790.483657V236.407965L712.446372 513.375728z"></path></symbol><symbol id="icon-pause" viewBox="0 0 1024 1024"><path d="M126.246575 98.191781c0-54.229918 44.074082-98.191781 98.191781-98.191781 54.229918 0 98.191781 44.003945 98.191781 98.191781v827.616438c0 54.229918-44.074082 98.191781-98.191781 98.191781-54.229918 0-98.191781-44.003945-98.191781-98.191781V98.191781z m575.123288 0c0-54.229918 44.074082-98.191781 98.191781-98.191781 54.229918 0 98.191781 44.003945 98.191781 98.191781v827.616438c0 54.229918-44.074082 98.191781-98.191781 98.191781-54.229918 0-98.191781-44.003945-98.191781-98.191781V98.191781z"></path></symbol><symbol id="icon-down" viewBox="0 0 1053 1024"><path d="M488.806044 847.474529c6.06441 5.333758 13.268636 9.220826 21.042771 11.398168a42.377803 42.377803 0 0 0 32.382487 0 36.386459 36.386459 0 0 0 21.042771-11.398168l396.55395-396.597789a44.642824 44.642824 0 1 0-63.128314-63.128314l-330.254607 330.254607V41.565611a40.463496 40.463496 0 1 0-80.926991 0v676.437422l-330.254607-330.254607a44.642824 44.642824 0 1 0-63.128314 63.128314L488.806044 847.474529z m522.82519 95.569253H40.463496a40.405044 40.405044 0 0 0 0 80.810088h971.167738a40.405044 40.405044 0 0 0 0-80.810088z"></path></symbol><symbol id="icon-praise-line" viewBox="0 0 1033 1024"><path d="M290.445428 327.699711c-4.45146 2.299647-13.436509 6.734681-21.041771 10.512673l-12.467372 6.241899-11.662496-7.555983a97.505037 97.505037 0 0 0-52.103433-16.426051h-96.913699a95.862432 95.862432 0 0 0-96.207379 95.271094v512.821302a95.82958 95.82958 0 0 0 96.207379 95.271094h96.913699a93.431376 93.431376 0 0 0 77.596664-41.065126l9.510683-13.797883 16.426051 3.942252c26.199551 6.40616 68.135258 16.09753 124.837985 28.90985a949.031505 949.031505 0 0 0 192.841835 22.010907H791.078601c54.846583 0 93.546359-20.532563 114.982355-60.940648a1086.451845 1086.451845 0 0 0 126.956946-518.077638c0-57.491177-47.405582-97.07796-91.542381-109.561758-31.866538-8.213025-101.102342-9.85563-196.948347-11.991017l-76.479692-1.806866 3.465896-26.610202a612.198909 612.198909 0 0 0 3.597305-79.502085C675.110683 108.740456 595.148669 0 516.632146 0a96.388065 96.388065 0 0 0-96.223805 94.614052c-1.823292 144.713507-82.212384 208.282323-129.962913 233.085659zM226.186718 928.400385a33.032788 33.032788 0 0 1-33.049214 32.852101h-96.913699a33.016362 33.016362 0 0 1-33.049214-32.852101V415.743343a33.016362 33.016362 0 0 1 33.049214-32.852101h96.913699a33.016362 33.016362 0 0 1 33.049214 32.852101v512.657042zM483.402246 95.271094a32.999936 32.999936 0 0 1 33.049214-32.687841c36.777927 0 95.271094 69.974976 95.271094 152.926532 0 76.873917-3.36734 90.179018-29.566892 167.381457 304.440423 0 318.533975 3.942252 344.142188 10.841193l4.254348 1.149824a50.345845 50.345845 0 0 1 39.208983 49.935194c0 6.40616-0.098556 8.541546-0.279243 11.333975l-0.312095 6.406159c-13.239397 315.872955-114.1282 464.035932-118.4154 470.113571-7.983061 14.290664-21.206031 28.745589-59.692268 28.745589H614.334296a908.804107 908.804107 0 0 1-179.158935-20.532563c-80.487648-18.397177-115.278024-26.610202-131.934039-30.716715l-18.627142-4.599294 4.927816-507.729227 13.994995-6.570421C463.54315 317.67982 482.597369 159.825473 483.402246 95.271094z"></path></symbol><symbol id="icon-arrow-down-new" viewBox="0 0 1024 1024"><path d="M511.872 676.8c-0.003 0-0.006 0-0.008 0-9.137 0-17.379-3.829-23.21-9.97l-251.277-265.614c-5.415-5.72-8.743-13.464-8.744-21.984 0-17.678 14.33-32.008 32.008-32.008 9.157 0 17.416 3.845 23.25 10.009l228.045 241.103 228.224-241.088c5.855-6.165 14.113-10.001 23.266-10.001 8.516 0 16.256 3.32 21.998 8.736 12.784 12.145 13.36 32.434 1.264 45.233l-251.52 265.6c-5.844 6.155-14.086 9.984-23.223 9.984-0.025 0-0.051 0-0.076 0z"></path></symbol><symbol id="icon-fenxiang1" viewBox="0 0 1024 1024"><path d="M820.691478 1024H203.308522c-42.622145 0-77.185855-34.801159-77.185855-77.734957V388.645101c0-42.933797 34.56371-77.720116 77.185855-77.720115h128.623304v51.808463H203.308522a25.822609 25.822609 0 0 0-25.733565 25.911652v557.619942a25.822609 25.822609 0 0 0 25.733565 25.911653h617.382956a25.822609 25.822609 0 0 0 25.733565-25.911653V388.645101a25.822609 25.822609 0 0 0-25.733565-25.911652h-128.623304v-51.808463h128.623304c42.622145 0 77.171014 34.786319 77.171015 77.720115v557.619942c0 42.933797-34.54887 77.734957-77.171015 77.734957z m-140.198956-770.344812l-142.766377-151.04742v622.859131h-51.45229V102.340638l-142.766377 151.31455-37.309217-35.750956L476.493913 37.561507l-1.79571-1.81055L511.99258 0l37.309217 35.750957-1.810551 1.81055 170.310493 180.342725-37.309217 35.750956z"></path></symbol><symbol id="icon-xingzhuang8" viewBox="0 0 1212 1024"><path d="M608.820484 64.179444C661.042051 24.029735 725.901346 15.406979 790.194773 7.053684a825.143881 825.143881 0 0 1 264.961132 8.083834 526.203701 526.203701 0 0 1 86.038939 23.982041 170.703628 170.703628 0 0 1 50.254502 32.604797A77.470076 77.470076 0 0 1 1212.575098 132.08365q0.242515 284.955148 0 569.371374c0 86.227563 0.242515 172.724586-0.188622 258.952149a59.281449 59.281449 0 0 1-22.904197 52.814382 56.047916 56.047916 0 0 1-58.634742 3.233533 199.401238 199.401238 0 0 0-45.538932-15.628745 1168.518203 1168.518203 0 0 0-241.491067-11.85629c-52.167675 1.886228-104.146728 9.970062-156.287457 15.898207a34.814378 34.814378 0 0 0-16.841321 6.197606 70.706601 70.706601 0 0 1-46.212584 11.856289c-20.667669-0.808383-41.362284-1.347306-61.976061-2.42515a15.197608 15.197608 0 0 1-7.62575-2.155689c-44.434141-26.676652-94.63475-23.443119-142.949131-27.215574a1076.308604 1076.308604 0 0 0-141.386256-2.155689c-54.080849 2.694611-108.053914 8.892217-161.838357 15.898207a303.440182 303.440182 0 0 0-45.107794 16.976051 49.580848 49.580848 0 0 1-58.09582-33.143719 183.826385 183.826385 0 0 1-5.389223-39.880248Q0 546.649603 0 144.748323c0-60.089833 18.862279-82.455107 70.059895-104.820381A478.02405 478.02405 0 0 1 209.694654 6.784223a874.347484 874.347484 0 0 1 265.015024 8.083834 509.092919 509.092919 0 0 1 72.296422 18.862279 628.033063 628.033063 0 0 1 61.814384 30.449108zM578.748621 921.604769v-15.628745l-0.323353-312.574915q0-230.389269 0.538922-461.047998a31.203599 31.203599 0 0 0-15.332338-30.179647 172.185664 172.185664 0 0 0-41.901206-19.670663 924.925339 924.925339 0 0 0-114.359305-21.826351 778.742674 778.742674 0 0 0-272.398259 14.820362 346.122825 346.122825 0 0 0-64.886241 26.407191 30.529946 30.529946 0 0 0-16.167668 30.718569q0.458084 387.215648 0.242515 774.970219c0 3.502995 0.296407 7.275451 0.377245 8.622756a341.137794 341.137794 0 0 1 40.41917-22.904197A502.275552 502.275552 0 0 1 268.329396 862.32332c45.808393-1.347306 91.886246 0.808383 137.748531 3.233534a443.344402 443.344402 0 0 1 122.497031 23.71258 97.006008 97.006008 0 0 1 50.173663 32.335335zM1022.093024 64.179444v492.036029a11.640721 11.640721 0 0 1-2.694612 1.347306c-39.476056-40.688631-78.952112-81.646723-119.506012-123.413199-40.149709 41.497014-79.625765 82.455107-119.074875 123.413199-0.916168-0.269461-1.832336-0.808383-2.694611-1.077845V63.1016a410.739605 410.739605 0 0 0-107.029962 26.676652 154.589852 154.589852 0 0 0-25.248508 15.359284 27.808389 27.808389 0 0 0-11.505991 23.982041q0.242515 391.257565 0.161677 782.784592a10.185631 10.185631 0 0 0 0.592814 4.041917 345.314442 345.314442 0 0 1 39.772464-22.634736A502.84142 502.84142 0 0 1 843.655861 862.32332a829.94029 829.94029 0 0 1 211.338367 12.664673 188.622793 188.622793 0 0 1 104.308404 45.00001v-12.664674c-0.242515-54.431149-0.700599-109.131759-0.700598-163.562907 0-68.98205 0.619761-137.9641 0.673652-206.676689 0-132.844339-0.404192-265.688677 0.511977-398.533016a43.113781 43.113781 0 0 0-25.787431-43.113781 350.46115 350.46115 0 0 0-111.907208-31.257492z"></path></symbol><symbol id="icon-xingzhuang9" viewBox="0 0 1170 1024"><path d="M1066.790472 74.786141H1036.766305v59.243789h30.097308a42.220342 42.220342 0 0 1 44.908254 38.764454v753.164094a42.238627 42.238627 0 0 1-44.908254 38.947305H103.420639a42.183772 42.183772 0 0 1-44.8534-38.947305V172.794384a42.165487 42.165487 0 0 1 44.8534-38.764454h449.320254V74.786141H103.347498A100.952148 100.952148 0 0 0 0 172.794384v753.164094A100.842437 100.842437 0 0 0 103.347498 1023.966721h963.442974a100.897292 100.897292 0 0 0 103.420639-98.008243V172.794384a101.007003 101.007003 0 0 0-103.420639-98.008243zM239.973915 419.277802h222.365345a29.530469 29.530469 0 0 0 0-59.060938H239.973915a29.530469 29.530469 0 0 0 0 59.060938z m0 123.973114a29.621894 29.621894 0 0 0 0 59.243789h296.456651a29.621894 29.621894 0 0 0 0-59.243789H239.973915z m-29.256192 212.838797a29.256192 29.256192 0 0 0 29.256192 29.439043H610.540157a29.530469 29.530469 0 0 0 0-59.060938H239.973915a29.384188 29.384188 0 0 0-29.256192 29.621895z m449.320254-210.461732v0.914256h0.511984l139.936023 235.695197 139.917739-235.695197h0.475413v-0.914256l0.457128-0.731404h-0.457128V140.795424a140.429722 140.429722 0 1 0-280.841159 0v404.101153h-0.420557z m140.448007 159.994801l-72.043373-121.413197h144.050176zM718.605217 140.795424a81.917338 81.917338 0 0 1 163.834675 0v404.101153H718.605217V140.795424z"></path></symbol><symbol id="icon-xingzhuang10" viewBox="0 0 1749 1024"><path d="M874.666667 938.24c321.536 0 756.565333-320 787.456-408.32-11.818667-96.853333-422.4-445.866667-787.456-445.866667-347.861333 0-787.456 278.186667-787.456 447.573334 9.088 84.053333 431.402667 406.613333 787.456 406.613333m0 85.76C509.568 1024 0 689.066667 0 533.333333 0 286.293333 513.152 0 874.666667 0 1270.656 0 1749.333333 375.466667 1749.333333 533.333333 1749.333333 664.32 1226.154667 1024 874.666667 1024z m0-299.52a213.333333 213.333333 0 1 0-218.88-213.333333 216.277333 216.277333 0 0 0 218.88 213.333333m0 86.186667a298.666667 298.666667 0 1 1 306.090666-298.666667 302.677333 302.677333 0 0 1-306.090666 298.666667z"></path></symbol><symbol id="icon-xingzhuang" viewBox="0 0 1157 1024"><path d="M420.997565 647.791304a37.843478 37.843478 0 0 1-17.363478 4.006957 38.600348 38.600348 0 0 1-33.658435-19.812174l-2.515478-5.565217-105.382957-231.735653a20.279652 20.279652 0 0 1-1.825391-8.236521 19.277913 19.277913 0 0 1 19.277913-19.144348 18.921739 18.921739 0 0 1 11.553391 3.784348l124.304696 88.820869a59.013565 59.013565 0 0 0 31.632696 9.349565 58.301217 58.301217 0 0 0 19.789913-3.561739L1051.581217 204.8C946.732522 80.806957 774.121739 0 578.782609 0 259.116522 0 0 216.375652 0 483.506087c0 145.808696 77.913043 276.925217 199.969391 365.523478a38.845217 38.845217 0 0 1 16.205913 31.610435 44.521739 44.521739 0 0 1-2.048 12.243478c-9.728 36.507826-25.33287 94.831304-26.045217 97.725218a52.624696 52.624696 0 0 0-3.116522 14.024347 19.322435 19.322435 0 0 0 19.277913 19.366957 22.038261 22.038261 0 0 0 11.130435-3.561739l126.70887-73.46087a60.104348 60.104348 0 0 1 30.72-8.904348 54.00487 54.00487 0 0 1 17.029565 2.671305 687.86087 687.86087 0 0 0 188.928 26.490435c319.643826 0 578.782609-216.598261 578.782609-483.728696a419.127652 419.127652 0 0 0-65.914435-223.944348L425.182609 645.342609z"></path></symbol><symbol id="icon-xingzhuang1" viewBox="0 0 1024 1024"><path d="M1023.360799 700.990429V196.873908A196.845499 196.845499 0 0 0 826.699958 0h-629.399916A196.845499 196.845499 0 0 0 0.639201 196.873908v630.252184a196.746067 196.746067 0 0 0 196.660841 196.873908h629.399916a196.831294 196.831294 0 0 0 193.592676-162.072964C968.133833 839.341934 742.11236 741.473159 624.357331 685.365515c-89.48814 108.66417-183.507505 173.862672-324.941379 173.862672s-235.794146-87.35747-224.558413-194.033014c7.457345-70.170065 55.52526-184.658066 264.004217-165.055903 109.871549 10.227216 160.141157 30.823693 249.842364 60.368984a711.33128 711.33128 0 0 0 57.130365-139.203773H248.436122v-39.346373h196.646636V311.077819H205.183521v-43.465668h239.757192v-101.98807a19.17603 19.17603 0 0 1 19.886253-16.051047H563.13608v118.181162h255.680399v43.465668h-255.680399v70.880289h208.635206a803.163157 803.163157 0 0 1-84.743848 212.640865C747.666306 616.615897 1023.360799 700.990429 1023.360799 700.990429z m-739.56976 90.482452c-149.459398 0-173.138244-94.459703-165.24056-133.94812s51.13608-90.482452 134.274823-90.482453c95.553447 0 181.021723 24.431683 283.734221 74.431405-72.187099 94.033569-160.72354 149.999168-252.768484 149.999168z"></path></symbol><symbol id="icon-xingzhuang2" viewBox="0 0 1024 1024"><path d="M289.714302 291.475655a49.459953 49.459953 0 0 0-31.604939 10.511306 33.934471 33.934471 0 0 0 0 54.261062 50.454266 50.454266 0 0 0 31.604939 10.511306 36.121959 36.121959 0 0 0 38.124788-38.067971 36.050936 36.050936 0 0 0-10.539714-27.272576 38.35206 38.35206 0 0 0-27.585074-9.943127z m312.114745 220.027189a27.997004 27.997004 0 0 0-21.065224 9.516992 30.298127 30.298127 0 0 0-9.019836 21.164656 29.971425 29.971425 0 0 0 9.019836 21.02261 28.139048 28.139048 0 0 0 21.065224 9.659038 41.732723 41.732723 0 0 0 27.102122-9.090859 26.61917 26.61917 0 0 0 11.051075-21.164655 28.224275 28.224275 0 0 0-11.051075-21.59079 39.772507 39.772507 0 0 0-27.102122-9.516992zM1023.360799 155.822999A156.036066 156.036066 0 0 0 867.79348 0h-711.643778A156.05027 156.05027 0 0 0 0.639201 155.822999v712.496047a156.05027 156.05027 0 0 0 155.567319 155.680954h711.643778A156.036066 156.036066 0 0 0 1023.360799 868.319046V155.822999zM389.060341 679.399639a671.033208 671.033208 0 0 1-106.405659-15.198779l-106.40566 53.26675 30.127674-91.476765q-121.433985-85.2268-121.433985-205.964766a231.731669 231.731669 0 0 1 88.834734-182.953531 322.043668 322.043668 0 0 1 215.282896-75.283673 340.907199 340.907199 0 0 1 199.217645 60.795117 243.194673 243.194673 0 0 1 106.888611 152.271883c-10.710168-0.710223-20.411819-0.994313-29.104952-0.994313a257.953114 257.953114 0 0 0-182.683645 70.31211 224.118075 224.118075 0 0 0-75.283673 169.885421 236.802663 236.802663 0 0 0 9.019836 64.204189c-10.710168 0.710223-20.070911 0.994313-28.096435 0.994313z m448.633875 106.391455l22.10215 76.420031-83.309197-46.164517a391.773394 391.773394 0 0 1-91.348925 16.051048 269.884866 269.884866 0 0 1-182.669441-64.914413 199.785823 199.785823 0 0 1 0-312.498266 286.930226 286.930226 0 0 1 363.847413 0.568179q77.769455 65.198502 77.783659 155.680954 0 95.454016-106.405659 174.856984z m-69.246775-274.28825a28.636205 28.636205 0 0 0-20.582272 9.516992 29.531086 29.531086 0 0 0-9.545402 21.164656 29.232792 29.232792 0 0 0 9.545402 21.02261 28.820863 28.820863 0 0 0 20.582272 9.659038 41.192953 41.192953 0 0 0 27.599278-9.090859 27.073713 27.073713 0 0 0 10.52551-21.164655 28.74984 28.74984 0 0 0-10.52551-21.59079 39.388986 39.388986 0 0 0-27.599278-9.516992zM502.497212 366.759329a36.136163 36.136163 0 0 0 38.124788-38.067971 36.079345 36.079345 0 0 0-10.539714-27.272576 38.35206 38.35206 0 0 0-27.585074-9.943127 49.459953 49.459953 0 0 0-31.604938 10.511306 33.934471 33.934471 0 0 0 0 54.261062 50.440061 50.440061 0 0 0 31.604938 10.511306z"></path></symbol><symbol id="icon-xingzhuangkaobei" viewBox="0 0 1024 1024"><path d="M512 0a512 512 0 1 0 512 512A512 512 0 0 0 512 0z m276.16 380.96L441.92 727.36a19.008 19.008 0 0 1-26.56-1.76l-23.2-23.2-155.2-155.2a19.792 19.792 0 0 1 0-28.16l42.4-42.4a20.096 20.096 0 0 1 28.16 0l121.92 122.08 288.16-288.16a18.864 18.864 0 0 1 26.56 1.76l42.24 42.24a18.672 18.672 0 0 1 1.76 26.4z"></path></symbol><symbol id="icon-touxiang" viewBox="0 0 1024 1024"><path d="M914.272 802.848q0 68.576-41.728 108.288t-110.848 39.712H262.272q-69.152 0-110.848-39.712t-41.728-108.288q0-30.272 2.016-59.136t8-62.272 15.136-62.016 24.576-55.712 35.424-46.272 48.864-30.56 63.712-11.424q5.152 0 24 12.288t42.56 27.424 61.728 27.424T512 554.88t76.288-12.288 61.728-27.424 42.56-27.424 24-12.288q34.848 0 63.712 11.424t48.864 30.56 35.424 46.272 24.576 55.712 15.136 62.016 8 62.272 2.016 59.136zM731.424 292.576q0 90.848-64.288 155.136T512 512t-155.136-64.288-64.288-155.136 64.288-155.136T512 73.152t155.136 64.288 64.288 155.136z"></path></symbol><symbol id="icon-xin" viewBox="0 0 1164 1024"><path d="M1123.1869446875 325.13635625v-1.3175409375l0.338795625-6.211261875c0-2.2586409375 0.15057562500000002-4.5172809375 0.2070421875-6.775921875v-1.69398-9.7874428125c0-1.1293199999999999 0-3.5761809374999998-0.2070421875-6.964141875a235.0868446875 235.0868446875 0 0 0-11.7637528125-69.07675875c-1.8822009375-5.458381875000001-3.9526209374999994-10.728542812499999-6.0230418750000005-15.9987046875l-0.22586343749999999-0.5646599999999999a267.4042275 267.4042275 0 0 0-55.826068125-90.5338453125c-1.8822009375-2.0704209375-3.500893125-3.5761809374999998-4.4796365625000005-4.5172809375a11.293202812499999 11.293202812499999 0 0 0-1.4681165624999999-1.5057609374999998 222.58903312500001 222.58903312500001 0 0 0-48.9372140625-37.8322303125 220.330393125 220.330393125 0 0 0-23.791014375000003-12.798963749999999A231.924748125 231.924748125 0 0 0 914.7520587500001 39.982977500000004a8.3381484375 8.3381484375 0 0 0-2.4656821875-0.5646609375 269.8887328125 269.8887328125 0 0 0-138.98168625 3.5761809374999998 281.78424 281.78424 0 0 0-56.8989225 22.3981865625c-6.154795312499999 3.0115209375000003-12.328413750000001 6.211261875-18.596140312499998 9.5992228125-1.0540321875 0.75288-2.0704209375 1.31754-3.0679875 2.0704200000000004-0.39526218750000003 0.18822-2.6350809375 1.8822009375-6.135973125 4.517281875a310.5630853125 310.5630853125 0 0 0-70.82720625 62.677276875c-1.76926875 2.0704209375-3.5197153125000002 3.9526209374999994-5.194873125 6.0230418750000005l-11.293202812499999 13.17540375c-4.536103125 5.458381875000001-9.411002812500001 11.1049828125-14.3611903125 16.9398046875l-9.109850625 10.728542812499999-9.109850625-10.728542812499999c-4.9313653125000005-5.834821875-9.82508625-11.4814228125-14.361189375-16.9398046875l-11.29320375-13.17540375c-1.67515875-2.0704209375-3.4256053125-3.9526209374999994-5.194873125-6.0230418750000005a310.1866453125 310.1866453125 0 0 0-70.808383125-62.677276875c-3.500893125-2.6350809375-5.740711875000001-4.3290609374999995-6.1359740625-4.517281875-0.9975665625-0.75288-2.013954375-1.31754-3.0679865625-2.0704200000000004q-9.411002812500001-5.0819409375-18.614963437500002-9.5992228125A281.59601999999995 281.59601999999995 0 0 0 382.3528203125 42.99449750000002 269.8887328125 269.8887328125 0 0 0 243.3711340625 39.41831656249997a8.2063940625 8.2063940625 0 0 0-2.465683125 0.5646609375A231.924748125 231.924748125 0 0 0 184.64647718749995 59.55786218750001a269.1546740625 269.1546740625 0 0 0-72.65293968750001 50.6311940625 10.182705 10.182705 0 0 0-1.4681165624999999 1.5057609374999998 127.04853468750001 127.04853468750001 0 0 0-4.4984596875000005 4.5172809375A267.2724740625 267.2724740625 0 0 0 50.21971625000003 206.7459434375l-0.225864375 0.5646599999999999c-2.0704209375 5.270161875-4.1031975 10.5403228125-6.0230409375 15.9987046875a234.3904303125 234.3904303125 0 0 0-11.763753750000001 69.07675875c-0.1693978125 3.3879609375-0.2070421875 5.834821875-0.2070421875 6.964141875v11.4814228125c0 2.2586409375 0.1129321875 4.5172809375 0.2070421875 6.775921875s0.2070421875 4.140840937499999 0.319974375 6.211261875v1.3175409375a370.0782665625 370.0782665625 0 0 0 58.611723749999996 176.73862875 479.73526875 479.73526875 0 0 0 47.996113124999994 68.70031875 1325.5585378125 1325.5585378125 0 0 0 159.40356281249998 175.79752875h0.11293125l255.5463646875 236.4043846875a34.7830659375 34.7830659375 0 0 0 23.376930937500003 9.2227828125h0.22586343749999999a34.820709375 34.820709375 0 0 0 23.376930937500003-9.2227828125l255.5463646875-236.4043846875h0.1129321875a1325.5585378125 1325.5585378125 0 0 0 159.40356187499998-175.79752875 481.2974953125 481.2974953125 0 0 0 47.996113124999994-68.70031875 370.51117218750005 370.51117218750005 0 0 0 58.950520312500004-176.73862875zM810.2711084375001 694.2358775l-18.2949890625 15.6222646875-25.5791053125 23.9039465625c-62.6960990625 58.5364359375-147.73391906249998 137.4006375-188.370628125 175.0446478125-40.6367090625-37.6440103125-125.6745290625-116.508211875-188.370628125-175.0446478125l-25.5791053125-23.9039465625-18.2949890625-15.6222646875c-39.52621125-36.891130312499996-98.34497718749999-103.8974690625-98.34497625-103.897468125l-22.79344875-26.727247499999997a1448.9932481249998 1448.9932481249998 0 0 1-30.1152084375-36.1382503125c-11.293202812499999-15.245823750000001-20.704205625-28.7976675-28.552981875-40.65553125a487.301715 487.301715 0 0 1-45.41749875-82.2521625 307.11865875 307.11865875 0 0 1-18.031480312499998-79.2406415625c-0.6399478125-8.093461875-0.9599221874999999-16.5633646875-0.82816875-25.221487500000002v-0.9411a216.1519078125 216.1519078125 0 0 1 13.438911562500001-66.62989875000001 229.34613375 229.34613375 0 0 1 44.0246709375-70.39429875c0.6399478125-0.5646599999999999 0.9599221874999999-0.9411 1.5810478125-1.5057609374999998s1.2798965625-1.31754 1.8822009375-2.0704209375a187.260129375 187.260129375 0 0 1 35.159505-26.3508065625 1.22343 1.22343 0 0 1 0.63994875-0.37644l2.0704200000000004-1.1293209375a243.048553125 243.048553125 0 0 1 54.5838159375-21.645305625 228.423855 228.423855 0 0 1 23.18871-3.9526209374999994 231.002469375 231.002469375 0 0 1 128.5731178125 22.586405624999998 238.64420437500002 238.64420437500002 0 0 1 21.2876878125 12.23430375 448.7354259375 448.7354259375 0 0 1 57.538869375000004 50.8194140625c3.46324875 3.9526209374999994 9.411002812500001 10.728542812499999 16.3186790625 19.010225625l13.6271315625 15.998703749999999c17.5421090625 20.704205625 35.5359459375 42.16129125 35.761809375 42.5377321875a35.366548124999994 35.366548124999994 0 0 0 3.764401875 3.7644009375000005 35.761810312499996 35.761810312499996 0 0 0 16.9398046875 8.093461875c0.9411 0.18822 1.8822009375 0.18822 2.8421221875000002 0.37644h5.7971775c0.9411-0.18822 1.8822009375-0.18822 2.8421231249999996-0.37644a35.761810312499996 35.761810312499996 0 0 0 16.9398046875-8.093461875 35.366548124999994 35.366548124999994 0 0 0 3.7644009375000005-3.7644009375000005c0.3011521875-0.37644 18.2949890625-21.833525625 35.761810312499996-42.5377321875l13.6271315625-15.998703749999999c6.9264975-8.281681874999999 12.855429375-15.057603750000002 16.299855937500002-19.010225625a449.9588559375 449.9588559375 0 0 1 57.5576925-50.8194140625 236.0091234375 236.0091234375 0 0 1 21.2876878125-12.23430375 231.002469375 231.002469375 0 0 1 128.5731178125-22.586405624999998 227.106315 227.106315 0 0 1 23.1698878125 3.9526209374999994 248.45046843749998 248.45046843749998 0 0 1 54.583815 21.457085624999998 13.64595375 13.64595375 0 0 0 2.089243125 1.3175409375 1.1104987499999999 1.1104987499999999 0 0 1 0.6211256249999999 0.37644 187.4107059375 187.4107059375 0 0 1 35.178328125 26.3508065625c0.6399478125 0.75288 1.2798965625 1.31754 1.8822 2.0704209375s0.9411 0.9411 1.5810487500000001 1.5057609374999998a229.34613375 229.34613375 0 0 1 44.02467 70.39429875 216.8106778125 216.8106778125 0 0 1 13.438911562500001 66.62989875000001v0.9411c0.1129321875 8.6581228125-0.18822 17.128024687499998-0.84699 25.221487500000002a305.5564321875 305.5564321875 0 0 1-18.03148125 79.2406415625 485.6077340625 485.6077340625 0 0 1-45.4174978125 82.2521625c-7.811131874999999 11.857862812499999-17.2786003125 25.409706562500002-28.534160625 40.65553125-8.41343625 10.3521028125-18.31381125 22.3981865625-30.115207500000004 36.1382503125l-22.79344875 26.727247499999997s-58.36703812499999 67.00633875-97.9308928125 103.897468125z"></path></symbol><symbol id="icon-xin1" viewBox="0 0 1164 1024"><path d="M1123.1869446875 325.13635625v-1.3175409375l0.338795625-6.211261875c0-2.2586409375 0.15057562500000002-4.5172809375 0.2070421875-6.775921875v-1.69398-9.7874428125c0-1.1293199999999999 0-3.5761809374999998-0.2070421875-6.964141875a235.0868446875 235.0868446875 0 0 0-11.7637528125-69.07675875c-1.8822009375-5.458381875000001-3.9526209374999994-10.728542812499999-6.0230418750000005-15.9987046875l-0.22586343749999999-0.5646599999999999a267.4042275 267.4042275 0 0 0-55.826068125-90.5338453125c-1.8822009375-2.0704209375-3.500893125-3.5761809374999998-4.4796365625000005-4.5172809375a11.293202812499999 11.293202812499999 0 0 0-1.4681165624999999-1.5057609374999998 222.58903312500001 222.58903312500001 0 0 0-48.9372140625-37.8322303125 220.330393125 220.330393125 0 0 0-23.791014375000003-12.798963749999999A231.924748125 231.924748125 0 0 0 914.7520587500001 39.982977500000004a8.3381484375 8.3381484375 0 0 0-2.4656821875-0.5646609375 269.8887328125 269.8887328125 0 0 0-138.98168625 3.5761809374999998 281.78424 281.78424 0 0 0-56.8989225 22.3981865625c-6.154795312499999 3.0115209375000003-12.328413750000001 6.211261875-18.596140312499998 9.5992228125-1.0540321875 0.75288-2.0704209375 1.31754-3.0679875 2.0704200000000004-0.39526218750000003 0.18822-2.6350809375 1.8822009375-6.135973125 4.517281875a310.5630853125 310.5630853125 0 0 0-70.82720625 62.677276875c-1.76926875 2.0704209375-3.5197153125000002 3.9526209374999994-5.194873125 6.0230418750000005l-11.293202812499999 13.17540375c-4.536103125 5.458381875000001-9.411002812500001 11.1049828125-14.3611903125 16.9398046875l-9.109850625 10.728542812499999-9.109850625-10.728542812499999c-4.9313653125000005-5.834821875-9.82508625-11.4814228125-14.361189375-16.9398046875l-11.29320375-13.17540375c-1.67515875-2.0704209375-3.4256053125-3.9526209374999994-5.194873125-6.0230418750000005a310.1866453125 310.1866453125 0 0 0-70.808383125-62.677276875c-3.500893125-2.6350809375-5.740711875000001-4.3290609374999995-6.1359740625-4.517281875-0.9975665625-0.75288-2.013954375-1.31754-3.0679865625-2.0704200000000004q-9.411002812500001-5.0819409375-18.614963437500002-9.5992228125A281.59601999999995 281.59601999999995 0 0 0 382.3528203125 42.99449750000002 269.8887328125 269.8887328125 0 0 0 243.3711340625 39.41831656249997a8.2063940625 8.2063940625 0 0 0-2.465683125 0.5646609375A231.924748125 231.924748125 0 0 0 184.64647718749995 59.55786218750001a269.1546740625 269.1546740625 0 0 0-72.65293968750001 50.6311940625 10.182705 10.182705 0 0 0-1.4681165624999999 1.5057609374999998 127.04853468750001 127.04853468750001 0 0 0-4.4984596875000005 4.5172809375A267.2724740625 267.2724740625 0 0 0 50.21971625000003 206.7459434375l-0.225864375 0.5646599999999999c-2.0704209375 5.270161875-4.1031975 10.5403228125-6.0230409375 15.9987046875a234.3904303125 234.3904303125 0 0 0-11.763753750000001 69.07675875c-0.1693978125 3.3879609375-0.2070421875 5.834821875-0.2070421875 6.964141875v11.4814228125c0 2.2586409375 0.1129321875 4.5172809375 0.2070421875 6.775921875s0.2070421875 4.140840937499999 0.319974375 6.211261875v1.3175409375a370.0782665625 370.0782665625 0 0 0 58.611723749999996 176.73862875 479.73526875 479.73526875 0 0 0 47.996113124999994 68.70031875 1325.5585378125 1325.5585378125 0 0 0 159.40356281249998 175.79752875h0.11293125l255.5463646875 236.4043846875a34.7830659375 34.7830659375 0 0 0 23.376930937500003 9.2227828125h0.22586343749999999a34.820709375 34.820709375 0 0 0 23.376930937500003-9.2227828125l255.5463646875-236.4043846875h0.1129321875a1325.5585378125 1325.5585378125 0 0 0 159.40356187499998-175.79752875 481.2974953125 481.2974953125 0 0 0 47.996113124999994-68.70031875 370.51117218750005 370.51117218750005 0 0 0 58.950520312500004-176.73862875z"></path></symbol><symbol id="icon-faxianwei" viewBox="0 0 1024 1024"><path d="M751.532699 242.420532l-305.670114 141.134766a31.824793 31.824793 0 0 0-4.782494 2.632565 151.533399 151.533399 0 0 0-69.207223 131.628279l0.087752 2.486312a151.021512 151.021512 0 0 0 145.712504 145.814882h4.884872a151.401771 151.401771 0 0 0 129.434474-73.565583 19.46636 19.46636 0 0 0 1.243156-2.340058l149.924609-294.116076a39.488484 39.488484 0 0 0-51.627536-53.675087zM583.648143 553.209523a71.986043 71.986043 0 0 1-61.031646 34.077099h-2.354683a71.986043 71.986043 0 0 1-69.382729-69.47048v-2.486312a72.220049 72.220049 0 0 1 30.932646-61.42653l199.446093-92.139795zM965.691909 275.181348a39.488484 39.488484 0 0 0-69.938492 36.563411A432.79378 432.79378 0 1 1 732.168717 139.16546a39.503109 39.503109 0 0 0 40.219752-68.007944 511.88775 511.88775 0 1 0-299.936971 951.08744c13.469961 1.170029 26.88142 1.60879 40.234377 1.60879A512.034004 512.034004 0 0 0 965.691909 275.181348z" fill="#888888"></path></symbol><symbol id="icon-wodewei" viewBox="0 0 1024 1024"><path d="M769.367642 662.972352a377.70549 377.70549 0 0 0 127.841168-282.677923 385.183578 385.183578 0 0 0-770.305097 0 377.302108 377.302108 0 0 0 127.996315 282.677923C100.063274 710.292202 50.261071 883.126014 46.692689 981.334096A41.54838 41.54838 0 0 0 87.030922 1023.999535h1.55147a41.579409 41.579409 0 0 0 41.734556-39.872792c0.310294-10.239705 11.325735-251.027925 210.689692-251.027925a42.944703 42.944703 0 0 0 17.841911-4.033823 388.395122 388.395122 0 0 0 306.415421 0 42.944703 42.944703 0 0 0 17.841911 4.033823c198.277928 0 210.379398 240.633073 210.689692 251.183072A41.672497 41.672497 0 0 0 935.530131 1023.999535h1.551471a41.54838 41.54838 0 0 0 40.338233-42.665439c-3.568382-98.208082-53.370585-271.041894-208.052193-318.361744zM210.527972 380.294429A301.559319 301.559319 0 1 1 512.133835 678.021616a300.038878 300.038878 0 0 1-301.605863-297.727187z" fill="#888888"></path></symbol><symbol id="icon-zhuanlanwei" viewBox="0 0 1089 1024"><path d="M982.593302 32.133082l-19.745864-7.254871a413.354111 413.354111 0 0 0-152.983131-24.603472 396.44711 396.44711 0 0 0-152.983131 24.603472l-113.554489 46.683513-113.554489-46.683513a404.79021 404.79021 0 0 0-152.983131-24.603472 396.510196 396.510196 0 0 0-152.983131 24.603472l-19.745864 9.778304c-56.777244 22.08004-106.126133 93.524739-103.665786 155.03342v713.65842c0 51.730378 27.158449 86.112154 74.125847 86.112155a106.804305 106.804305 0 0 0 37.01561-7.412585l19.745863-7.25487a471.913531 471.913531 0 0 1 286.315027 0l123.41165 49.206945 130.824234-46.841227a475.067822 475.067822 0 0 1 286.299255 0l19.745864 7.412585a100.038351 100.038351 0 0 0 37.031381 7.412585c41.952075 0 74.04699-34.53949 74.04699-86.112154V189.689935a176.813802 176.813802 0 0 0-106.362705-157.556853z m24.68233 883.51701a19.714321 19.714321 0 0 1-7.396813-2.365719l-19.745864-5.046866a517.713841 517.713841 0 0 0-172.77631-29.492624 464.153974 464.153974 0 0 0-172.776309 29.492624l-93.792854 36.905209-93.792853-36.905209a517.713841 517.713841 0 0 0-172.77631-29.492624 473.348733 473.348733 0 0 0-172.776309 29.492624l-19.745864 7.412585a18.783805 18.783805 0 0 1-7.396813 2.523433V189.689935a108.25528 108.25528 0 0 1 56.777245-83.746436l17.348602-7.25487c64.174058-24.603473 185.12536-24.603473 249.299418 0l106.126133 41.794361v634.958851a37.062923 37.062923 0 0 0 74.125847 0V137.959557l103.665785-41.794361c64.174058-24.603473 185.12536-24.603473 249.299418 0l19.745864 7.412585a112.071972 112.071972 0 0 1 56.777244 86.112154v725.960157z" fill="#888888"></path></symbol><symbol id="icon-faxian" viewBox="0 0 1024 1024"><path d="M751.532699 242.274278l-305.670114 141.28102a31.824793 31.824793 0 0 0-4.782494 2.632565 151.284768 151.284768 0 0 0-69.207223 131.482025l0.087752 2.632566a151.021512 151.021512 0 0 0 145.712504 145.814882h4.884872a151.401771 151.401771 0 0 0 129.434474-73.565583 19.46636 19.46636 0 0 0 1.243156-2.340058l149.924609-294.116076a39.488484 39.488484 0 0 0-51.627536-53.821341zM965.691909 275.181348a39.488484 39.488484 0 0 0-69.938492 36.563411A431.901633 431.901633 0 1 1 732.168717 139.019207a39.488484 39.488484 0 1 0 40.219752-67.861691 511.88775 511.88775 0 1 0-299.936971 951.08744c13.469961 1.170029 26.88142 1.60879 40.234377 1.60879A512.048629 512.048629 0 0 0 965.691909 275.181348z" fill="#000000"></path></symbol><symbol id="icon-zhuanlan" viewBox="0 0 1089 1024"><path d="M982.593605 32.132776l-19.74587-7.254872a488.221367 488.221367 0 0 0-306.060985 0 490.94983 490.94983 0 0 0-59.931555 24.60348c-11.040023 7.570302-19.09924 11.986311-19.09924 40.690371v709.715775a37.062935 37.062935 0 0 1-74.12587 0v-709.715775c0-34.539501-8.20116-35.643503-21.48073-43.686949a433.415538 433.415538 0 0 0-52.566282-21.606902 404.790335 404.790335 0 0 0-152.983178-24.603481 396.510318 396.510318 0 0 0-152.983178 24.603481l-19.74587 9.778306c-56.777262 22.080046-106.126166 93.524768-103.665818 155.033468v713.65864c0 51.730394 27.158457 86.112181 74.12587 86.112181a106.804338 106.804338 0 0 0 37.01562-7.412587l19.74587-7.254872a471.913676 471.913676 0 0 1 286.315115 0l123.411688 49.20696 130.824274-46.841241a475.067968 475.067968 0 0 1 286.299344 0l19.74587 7.412587a100.038381 100.038381 0 0 0 37.031392 7.412587c41.952088 0 74.047013-34.539501 74.047012-86.112181V189.689678a176.813857 176.813857 0 0 0-106.173479-157.556902z" fill="#000000"></path></symbol><symbol id="icon-wode" viewBox="0 0 1024 1024"><path d="M769.367642 662.972352a377.70549 377.70549 0 0 0 127.841168-282.677923 385.183578 385.183578 0 0 0-770.305097 0 377.302108 377.302108 0 0 0 127.996315 282.677923C100.063274 710.292202 50.261071 883.126014 46.692689 981.334096A41.54838 41.54838 0 0 0 87.030922 1023.999535h1.55147a41.579409 41.579409 0 0 0 41.734556-39.872792c0.310294-10.239705 11.325735-251.027925 210.689692-251.027925a42.944703 42.944703 0 0 0 17.841911-4.033823 388.395122 388.395122 0 0 0 306.415421 0 42.944703 42.944703 0 0 0 17.841911 4.033823c198.277928 0 210.379398 240.633073 210.689692 251.183072A41.672497 41.672497 0 0 0 935.530131 1023.999535h1.551471a41.54838 41.54838 0 0 0 40.338233-42.665439c-3.568382-98.208082-53.370585-271.041894-208.052193-318.361744z" fill="#FF5A05"></path></symbol><symbol id="icon-xingzhuang3" viewBox="0 0 1024 1024"><path d="M871.298246 913.156491A110.753684 110.753684 0 0 1 760.598456 1024H263.401544A110.753684 110.753684 0 0 1 152.701754 913.156491V110.843509A110.753684 110.753684 0 0 1 263.401544 0h497.178947a110.753684 110.753684 0 0 1 110.69979 110.843509v802.312982zM807.415018 110.843509a46.852491 46.852491 0 0 0-46.816562-46.888421H263.401544a46.852491 46.852491 0 0 0-46.816562 46.888421v802.312982a46.852491 46.852491 0 0 0 46.816562 46.888421h497.178947a46.852491 46.852491 0 0 0 46.816562-46.888421V110.843509z m31.205052 705.122807H183.906807a15.988772 15.988772 0 0 1 0-31.977544H838.602105a15.988772 15.988772 0 0 1 0 31.977544z m0-640.089825H183.906807a15.988772 15.988772 0 0 1 0-31.977544H838.602105a15.988772 15.988772 0 0 1 0 31.977544zM551.936 884.053333a27.863579 27.863579 0 0 1-27.953404 27.845614h-7.976421a27.863579 27.863579 0 0 1-27.953403-27.845614v-8.08421a28.007298 28.007298 0 0 1 27.953403-28.025263h7.976421a28.007298 28.007298 0 0 1 27.953404 28.025263v8.08421z m32.336842-423.79228a18.324211 18.324211 0 0 1-5.389474-0.898246 16.042667 16.042667 0 0 1-9.772912-20.48l4.329544-12.395789a16.006737 16.006737 0 0 1 30.127158 10.778947l-4.329544 12.21614a15.934877 15.934877 0 0 1-15.072561 10.778948z m-60.883088 173.720701a18.108632 18.108632 0 0 1-5.281684-0.898245 15.916912 15.916912 0 0 1-9.790877-20.300351l45.289544-129.347369a15.970807 15.970807 0 0 1 30.127158 10.599299l-45.289544 129.167719a15.934877 15.934877 0 0 1-15.054597 10.778947z m-64.673684-120.72421a13.779088 13.779088 0 0 1-5.389474-0.898246 15.916912 15.916912 0 0 1-9.772912-20.300351l66.218667-188.990877a15.934877 15.934877 0 0 1 20.354245-9.880702 16.168421 16.168421 0 0 1 9.772913 20.48l-66.218667 188.990878a15.755228 15.755228 0 0 1-15.054596 10.599298z m-31.097263 88.746667a18.108632 18.108632 0 0 1-5.281684-0.898246 16.042667 16.042667 0 0 1-9.790877-20.48l9.754947-27.665965a15.970807 15.970807 0 1 1 30.127158 10.599298l-9.754947 27.665965a15.934877 15.934877 0 0 1-15.054597 10.778948z"></path></symbol><symbol id="icon-xingzhuang4" viewBox="0 0 1024 1024"><path d="M312.768 222.624a64 64 0 1 0 63.808 64 62.24 62.24 0 0 0-63.808-64z m288.288 0a64 64 0 1 0 63.808 64 62.256 62.256 0 0 0-63.808-64z m-14.4 353.504a48 48 0 0 0 0 95.488 48 48 0 1 0-0.032-95.488z m191.888 0a48 48 0 0 0 0 95.488 48 48 0 1 0-0.032-95.488zM1024 683.36A285.12 285.12 0 0 0 913.424 464c0.336-3.952 0.512-7.664 0.512-11.088 0-330.544-235.552-452.896-459.2-452.896C204.8 0 0 178.656 0 405.616c0 130.976 68.064 238.528 181.968 322l1.104 106.944 112.464-47.04a579.088 579.088 0 0 0 83.456 14.08c51.008 106.4 168.96 181.12 309.264 181.12a482.144 482.144 0 0 0 118.608-20.64L915.28 1024l-29.728-103.04C964.8 858.72 1024 776.32 1024 683.36z m-672.096 0a271.68 271.68 0 0 0 4.8 51.2 1094.432 1094.432 0 0 1-36.512-7.264l-11.744-2.464-19.424-4.048-18.32 7.664-24.672 10.32-0.112-11.776-0.336-32-25.84-18.928a416.592 416.592 0 0 1-116.208-123.76A286.176 286.176 0 0 1 64 405.616a318.896 318.896 0 0 1 112-240 395.2 395.2 0 0 1 124.56-74.176A439.12 439.12 0 0 1 454.784 64a495.392 495.392 0 0 1 147.072 21.392 365.088 365.088 0 0 1 125.536 66.4 315.056 315.056 0 0 1 87.696 116.8 435.04 435.04 0 0 1 34.064 153.856 358.88 358.88 0 0 0-160.976-38.4C500.08 384 351.904 518.4 351.904 683.36z m494.176 187.2l-29.696 23.2-0.464-0.32-25.28 6.72a433.776 433.776 0 0 1-102.4 18.56 308.672 308.672 0 0 1-109.376-19.52 273.424 273.424 0 0 1-86.624-51.84 214.288 214.288 0 0 1 0-327.856 273.6 273.6 0 0 1 86.624-52.032A309.744 309.744 0 0 1 688.176 448a292.576 292.576 0 0 1 104.624 19.376 288 288 0 0 1 87.68 52.544 243.6 243.6 0 0 1 58.592 75.328A198.24 198.24 0 0 1 960 683.36a184.144 184.144 0 0 1-29.936 96.8 353.104 353.104 0 0 1-83.984 90.4z"></path></symbol><symbol id="icon-xingzhuang5" viewBox="0 0 1102 1024"><path d="M26.385044 538.385241H1012.083018L564.324889 979.842464a25.321766 25.321766 0 0 0 0 36.624015 26.503186 26.503186 0 0 0 37.017822 0l489.107825-482.806918a25.164243 25.164243 0 0 0 12.208005-21.265557 25.833714 25.833714 0 0 0-6.694713-16.539879l0.393807-0.393806-1.18142-1.18142h-0.393807L601.342711 7.533914a26.503186 26.503186 0 0 0-37.017822 0 25.676192 25.676192 0 0 0 0 36.624016l448.545742 442.638643H26.385044a25.794334 25.794334 0 1 0 0 51.588668z"></path></symbol><symbol id="icon-g" viewBox="0 0 1024 1024"><path d="M592.859991 475.113495v86.004747H769.708167v239.267165a385.429099 385.429099 0 0 1-93.30778 33.623208 441.040176 441.040176 0 0 1-97.651341 11.579077q-16.879121 0-33.116835-1.417846V198.183385a349.397802 349.397802 0 0 1 24.440967-0.945231 296.363604 296.363604 0 0 1 114.462945 23.158154 261.682637 261.682637 0 0 1 94.939429 66.154901L847.824738 213.802198A311.881143 311.881143 0 0 0 722.446629 134.380308a461.463912 461.463912 0 0 0-145.880616-23.158154c-10.465055 0-20.750066 0.438857-30.945055 1.125275V0H486.138936v120.033055a413.403429 413.403429 0 0 0-202.54945 104.20044 379.150066 379.150066 0 0 0-88.39033 129.024A426.771692 426.771692 0 0 0 163.18509 521.407297a443.763341 443.763341 0 0 0 30.382418 167.047033 376.719473 376.719473 0 0 0 85.183296 129.564132 384.742681 384.742681 0 0 0 129.665407 83.799208 408.542242 408.542242 0 0 0 77.722725 22.15666V1024h59.425759v-93.217758c9.125978 0.483868 18.330725 0.810198 27.704263 0.810198a630.558945 630.558945 0 0 0 148.153671-17.644308A535.957099 535.957099 0 0 0 860.85542 858.80967v-383.718681H592.859991zM449.635024 821.338022a291.446154 291.446154 0 0 1-100.352-67.809055 310.789626 310.789626 0 0 1-65.108395-103.120176 350.320527 350.320527 0 0 1-23.326945-129.001494 353.437538 353.437538 0 0 1 23.326945-130.104264 304.499341 304.499341 0 0 1 65.097142-102.546286 301.089758 301.089758 0 0 1 98.191473-67.268923 289.994549 289.994549 0 0 1 38.731956-13.390769v625.596483a304.150505 304.150505 0 0 1-36.560176-12.355516z"></path></symbol><symbol id="icon-weibiaoti-" viewBox="0 0 1024 1024"><path d="M512 1024A512 512 0 1 1 1024 512 512 512 0 0 1 512 1024z m0-947.2A435.2 435.2 0 1 0 947.2 512 435.2 435.2 0 0 0 512 76.8z m211.499886 477.5936l-307.6096 183.413029a32.416914 32.416914 0 0 1-3.4816 1.111771c-0.877714 0.380343-1.784686 0.526629-2.691657 0.877714a39.087543 39.087543 0 0 1-11.966172 2.399086c-0.321829 0-0.6144 0.2048-0.965486 0.2048s-1.2288-0.351086-1.901714-0.380343a39.263086 39.263086 0 0 1-12.405028-2.516114c-0.526629-0.2048-0.936229-0.468114-1.4336-0.672914a36.981029 36.981029 0 0 1-17.729829-14.453029 32.709486 32.709486 0 0 1-1.901714-5.412571 33.850514 33.850514 0 0 1-2.574629-12.843886c0-0.702171-0.4096-1.316571-0.4096-2.018743V319.985371c0-0.702171 0.351086-1.316571 0.4096-2.018742a33.938286 33.938286 0 0 1 2.574629-12.843886 32.182857 32.182857 0 0 1 1.901714-5.441829 37.127314 37.127314 0 0 1 17.759086-14.453028 13.633829 13.633829 0 0 1 1.375085-0.643657 39.087543 39.087543 0 0 1 12.522058-2.633143c0.643657 0 1.199543-0.351086 1.8432-0.351086s0.585143 0.175543 0.936228 0.175543a38.912 38.912 0 0 1 12.053943 2.428343c0.877714 0.292571 1.784686 0.468114 2.633143 0.848457a33.909029 33.909029 0 0 1 3.4816 1.111771l307.580343 183.413029a48.010971 48.010971 0 0 1 26.331428 42.949486 49.737143 49.737143 0 0 1-26.331428 41.866971zM649.508571 512l-214.396342-127.853714v255.678171z"></path></symbol><symbol id="icon-dianji" viewBox="0 0 1024 1024"><path d="M686.027 362.189c-6.642 0-12.861 1.093-18.95 3.162-0.638-0.338-1.292-0.556-1.982-0.757-11.384-18.209-30.737-29.391-52.559-29.391a65.179 65.179 0 0 0-21.469 3.617c-11.265-18.964-31.071-30.634-53.396-30.634-4.001 0-7.937 0.353-11.789 1.058v-34.416c0-35.862-27.505-63.955-62.625-63.955-35.476 0-64.343 28.683-64.343 63.955v168.986l-9.887-9.87c-11.464-11.381-27.454-17.669-45.022-17.669-17.688 0-34.854 6.622-45.918 17.7-24.108 24.111-32.144 65.973-3.832 94.305l144.44 143.477c3.309 3.281 7.11 6.272 11.281 8.88 27.099 21.941 59.379 36.499 127.623 36.499 158.613 0 171.894-92.989 171.894-188.25V426.179c-0.02-35.896-27.307-63.991-63.469-63.991z m38.267 166.681c0 92.371-10.809 163.032-146.674 163.032-61.567 0-88.618-12.003-112.358-31.357l-1.447-1.022c-2.776-1.682-5.246-3.58-7.347-5.686L312.063 510.393c-18.88-18.896-9.114-45.645 3.848-58.61 6.356-6.352 17.119-10.307 28.094-10.307 10.861 0 20.546 3.685 27.238 10.326l52.893 52.706V274.795c0-21.367 17.551-38.735 39.123-38.735 20.981 0 37.407 17.016 37.407 38.735v73.152l0.321-0.167v75.154c0 6.958 5.65 12.608 12.609 12.608 6.962 0 12.608-5.649 12.608-12.608v-87.649c3.701-1.141 7.502-1.934 11.482-1.934 16.275 0 29.842 10.088 35.391 26.281l1.597 4.675v82.532c0 6.958 5.65 12.609 12.612 12.609 6.958 0 12.609-5.65 12.609-12.609v-84.181c4.085-1.363 8.337-2.287 12.639-2.287 16.278 0 29.827 10.086 35.392 26.276l0.856 2.504v82.5c0 6.962 5.65 12.608 12.609 12.608 6.962 0 12.608-5.647 12.608-12.608V389.84c4.054-1.494 8.273-2.468 13.386-2.468 21.014 0 36.872 16.657 36.887 38.769v102.726h0.02z m-364.5-135.357c2.255 1.697 4.911 2.487 7.516 2.487 3.848 0 7.649-1.748 10.12-5.079 4.169-5.6 3.009-13.501-2.588-17.654-33.744-25.116-53.114-63.635-53.114-105.649 0-72.547 59.03-131.591 131.592-131.591 72.565 0 131.612 59.046 131.612 131.591 0 8.809-0.875 17.653-2.607 26.228-1.378 6.827 3.043 13.484 9.87 14.863 6.823 1.328 13.48-3.059 14.859-9.869a157.413 157.413 0 0 0 3.111-31.205c0-86.467-70.359-156.811-156.83-156.811-86.467 0-156.811 70.359-156.811 156.811 0 49.33 23.656 96.388 63.265 125.878z m0 0z"></path></symbol><symbol id="icon-video" viewBox="0 0 1422 1024"><path d="M1292.941504 0.000284H129.279928A129.023928 129.023928 0 0 0 0 128.000213v767.999574A129.023928 129.023928 0 0 0 129.279928 1023.999716h1163.661576A129.023928 129.023928 0 0 0 1422.221432 895.999787v-767.999574A129.023928 129.023928 0 0 0 1292.941504 0.000284zM930.929261 569.599968l-265.045186 166.399908c-45.255086 31.999982-90.510172 12.799993-90.510172-44.799976V332.8001c0-57.599968 38.798201-76.799957 90.510172-44.799976l265.045186 166.399908c51.711971 31.999982 51.711971 83.199954 0 115.199936z"></path></symbol><symbol id="icon-fire" viewBox="0 0 1024 1024"><path d="M536.841481 0a394.770963 394.770963 0 0 1 45.511112 191.070815c0 153.220741-73.367704 277.598815-163.972741 277.598815-70.580148 0-130.199704-75.96563-153.448296-181.930667C182.897778 399.985778 113.777778 534.072889 113.777778 666.718815 113.777778 864.06637 292.02963 1024 512 1024s398.222222-159.93363 398.222222-357.281185C910.222222 308.451556 551.461926 12.003556 536.841481 0z m-21.617777 938.666667c-134.144 0-174.193778-101.527704-167.329185-142.506667 13.729185-81.540741 96.161185-94.966519 158.568296-94.966519 148.176593 0 207.815111-150.793481 211.456-189.781333 0 0 53.342815 427.254519-202.695111 427.254519z"></path></symbol><symbol id="icon-line" viewBox="0 0 1024 1024"><path d="M6.5641024 0h157.538462v1024H6.5641024z"></path></symbol><symbol id="icon-circle" viewBox="0 0 1024 1024"><path d="M496 503.338667m-489.344 0a489.344 489.344 0 1 0 978.688 0 489.344 489.344 0 1 0-978.688 0Z"></path></symbol><symbol id="icon-lock" viewBox="0 0 1024 1024"><path d="M507.180564 589.653605a24.397417 24.397417 0 0 0-26.32167 21.855283v166.862794a26.780666 26.780666 0 0 0 52.64334 0v-166.915755a24.397417 24.397417 0 0 0-26.32167-21.802322z m332.172062-223.672408h-57.092073V277.183075a278.593076 278.593076 0 0 0-77.67629-195.779559A272.27305 272.27305 0 0 0 507.180564 0.019949a272.255397 272.255397 0 0 0-197.403699 81.34826 278.593076 278.593076 0 0 0-77.67629 195.779558v88.780469H184.559154A92.946743 92.946743 0 0 0 88.275862 454.885242v480.004165A92.946743 92.946743 0 0 0 184.559154 1023.934681h654.793472A92.946743 92.946743 0 0 0 935.653572 934.889407v-480.004165a92.946743 92.946743 0 0 0-96.283292-88.97466zM283.878883 277.183075A219.382558 219.382558 0 0 1 507.180564 51.868872 219.382558 219.382558 0 0 1 730.499898 277.183075v88.780468H283.878883V277.183075z m599.99638 657.706332a41.344971 41.344971 0 0 1-44.504983 37.072775H184.559154a41.344971 41.344971 0 0 1-44.504983-37.072775v-480.004165a41.344971 41.344971 0 0 1 44.504983-37.072775h654.793472a41.344971 41.344971 0 0 1 44.504983 37.072775v480.004165z"></path></symbol><symbol id="icon-arrowright1-copy" viewBox="0 0 1024 1024"><path d="M105.34425701 267.649318L64.321958 308.671617 512 756.349659 959.677019 308.671617 918.65472 267.649318 512 674.30506099Z"></path></symbol><symbol id="icon-video-" viewBox="0 0 1611 1024"><path d="M1454.610963 13.198222H152.538074A126.596741 126.596741 0 0 0 26.093037 139.643259v745.775408a126.596741 126.596741 0 0 0 126.445037 126.445037h1302.034963a126.596741 126.596741 0 0 0 126.445037-126.445037V139.643259a126.520889 126.520889 0 0 0-126.407111-126.445037zM1543.130074 885.418667a88.632889 88.632889 0 0 1-88.519111 88.519111H152.538074A88.632889 88.632889 0 0 1 64.018963 885.418667V139.643259a88.632889 88.632889 0 0 1 88.519111-88.519111h1302.034963a88.632889 88.632889 0 0 1 88.519111 88.519111v745.775408z"></path><path d="M975.909926 457.234963l-268.781037-161.261037c-50.706963-30.416593-92.197926-6.940444-92.197926 52.186074v328.779852c0 59.126519 41.490963 82.602667 92.197926 52.186074l268.781037-161.298963c50.706963-30.416593 50.706963-80.175407 0-110.592z"></path></symbol><symbol id="icon-xingzhuang6" viewBox="0 0 1117 1024"><path d="M285.52529 664.619668l-0.152077 2.668949c0.253461-0.707157 0.532269-1.414314 0.811077-2.124007z m692.000212 179.704107c-3.725882-0.147008-17.362103 3.713209-17.995756 3.80192a412.128176 412.128176 0 0 0-2.407883-134.841445c-4.055382-21.767262-0.076038-34.034792 15.562527-47.397275 19.034948-16.236735 43.240508-42.366067 40.832626-73.364391a23.460384 23.460384 0 0 0-2.864114-8.503629c-19.643256-23.701172-42.961701-22.200681-66.406877-15.714604-70.031375 19.372052-132.788408 1.315464-208.117124-6.562115-0.887115-19.009602-1.748883-38.153539-2.635999-57.282268-0.101385-2.810887-2.23046-8.521371-3.624497-8.762159-1.039192-0.185027-4.765074 3.515509-5.778919 6.516491-11.60853 31.081967 5.525458 73.549418-37.309513 78.279008-13.560183-15.040397-26.43602-39.218077-30.035171-56.570042-4.308843-20.831989-20.555717-35.256476-17.38745-5.431677 1.77423 16.474989 16.753796 43.795589 32.189593 67.103896a19.263064 19.263064 0 0 1-14.751451 0.613376c-74.289525-24.220768-143.484477-58.906955-221.702654-35.829298 66.381531-4.09847 127.668488 16.099866 184.13968 46.733206 28.007481 15.187405 49.298235 11.058519 72.565988-1.062003 61.109535-31.844886 168.881306-14.361121 215.061966 36.029533 48.765966 53.226886 62.478226 184.79361 23.850715 245.675029-20.910562 32.949977-45.547007 65.851797-87.469517 71.106051-57.358306 7.190699-115.375612 10.295601-172.429765-5.426608a54.87185 54.87185 0 0 0-19.87137-1.323068c-95.098703 10.024397-190.04533 11.74033-284.814534-3.67519-58.803036-9.568166-82.045443-43.886835-89.80136-103.059924-8.085417-61.644338 16.348258-108.324317 9.04857-168.082903-8.161456 21.496058-16.474989 42.931286-24.332291 64.531263-4.435574 12.237115-4.384882 28.727311-12.698414 36.483228-32.189593 29.984479-87.925747 27.607012-119.583071-3.041536-13.230683-12.809937-24.53506-27.568992-37.613666-40.553818-21.823023-21.660808-41.669048-23.589649-62.351495-2.684156-20.251563 20.446728-33.380861 46.492418-27.297789 76.223436 19.212371 93.795912 113.525344 142.503582 191.870252 135.094906 41.821125-3.946393 47.29589-21.51887 71.628181-35.39081a12.450022 12.450022 0 0 1 3.751228-0.91753c6.463265 7.489783 10.848146 12.515922 17.362103 20.023447-9.910339 5.558408-25.548905-2.504198-29.097364 16.315308-5.854957 10.328551 19.719294 6.083073 26.005136 7.096919 7.654533 1.231822 15.866681 0.030415 23.141022 2.207648 103.564313 31.003394 194.531596 29.817195 299.971523 23.985049 11.963376-0.661534 39.945511-9.654343 51.173849-8.653171 21.468177 1.911099 42.70824 8.475748 64.632647 10.645377 0 8.914236-4.156766 37.236009-4.156766 47.506263-1.089884 7.900391 2.027691 11.246081 7.071572 3.071952 3.269652-5.337896 9.352724-46.484814 14.675413-49.03717 4.435574-2.126541 47.904198-0.955549 52.719963-1.921237s26.537405 43.798123 31.682671 45.227646c5.880304 1.632291 8.744417 2.473783-0.811077-20.677378-5.145266-10.001585-8.643032-16.804488-13.661567-26.583028 13.889683-1.335741 25.447521-4.410228 36.549128-3.188544 56.065653 6.16925 102.651852-19.093244 147.108975-46.685048 15.131643-9.37807 33.507592-25.414571 33.507592-47.176764-4.993189-23.22213-26.055828-23.949564-49.095466-24.862025zM240.91609 902.237161c-79.434791 35.545422-185.356295-4.359535-222.0575-83.013665-14.751451-31.576217-3.725882-58.724463 13.053261-83.895711 11.709915-17.600357 44.583854-12.419607 61.92061 7.64186a107.688129 107.688129 0 0 1 9.555494 14.62979c34.977668 57.20116 75.784947 67.453672 134.461253 33.730638 4.866458-2.788075 9.656878-5.654723 14.675413-8.602479-2.68669 39.223146-2.68669 58.042652 14.067105 111.211242a225.20549 225.20549 0 0 0-25.675636 8.308464z m633.349253-310.267123c49.222197 4.876597 105.034389-21.369327 132.661677-2.438298 12.014069 8.252702-42.37874 71.141535-58.77769 89.302042-15.28372-35.841971-39.03305-61.783742-73.883987-86.853605zM286.18429 665.16461c-14.143144-48.811589-2.788075-77.559177 40.731241-102.220967 15.182336-8.617686 30.11121-18.125022 46.256698-24.491972 18.984256-7.489783 37.715051-8.23496 49.450312 22.3046-52.162348-24.943133-81.209021 9.187974-113.42396 34.470746-16.525681 12.951876-19.41514 29.672722-15.61322 49.632804 1.11523 5.857492-5.170612 13.129299-8.060071 19.752244z m207.508817 27.72107c-0.228115 6.323861-1.292653 16.928684-1.495422 21.351585-0.836422 18.340464-1.77423 32.470935 6.792765 38.820142 10.290531 7.603841 33.1274 3.589013 48.157659-1.875614 18.021103-6.546907 33.532938-19.939805 48.86735-29.561199-14.979567 34.496091-58.625613 60.526573-93.983473 49.571974-11.988722-3.715744-25.067329-21.290754-27.373827-34.328807-2.55996-14.510663 6.640688-31.089571 10.696069-46.766156 3.193613-7.859837 10.189147-18.510283 8.338879 2.788075zM369.547732 890.172401c28.691826-28.324307 89.776015-31.244182 76.013062-93.020321 14.700759 3.682794 18.29991 11.464057 12.825145 33.203439-6.995534 27.705862-62.376841 65.575524-88.838207 59.816882z m-47.397275-32.189594c-5.753573-42.008686 60.906765-85.005872 107.366233-68.414291-46.05393 9.778539-87.672285 20.692586-107.366233 68.432034z m298.881639 9.854578c-43.189816-29.538387-68.333183-16.551027-63.796225 45.524196-0.405538 8.085417-3.877959 12.741503-7.603841 1.173526-1.140576-13.068468-3.041536-28.007481-2.23046-38.432347 1.875614-24.099106 23.41983-35.738052 40.959356-35.314771 10.36657 0.253461 25.65029 12.031811 38.779589 18.981721 9.276686 6.597599 2.281152 12.406934-6.108419 8.098091zM889.929255 833.321017c0 7.051295-31.175748 75.047375-39.387895 87.269282s-15.714604 12.576753-9.631532-4.177044 23.952099-82.344528 35.712706-88.39465 13.306722-1.751418 13.306721 5.302412z m-35.129744-207.627945c8.490956 8.490956 33.583631 64.031944 33.58363 75.675959s-5.221304 12.23458-12.343568 4.749866-17.742295-51.16878-26.613443-76.750635c-3.117575-8.764694-3.117575-12.173749 5.373381-3.67519z m-468.295214 6.843457c8.060071-12.622376 25.016636-24.025603 31.784055-38.959546 4.891804-10.739158-4.612997-29.601753-0.126731-36.627701 1.77423-2.788075 7.071572 7.142541 9.783609 10.792384 11.507146 19.143937 0.025346 40.759122-41.440933 64.797398z m453.974647 122.404096s14.143144 2.027691 18.173179 20.20594 0 28.288823 0 28.288823-8.338879 4.463455-11.557838-2.549822-4.055382-12.419607-6.615341-12.419606-1.77423-8.00431 0-8.587271 0-24.935529 0-24.935529z m-146.678091 7.096918s-3.244305 16.72845 0 22.119573 14.574028 3.325413 14.574028-4.270824-5.398727-22.160127-14.574028-17.84368zM344.201595 872.835643c1.140576-2.281152-0.608307-13.643825 6.818111-12.166145s12.622376 5.9386 9.656878 13.359948-8.92184 6.678707-7.426418 10.391916 14.092452 2.968033 15.587874-8.16399 1.495422-40.074776-20.783832-31.910786-10.898839 29.860283-9.656878 31.910786 4.663689-1.143111 5.804265-3.416659z m-36.219628-240.301648s5.094573-18.487472 12.495645-12.92653 0 25.014102 0 25.014102 8.820455 4.169439 12.064761-6.483542 6.944841-35.669618-6.032381-31.964012-18.528026 7.915598-18.528025 17.139057v9.223459zM987.816034 147.340512a10.019328 10.019328 0 0 1-9.048571-14.386467l51.984926-108.291367-76.266524 18.038845a10.044674 10.044674 0 0 1-4.638343-19.544406L1046.593724 0.27716a10.052278 10.052278 0 0 1 11.380415 14.117798L1005.178137 124.313547l100.953661-16.350792a10.039605 10.039605 0 0 1 3.193613 19.825747l-119.912571 19.422745a9.976239 9.976239 0 0 1-1.596806 0.134334z m-54.494193 160.050712a10.217028 10.217028 0 0 1-2.154422-0.23065l-66.204108-14.447298a10.057347 10.057347 0 0 1-5.525457-16.292496l58.524228-69.212694-56.090999-1.363622a10.014258 10.014258 0 0 1-9.783609-10.280393 9.907805 9.907805 0 0 1 10.290531-9.796282l77.026908 1.87308a10.03707 10.03707 0 0 1 7.426418 16.518077l-61.286957 72.489949 49.906542 10.898839a10.042139 10.042139 0 0 1-2.129075 19.848559z m-65.418378 167.667226a10.039605 10.039605 0 0 1-8.541648-15.347086l39.996203-64.21697-48.259043 9.715174a10.039605 10.039605 0 1 1-3.953998-19.686344l71.04522-14.307894a10.047208 10.047208 0 0 1 10.518647 15.15192l-41.238164 66.201573 63.517418-7.573425a10.042139 10.042139 0 0 1 2.382537 19.944874l-84.275904 10.047209a10.199285 10.199285 0 0 1-1.191268 0.076038z"></path></symbol><symbol id="icon-right" viewBox="0 0 1024 1024"><path d="M512 0a512 512 0 1 0 512 512A513.504 513.504 0 0 0 512 0z m0 960A445.24 445.24 0 0 1 64 512a448 448 0 1 1 448 448z m230.4-614.4L435.2 652.8 281.6 499.2c-19.456-19.456-45.056-19.456-57.344 0s-19.456 45.056 0 57.344l179.2 179.2c19.456 19.456 45.056 19.456 57.856 0L800.256 396.8c19.456-19.456 19.456-45.056 0-57.344-12.8-12.8-38.912-12.8-57.856 6.144z"></path></symbol><symbol id="icon-remove" viewBox="0 0 1024 1024"><path d="M710.68 287.424a25.472 25.472 0 0 0-15.848 5.504l-0.264-0.248L512.072 475.2 333.088 296.2l-0.176 0.2a25.6 25.6 0 1 0-33.712 37.864l-0.208 0.232 72.952 72.952-0.384 0.376 103.936 103.944-97.536 97.544 0.376 0.376-78.72 78.72a25.6 25.6 0 1 0 30.264 41.128l0.52 0.496 181.68-181.68L692.12 728.4a25.6 25.6 0 0 0 34.968-37.368L645.816 609.688l0.376-0.376-97.536-97.544 103.936-103.936-0.384-0.384 74.4-74.4a25.776 25.776 0 0 0 4-4l1.304-1.304-0.2-0.184a25.6 25.6 0 0 0-21.032-40.136zM512 0a512 512 0 1 0 512 512A512 512 0 0 0 512 0z m0 972.8A460.8 460.8 0 1 1 972.8 512 460.8 460.8 0 0 1 512 972.8z"></path></symbol><symbol id="icon-gou" viewBox="0 0 1280 1024"><path d="M126.912 458.752L425.984 691.2 1170.24 21.504a76.8 76.8 0 0 1 93.504-9.856 60.16 60.16 0 0 1-5.824 86.4l-777.088 889.6a78.656 78.656 0 0 1-130.432-0.96L15.168 544.448a71.168 71.168 0 0 1 9.856-96 75.968 75.968 0 0 1 101.888 10.304z"></path></symbol><symbol id="icon-xingzhuang7" viewBox="0 0 1024 1024"><path d="M382.534474 257.173856h245.456447c75.955881 0 133.899948-165.685005 133.899948-165.685005C761.890869 41.878103 756.950099 4.348555 672.610136 1.692045S568.092543 60.989747 507.491966 60.989747C445.38547 60.989747 414.319531 12.267323 337.898338 1.692045S248.634526 41.878103 248.634526 91.488851c0 0 57.918686 165.685005 133.899948 165.685005z m258.882821 51.209729H382.534474C95.885201 308.383585 25.513067 874.820889 25.513067 874.820889c0 74.3992 59.94914 149.128349 133.899948 149.12835h705.134198c73.942348 0 133.891488-74.729149 133.891488-149.12835 0 0-70.414435-566.437304-357.021406-566.437304z m29.382354 435.32923a31.472029 31.472029 0 0 1 0 62.944059h-126.903344v82.563315a31.252063 31.252063 0 1 1-62.504127 0v-82.563315h-127.749366a31.472029 31.472029 0 0 1 0-62.944059h127.749366v-39.932252h-127.749366a31.480489 31.480489 0 0 1 0-62.952519H439.979387l-88.409329-158.036964a31.573552 31.573552 0 0 1 11.438221-42.977932 31.150541 31.150541 0 0 1 42.698745 11.480523l106.454985 189.508993h5.389162l106.446525-189.508993a31.142081 31.142081 0 0 1 42.681824-11.480523 31.565092 31.565092 0 0 1 11.463602 42.977932l-88.409329 158.036964h81.065856a31.480489 31.480489 0 0 1 0 62.952519h-126.903344v39.932252h126.903344z m0 0"></path></symbol><symbol id="icon-shanchu1-copy" viewBox="0 0 1024 1024"><path d="M62.03327281 991.97774563a30.00010875 30.00010875 0 0 1-21.22916813-51.20745937l428.35792126-428.79428626L40.80410468 83.05080404A30.00010875 30.00010875 0 0 1 83.26244094 40.65792219l449.45617968 450.02345438a29.97829124 29.97829124 0 0 1 1e-8 42.39288187l-449.45617969 450.02345437a29.82556314 29.82556314 0 0 1-21.22916813 8.88003281z m900.1341825-1e-8a29.82556314 29.82556314 0 0 1-21.22916811-8.72730468l-449.45618064-450.02345437a29.97829124 29.97829124 0 0 1 0-42.39288188L940.9382872 40.81065031a30.00010875 30.00010875 0 0 1 42.45833623 42.39288094L555.03870219 511.976l428.35792124 428.72883187a30.00010875 30.00010875 0 0 1-21.22916812 51.27291375z"></path></symbol><symbol id="icon-xingzhuangkaobei1" viewBox="0 0 1057 1024"><path d="M936.167226 136.423226H109.898323a27.086452 27.086452 0 1 1 0-54.172903h826.268903a27.086452 27.086452 0 1 1 0 54.172903z m0 793.765161H109.898323a27.086452 27.086452 0 1 1 0-54.172903h826.268903a27.086452 27.086452 0 1 1 0 54.172903z m0-397.047742H109.898323a27.086452 27.086452 0 1 1 0-54.172903h826.268903a27.086452 27.086452 0 1 1 0 54.172903z"></path></symbol><symbol id="icon-xingzhuangkaobei2" viewBox="0 0 1056 1024"><path d="M950.4 168H529.92a25.28 25.28 0 1 1 0-50.56H950.4a25.28 25.28 0 1 1 0 50.56zM346.944 130.56a17.088 17.088 0 0 1 17.024 16.96v731.84a17.088 17.088 0 0 1-17.024 16.96h-172.8a17.088 17.088 0 0 1-17.024-16.96V147.52a17.088 17.088 0 0 1 17.024-16.96h172.8m0-47.68h-172.8a64.896 64.896 0 0 0-65.28 64.64v731.84a65.12 65.12 0 0 0 65.28 64.64h172.8a65.12 65.12 0 0 0 65.248-64.64V147.52a64.896 64.896 0 0 0-65.248-64.64zM950.4 920H529.92a25.28 25.28 0 1 1 0-50.56H950.4a25.28 25.28 0 1 1 0 50.56z m0-374.08H529.92a25.28 25.28 0 1 1 0-50.56H950.4a25.28 25.28 0 1 1 0 50.56z"></path></symbol><symbol id="icon-zhuanfa" viewBox="0 0 1380 1024"><path d="M30.510104 1024H27.749774a30.363628 30.363628 0 0 1-27.558777-30.274585c-3.517194-213.702954 54.672339-383.774888 172.965829-504.873229a639.550612 639.550612 0 0 1 297.447799-167.400648 1619.022485 1619.022485 0 0 1 267.618428-27.158083V30.726478a30.230064 30.230064 0 0 1 48.172208-24.932011L1367.711818 432.75516a30.230064 30.230064 0 0 1 12.466005 24.486797 31.165014 31.165014 0 0 1-12.510527 24.932011l-581.361078 424.734622a30.452671 30.452671 0 0 1-48.083165-24.932012v-248.429684c-209.250809 5.787788-465.204618 68.563031-573.035567 182.983155a422.24142 422.24142 0 0 0-104.981576 182.983154 30.363628 30.363628 0 0 1-29.695806 24.486797z m737.987535-451.892705a29.962935 29.962935 0 0 1 21.459338 8.90429 30.40815 30.40815 0 0 1 8.90429 21.81551v219.490742l499.441612-365.07588-499.441612-366.411523v233.737606a30.051978 30.051978 0 0 1-9.260462 21.81551 31.788314 31.788314 0 0 1-22.260724 8.904289 55.117554 55.117554 0 0 0-7.791254-0.445214c-47.059171 0-379.100136 8.90429-543.161675 176.750152a550.285107 550.285107 0 0 0-144.961837 304.081495 494.855903 494.855903 0 0 1 47.103693-58.323098 590.398932 590.398932 0 0 1 206.802129-142.023422c100.618474-41.850162 308.800769-63.220457 443.166502-63.220457z m0 0"></path></symbol><symbol id="icon-share" viewBox="0 0 1024 1024"><path d="M490.929231 499.987692H358.4a31.704615 31.704615 0 1 1 0-63.212307h93.696L383.803077 334.769231a31.586462 31.586462 0 1 1 52.578461-35.052308l85.07077 127.606154 85.464615-128.196923A31.763692 31.763692 0 0 1 659.495385 334.769231l-67.997539 102.006154h95.172923a31.704615 31.704615 0 1 1 0 63.212307h-132.529231v36.233846h132.529231a31.704615 31.704615 0 1 1 0 63.212308h-132.529231v131.544616a31.901538 31.901538 0 0 1-31.507692 31.704615c-17.526154 0-31.704615-14.178462-31.704615-31.704615v-131.544616H358.4a31.704615 31.704615 0 1 1 0-63.212308h132.529231v-36.233846zM809.353846 154.584615h-23.827692a40.763077 40.763077 0 0 1 0-81.32923h121.501538a40.763077 40.763077 0 0 1 40.96 55.079384V236.307692a40.763077 40.763077 0 0 1-40.96 39.384616A40.763077 40.763077 0 0 1 866.461538 236.307692v-23.630769l-57.107692 58.289231a40.96 40.96 0 0 1-57.501538-2.56 37.809231 37.809231 0 0 1 0-55.138462l57.501538-58.683077zM512 1006.867692C238.690462 1006.867692 17.132308 785.309538 17.132308 512S238.690462 17.132308 512 17.132308c33.476923 0.059077 66.835692 3.426462 99.643077 10.043077a42.220308 42.220308 0 1 1-16.935385 82.707692A410.584615 410.584615 0 1 0 922.584615 512a420.036923 420.036923 0 0 0-10.830769-94.326154 42.141538 42.141538 0 0 1 81.92-19.692308A495.064615 495.064615 0 0 1 512 1006.867692z"></path></symbol><symbol id="icon-info" viewBox="0 0 1024 1024"><path d="M505.294856 1023.956679A511.978339 511.978339 0 1 0 0.011618 505.873982v24.456812A510.993766 510.993766 0 0 0 505.294856 1023.956679z m0-966.339424a454.400468 454.400468 0 1 1 0 908.722169 454.400468 454.400468 0 0 1 0-908.722169z m-19.179496 569.556211h44.778413a13.784032 13.784032 0 0 0 12.799459-12.799459l12.799458-332.78592a20.439751 20.439751 0 0 0-19.179496-19.21888h-57.577872a16.974051 16.974051 0 0 0-19.179496 19.21888l12.799459 332.78592a13.784032 13.784032 0 0 0 12.760075 12.799459z m25.598917 153.593502a51.197834 51.197834 0 1 0-51.197834-51.197834 55.136129 55.136129 0 0 0 51.197834 51.197834z"></path></symbol><symbol id="icon-xingzhuang11" viewBox="0 0 1024 1024"><path d="M842.175549 430.510362L319.09522 23.5485A113.294059 113.294059 0 0 0 206.613179 8.967495a28.244078 28.244078 0 0 0-3.883561 1.659339A105.279802 105.279802 0 0 0 141.228138 105.067971v814.029639a105.315107 105.315107 0 0 0 62.207582 94.547052 112.976313 112.976313 0 0 0 115.624195-13.062886l523.115634-406.961862a102.384784 102.384784 0 0 0 0-163.109552z m-89.851474 81.519471L263.666217 892.301041V131.86454z"></path></symbol><symbol id="icon-likexuexi" viewBox="0 0 1024 1024"><path d="M684.032 881.152h-409.6c-43.008 0-77.824-34.816-77.824-77.824V220.672c0-43.008 34.816-77.824 77.824-77.824h409.6c79.36 0 143.872 64.512 143.872 143.872v450.56c0 79.36-65.024 143.872-143.872 143.872z m-409.6-674.304c-7.68 0-14.336 6.144-14.336 14.336v582.144c0 7.68 6.144 14.336 14.336 14.336h409.6c44.032 0 79.872-35.84 79.872-79.872V286.72c0-44.032-35.84-79.872-79.872-79.872h-409.6z"></path><path d="M664.064 412.16H359.936c-17.92 0-31.744-14.336-31.744-31.744 0-17.408 14.336-31.744 31.744-31.744h304.128c17.92 0 31.744 14.336 31.744 31.744 0 17.408-14.336 31.744-31.744 31.744z m-82.432 148.48H359.936c-17.92 0-31.744-14.336-31.744-31.744s14.336-31.744 31.744-31.744h222.208c17.92 0 31.744 14.336 31.744 31.744s-14.336 31.744-32.256 31.744z"></path></symbol><symbol id="icon-jiantou" viewBox="0 0 1024 1024"><path d="M336.325 171.134l387.574 297.604c26.938 20.681 26.938 65.523 0 86.203L336.325 852.545c-24.968 19.175-56.196-4.808-56.196-43.161V214.233c0-38.294 31.225-62.278 56.196-43.103z"></path></symbol><symbol id="icon-dingyue" viewBox="0 0 1024 1024"><path d="M967.87 882.012l-108.862-0.154-0.174 94.792c0 26.156-24.02 47.35-53.704 47.35-29.633 0-53.688-21.194-53.688-47.35l0.157-94.945-108.037-0.14c-29.685 0-53.704-21.208-53.704-47.349 0-26.157 24.02-47.38 53.704-47.38l108.214 0.155 0.157-92.34c0-26.143 24.039-47.35 53.704-47.35 29.685 0 53.705 21.207 53.705 47.35l-0.176 92.493 108.705 0.138c29.665 0 53.703 21.225 53.703 47.352 0 26.156-24.038 47.378-53.704 47.378zM806.476 584.445c-29.667 0-53.686-21.239-53.686-47.378l-0.403-394.609-3.11-2.775 3.11 2.751-0.018-2.15c-1.415-24.752-24.23-44.482-52.55-44.898l-0.647-0.569h52.848l0.313 18.365v-18.49l-590.435 0.37 0.062-0.046c-0.175 0-0.314 0.046-0.48 0.046h-0.332l0.586-0.546h-52.857v0.57h-1.014l0.393 722.053 289.729-255.92c20.97-18.48 54.988-18.48 75.932-0.015 0.541 0.461 0.874 1.017 1.38 1.477l125.906 110.391c20.96 18.481 20.96 48.458 0 66.94-20.979 18.496-54.963 18.496-75.942 0l-89.323-78.283L93.466 964.226c-1.407 1.235-2.98 2.175-4.493 3.237-9.317 6.906-21.222 11.237-34.36 11.237-29.64 0-53.705-21.225-53.705-47.395L0.463 93.728c0.253-48.905 42.611-88.6 96.7-93.356L755.62 0c55.332 1.109 99.842 39.103 104.089 87.192l0.472 449.873c0 26.14-24.056 47.38-53.705 47.38zM161.087 95.085c-29.222 0.447-52.831 21.386-52.831 47.273l3.365-2.968-3.593 3.213 0.848-47.518 52.271-0.024-0.06 0.025z m0.393-0.023h0.418l-50.277 44.328 49.466-44.304c0.113 0 0.254-0.024 0.393-0.024z m537.464 0.248c0.297 0 0.596 0.076 0.875 0.076l49.456 44.298-50.33-44.374z"></path></symbol><symbol id="icon-wenzhang" viewBox="0 0 1024 1024"><path d="M909.186 104.382c-19.215-7.887-42.481-11.722-71.123-11.722-111.623 0-278.723 61.038-327.92 79.992-48.772-19.038-213.591-79.992-324.451-79.992-28.479 0-51.663 3.835-70.88 11.722a36.568 36.568 0 0 0-22.68 33.828v671.04c0 18.63 14.008 34.28 32.523 36.343 1.268 0.14 127.604 14.312 192.38 30.969 66.48 17.095 183.073 52.812 184.242 53.171a36.545 36.545 0 0 0 20.668 0.228c1.622-0.46 162.64-45.969 204.775-57.417 32.996-8.964 136.047-22.523 172.97-26.992 18.363-2.222 32.174-17.806 32.174-36.302V138.21a36.564 36.564 0 0 0-22.678-33.828zM165.266 776.82V166.84c5.732-0.645 12.491-1.046 20.426-1.046 91.012 0 233.067 50.371 287.867 71.181l1.733 608.516c-40.617-12.127-98.824-29.157-140.043-39.756-48.997-12.598-126.374-23.394-169.984-28.915z m693.467 0.206c-43.613 5.71-119.445 16.32-151.186 24.943-28.407 7.718-107.685 30.023-159.119 44.526l-1.736-609.461c55.536-20.827 199.475-71.241 291.37-71.241 8.047 0 14.884 0.405 20.671 1.056v610.177z"></path></symbol><symbol id="icon-pintuan" viewBox="0 0 1024 1024"><path d="M939.008 839.026c0 23.381-18.887 42.382-42.098 42.382-23.21 0-42.098-19-42.098-42.382 0-0.228 0.114-0.54 0.114-0.74h-0.313c0-0.967 0.114-1.906 0.114-2.873 0-69.148-27.221-131.811-71.111-177.806l0.2-0.199a40.533 40.533 0 0 1-12.147-28.985c0-22.414 18.148-40.675 40.42-40.675a39.96 39.96 0 0 1 28.814 12.202l0.114-0.114c60.558 61.07 98.02 145.408 98.02 238.564h-0.114c0.085 0.114 0.085 0.313 0.085 0.626M604.075 579.868c-0.2 0.114-0.427 0.114-0.626 0.114-138.866 0-251.364 114.29-251.364 255.346 0 0.74 0.114 1.365 0.114 2.02 0 0.54 0.2 1.052 0.2 1.592 0 23.382-18.888 42.383-42.099 42.383-23.21 0-42.097-19.001-42.097-42.383 0-0.227 0.113-0.54 0.113-0.74h-0.455c0-137.13 81.351-254.918 197.974-307.91-48.527-40.05-79.56-100.921-79.56-169.102 0-120.776 97.195-218.596 217.174-218.596 119.865 0 217.173 97.82 217.173 218.596-0.028 120.632-96.995 218.368-216.547 218.68m-0.655-357.944c-76.288 0-138.24 62.236-138.24 139.15 0 76.8 61.839 139.15 138.24 139.15 76.288 0 138.24-62.236 138.24-139.15-0.085-76.914-61.923-139.15-138.24-139.15M346.795 260.38c-46.109 12.857-79.986 54.7-79.986 104.505 0 41.728 23.751 77.853 58.567 96.029 14.137 7.338 27.847 21.333 30.066 45.568 1.906 21.02-4.21 52.679-31.858 60.33-92.644 25.686-160.91 108.232-164.295 207.332 0.199 1.593 0.512 3.186 0.512 4.779 0 20.707-16.669 37.603-37.348 37.603-20.565 0-37.347-16.782-37.347-37.603 0-0.427 0.114-0.74 0.114-1.053h-0.228c0-126.066 74.382-226.446 178.859-269.88-43.264-33.252-71.225-85.192-71.225-143.617 0-73.5 44.003-136.704 107.434-165.262 29.64-13.397 51.172 2.56 56.463 23.154 6.314 24.633-9.728 38.115-9.728 38.115"></path></symbol><symbol id="icon-shipin" viewBox="0 0 1024 1024"><path d="M371.463 660.159V412.941c0-57.146 64.326-90.633 111.142-57.869l176.588 123.613c40.169 28.122 40.169 87.608 0 115.73L482.596 718.028c-46.816 32.773-111.133-0.722-111.133-57.869z m70.63 0L618.68 536.546 442.093 412.94V660.16z m-329.09 220.703c-16.925 0-30.696-13.555-30.696-30.226V185.754c0-16.662 13.771-30.226 30.695-30.226h797.996c16.924 0 30.686 13.555 30.686 30.226v664.882c0 16.662-13.762 30.226-30.686 30.226H113.002z m890.073-30.226V185.754c0-49.994-41.307-90.669-92.078-90.669H113.002c-50.77 0-92.078 40.675-92.078 90.67v664.881c0 49.995 41.307 90.67 92.078 90.67h797.996c50.77 0 92.078-40.675 92.078-90.67z"></path></symbol><symbol id="icon-xiayige-" viewBox="0 0 1024 1024"><path d="M307.2 0L204.8 102.4 614.4 512 204.8 921.6 307.2 1024l512-512z"></path></symbol><symbol id="icon-wodeyigou" viewBox="0 0 1024 1024"><path d="M320 1024H128C57.6 1024 0 966.4 0 896V128C0 57.6 57.6 0 128 0h768c70.4 0 128 57.6 128 128v256H896V128H128v768h192v128z"></path><path d="M320 256h384c38.4 0 64 25.6 64 64s-25.6 64-64 64H320c-38.4 0-64-25.6-64-64s25.6-64 64-64z m0 256h256c38.4 0 64 25.6 64 64s-25.6 64-64 64H320c-38.4 0-64-25.6-64-64s25.6-64 64-64z m288 512c-19.2 0-32-6.4-44.8-19.2l-160-160c-25.6-25.6-25.6-64 0-89.6s64-25.6 89.6 0L608 870.4l307.2-307.2c25.6-25.6 64-25.6 89.6 0s25.6 64 0 89.6l-352 352c-12.8 12.8-25.6 19.2-44.8 19.2z"></path></symbol><symbol id="icon-fuzhi" viewBox="0 0 1024 1024"><path d="M884.5838112 150.4566784h-182.8008416V62.26367253a47.43483307 47.43483307 0 0 0-47.39119467-47.39119466H112.7531872A47.47847147 47.47847147 0 0 0 65.36199253 62.26367253v766.37583787a47.47847147 47.47847147 0 0 0 47.39119467 47.3911936h182.8008416v88.14936747a47.43483307 47.43483307 0 0 0 47.39119467 47.39119466h541.63858773a47.43483307 47.43483307 0 0 0 47.39119467-47.39119466V197.84787307a47.43483307 47.43483307 0 0 0-47.39119467-47.39119467z m-771.830624 685.1213216a6.8075744 6.8075744 0 0 1-6.76393707-6.76393707V62.26367253a6.8075744 6.8075744 0 0 1 6.76393707-6.763936h541.63858773a6.8075744 6.8075744 0 0 1 6.76393707 6.763936v766.37583787a6.8075744 6.8075744 0 0 1-6.76393707 6.763936z m778.59456107 128.77662507a6.76393707 6.76393707 0 0 1-6.76393707 6.76393706H342.94522347a6.76393707 6.76393707 0 0 1-6.76393707-6.76393706V878.77991787h318.21048853a47.43483307 47.43483307 0 0 0 47.39119467-47.39119467v-14.3570016h97.0079424a20.33544853 20.33544853 0 1 0 0-40.6272576h-97.0079424V677.17096853h97.0079424a20.33544853 20.33544853 0 1 0 0-40.62725866h-97.0079424v-101.58996374h97.0079424a20.33544853 20.33544853 0 1 0 0-40.6272576h-97.0079424V396.7948864h27.05574613a20.33544853 20.33544853 0 0 0 0-40.62725867h-27.05574613V191.08393707h182.8008416a6.76393707 6.76393707 0 0 1 6.76393707 6.763936zM159.0097856 218.008768a20.29181013 20.29181013 0 0 1 20.29181013-20.33544747h329.46917014a20.33544853 20.33544853 0 1 1 0 40.6272576h-329.46917014a20.29181013 20.29181013 0 0 1-20.29181013-20.29181013zM599.0584096 356.16762773a20.29181013 20.29181013 0 0 1-20.29180907 20.29181014H179.30159573a20.33544853 20.33544853 0 0 1 0-40.6272576h399.4650048a20.33544853 20.33544853 0 0 1 20.29180907 20.33544746z m0 142.173584a20.29181013 20.29181013 0 0 1-20.29180907 20.29181014H179.30159573a20.33544853 20.33544853 0 0 1 0-40.6272576h399.4650048a20.33544853 20.33544853 0 0 1 20.29180907 20.24817066z m0 139.90439254a20.29181013 20.29181013 0 0 1-20.29180907 20.29180906H179.30159573a20.29181013 20.29181013 0 0 1 0-40.5836192h399.4650048a20.29181013 20.29181013 0 0 1 20.29180907 20.29181014z m0 0"></path></symbol><symbol id="icon-share-money" viewBox="0 0 1118 1024"><path d="M672.156234 880.147582H147.126592C66.117191 880.041963 0.105619 814.136009 0 733.126608V147.155083C0.105619 66.145681 66.011572 0.134109 147.020974 0.002086h292.985762a34.431636 34.431636 0 1 1 0 68.863272H147.126592a78.276522 78.276522 0 0 0-78.157701 78.26332v585.786693a78.276522 78.276522 0 0 0 78.157701 78.26332h524.369526z" fill="#999999"></path><path d="M880.013473 166.800127a27.830479 27.830479 0 0 0-0.211237-2.957319v-0.422474c0-0.211237-0.105619-0.528093-0.105619-0.739329a0.950567 0.950567 0 0 0-0.105619-0.528093c-0.105619-0.422474-0.105619-0.73933-0.211237-1.161804a0.792139 0.792139 0 0 0-0.105618-0.422474c-0.105619-0.422474-0.211237-0.73933-0.316856-1.161803a0.382867 0.382867 0 0 0-0.105618-0.316856l-0.316856-1.320231v-0.211237c-0.105619-0.422474-0.316856-0.844948-0.422474-1.320232s-0.316856-0.950567-0.528092-1.320231c-0.211237-0.633711-0.528093-1.161804-0.73933-1.795515a26.404629 26.404629 0 0 0-2.429226-4.119122c-0.211237-0.316856-0.316856-0.528093-0.528092-0.844948l-0.950567-1.320232a11.221967 11.221967 0 0 0-0.950567-1.161803c-0.211237-0.211237-0.316856-0.422474-0.528092-0.633711L757.179139 12.069001a34.458041 34.458041 0 0 0-52.386784 44.782251L772.599442 135.985925c-169.253671 10.852302-297.949833 64.084034-382.972738 158.190132-123.996137 137.198452-107.202793 265.102474-106.463463 272.390152a34.16759 34.16759 0 0 0 34.11478 30.734988h0.105619c1.056185 0 2.323607 0 3.591029-0.105619a34.603266 34.603266 0 0 0 30.62937-37.811428c-0.105619-1.478659-13.730407-105.829753 89.564501-219.580895 72.348683-79.741979 184.515547-125.052323 334.018556-134.980463l-71.820591 95.690376a34.431636 34.431636 0 0 0 27.460814 55.132865h0.105619A34.920122 34.920122 0 0 0 758.55218 341.94203l114.490471-152.750778 0.105618-0.211237a5.861828 5.861828 0 0 1 0.633711-0.844948 4.475585 4.475585 0 0 0 0.528093-0.73933l0.633711-0.950566c0.105619-0.211237 0.316856-0.422474 0.422474-0.633711a4.594405 4.594405 0 0 0 0.422474-0.73933 0.369665 0.369665 0 0 0 0.105618-0.211237c0.211237-0.316856 0.316856-0.633711 0.528093-0.950567s0.422474-0.950567 0.633711-1.320231 0.422474-0.950567 0.633711-1.478659c0.105619-0.316856 0.211237-0.528093 0.316856-0.844948 0.211237-0.633711 0.422474-1.161804 0.633711-1.795515a8.792741 8.792741 0 0 0 0.422474-1.584278c0.105619-0.422474 0.211237-0.73933 0.316855-1.161804a4.488787 4.488787 0 0 0 0.211237-1.161803c0.105619-0.422474 0.105619-0.73933 0.211238-1.161804a4.739631 4.739631 0 0 0 0.105618-1.161804c0-0.316856 0.105619-0.633711 0.105619-0.950566 0-0.633711 0.105619-1.320231 0.105618-1.795515a20.371171 20.371171 0 0 0-0.105618-2.640463z" fill="#999999"></path><path d="M879.802236 163.842808a25.968953 25.968953 0 0 1 0.211237 2.957319 27.830479 27.830479 0 0 0-0.211237-2.957319z" fill=""></path><path d="M832.31351 452.445402C674.479841 452.445402 546.575819 580.389032 546.575819 738.222701s127.943629 285.777299 285.777298 285.777299 285.777299-127.943629 285.777299-285.777299S990.173584 452.445402 832.31351 452.445402zM962.448724 764.785758a24.846756 24.846756 0 1 1 0 49.535084h-103.823001v103.096873a24.767542 24.767542 0 1 1-49.535084 0V814.320842h-103.862608a24.846756 24.846756 0 1 1 0-49.535084h103.862608v-28.398178h-103.862608a24.846756 24.846756 0 1 1 0-49.535084h73.431273l-53.522182-79.953217a24.767542 24.767542 0 0 1 41.204423-27.474016L833.066042 679.432795l66.988544-100.469613a24.899565 24.899565 0 0 1 41.204423 27.936097l-53.297743 79.953217H962.448724a24.846756 24.846756 0 1 1 0 49.535084h-103.823001v28.398178z" fill="#FA8919"></path></symbol><symbol id="icon-ziyuan1" viewBox="0 0 1024 1024"><path d="M1023.978534 579.416768v273.410086c-0.122881 94.249679-76.923467 171.050265-171.050265 171.173146H171.184827C76.935148 1023.877119 0.134562 947.199414 0.011681 852.949735V171.206293C0.134562 76.956614 76.812267 0.156028 171.061947 0.002427h340.87172a40.059186 40.059186 0 1 1 0 80.118371H171.184827a91.070135 91.070135 0 0 0-90.931893 91.054775v681.5284a91.070135 91.070135 0 0 0 90.931893 91.054775H852.805388a91.085495 91.085495 0 0 0 91.054775-91.054775V579.416768a40.059186 40.059186 0 0 1 80.118371 0z m-9.21607-389.901215a35.45115 35.45115 0 0 1 0.491524 3.563547c-0.122881-1.105928-0.245762-2.334738-0.491524-3.563547z" fill="#999999"></path><path d="M1023.855653 194.062148a32.379127 32.379127 0 0 0-0.245762-3.440667v-0.491523c0-0.245762-0.122881-0.614405-0.12288-0.860167a1.105928 1.105928 0 0 0-0.122881-0.614405c-0.122881-0.491524-0.122881-0.860167-0.245762-1.35169a0.921607 0.921607 0 0 0-0.122881-0.491524c-0.122881-0.491524-0.245762-0.860167-0.368643-1.35169a0.445443 0.445443 0 0 0-0.122881-0.368643l-0.368643-1.536012v-0.245761c-0.122881-0.491524-0.368643-0.983048-0.491524-1.536012s-0.368643-1.105928-0.614404-1.536012c-0.245762-0.737286-0.614405-1.35169-0.860167-2.088976a30.720234 30.720234 0 0 0-2.826261-4.792356c-0.245762-0.368643-0.368643-0.614405-0.614405-0.983048l-1.105928-1.536012a13.0561 13.0561 0 0 0-1.105929-1.35169c-0.245762-0.245762-0.368643-0.491524-0.614405-0.737286L880.945123 14.041574a40.089906 40.089906 0 0 0-60.948945 52.101518L898.88574 158.211634c-196.916702 12.626016-346.647125 74.558009-445.56628 184.044924-144.262221 159.622338-124.724152 308.431153-123.863985 316.909938a39.751983 39.751983 0 0 0 39.690543 35.758353h0.122881c1.228809 0 2.703381 0 4.177952-0.122881a40.258867 40.258867 0 0 0 35.635472-43.991375c-0.122881-1.720333-15.974522-123.126699 104.203035-255.46947 84.173442-92.775108 214.672998-145.49103 388.610965-157.041838l-83.559038 111.33013a40.059186 40.059186 0 0 0 31.949044 64.143849h0.122881A40.62751 40.62751 0 0 0 882.542575 397.829462l133.202936-177.716556 0.122881-0.245762a6.819892 6.819892 0 0 1 0.737286-0.983047 5.20708 5.20708 0 0 0 0.614405-0.860167l0.737285-1.105928c0.122881-0.245762 0.368643-0.491524 0.491524-0.737286a5.345321 5.345321 0 0 0 0.491524-0.860166 0.430083 0.430083 0 0 0 0.122881-0.245762c0.245762-0.368643 0.368643-0.737286 0.614404-1.105929s0.491524-1.105928 0.737286-1.536011 0.491524-1.105928 0.737286-1.720333c0.122881-0.368643 0.245762-0.614405 0.368643-0.983048 0.245762-0.737286 0.491524-1.35169 0.737285-2.088976a10.229838 10.229838 0 0 0 0.491524-1.843214c0.122881-0.491524 0.245762-0.860167 0.368643-1.35169a5.22244 5.22244 0 0 0 0.245762-1.351691c0.122881-0.491524 0.122881-0.860167 0.245761-1.35169a5.514282 5.514282 0 0 0 0.122881-1.35169c0-0.368643 0.122881-0.737286 0.122881-1.105929 0-0.737286 0.122881-1.536012 0.122881-2.088976a23.700661 23.700661 0 0 0-0.122881-3.072023z m-9.093189-4.608036a35.45115 35.45115 0 0 1 0.491524 3.563548c-0.122881-1.105928-0.245762-2.334738-0.491524-3.563548z" fill="#999999"></path></symbol></svg><div id="app"><div class="d4s24Cak_0"><div class="_2HYUpEDK_0" style="background-color: rgb(255, 255, 255);"></div> <div class="_2iHgUKTE_0" style="opacity: 1;"><div class="Wc3vzb2A_0"><!----> <!----> <div class="_3HCtER94_0"><div class="XPK3khh7_0"><i class="iconfont u9KJ6z9x_0"></i><span>MySQL实战45讲</span></div> <div class="S8msnNlD_0"><span>首页</span><span class="_3FTQNYev_0">|</span><span class="iconfont"></span></div></div> <div class="yXXuK9Bz_0"><h1 class="_3QuafcgX_0 _2_jLRfDz_0">
        02  | 日志系统：一条SQL更新语句是如何执行的？
      </h1> <div class="_2dsK9OZI_0 _2_jLRfDz_0"><span>2018-11-16</span> <span>林晓斌</span></div> <div class="_1dC78n85_0 _2_jLRfDz_0"><img src="https://static001.geekbang.org/resource/image/f6/f5/f613f6d2d8a72032c16b211f933c1cf5.jpg" class="_1hOtWUmw_0"> <!----> <div class="_1Bg5E78Y_0 KPNfF2Ub_0"><div class="_1qj_iPD7_0"><h3>朗读：林晓斌</h3> <p><span style="margin-right: 3px;">时长</span><span style="margin-right: 10px;">15:07</span><span style="margin-right: 3px;">大小</span><span>8.66M</span></p></div> <!----> <div class="_2Ha38TVL_0 MH1rcCm7_0"><div class="_1iA2uC1V_0" style="background-image: url(&quot;https://static001.geekbang.org/resource/image/f6/f5/f613f6d2d8a72032c16b211f933c1cf5.jpg&quot;);"></div> <div class="_1iA2uC1V_0 _1WF5YSBJ_0"></div> <div class="iconfont _2Kms_g0F_0"></div></div> <audio title="02  | 日志系统：一条SQL更新语句是如何执行的？" src="https://res001.geekbang.org/resource/audio/d7/a9/d717e876e054d27aeade4fc8f4f9fea9.mp3" controls="controls"></audio></div> <div class="_2qqGfSEe_0"><div class="_29HP61GA_0"><p>前面我们系统了解了一个查询语句的执行流程，并介绍了执行过程中涉及的处理模块。相信你还记得，一条查询语句的执行过程一般是经过连接器、分析器、优化器、执行器等功能模块，最后到达存储引擎。</p><p>那么，一条更新语句的执行流程又是怎样的呢？</p><p>之前你可能经常听 DBA 同事说，MySQL 可以恢复到半个月内任意一秒的状态，惊叹的同时，你是不是心中也会不免会好奇，这是怎样做到的呢？</p><p>我们还是从一个表的一条更新语句说起，下面是这个表的创建语句，这个表有一个主键 ID 和一个整型字段 c：</p><pre style="position: relative;"><code><table class="hljs-ln"><tbody><tr><td class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td><td class="hljs-ln-code"><div class="hljs-ln-line">mysql&gt; create table T(ID int primary key, c int);</div></td></tr></tbody></table></code><div class="richcontent-pre-copy"><span class="iconfont"></span>复制代码</div></pre><p>如果要将 ID=2 这一行的值加 1，SQL 语句就会这么写：</p><pre style="position: relative;"><code><table class="hljs-ln"><tbody><tr><td class="hljs-ln-numbers"><div class="hljs-ln-line hljs-ln-n" data-line-number="1"></div></td><td class="hljs-ln-code"><div class="hljs-ln-line">mysql&gt; update T set c=c+1 where ID=2;</div></td></tr></tbody></table></code><div class="richcontent-pre-copy"><span class="iconfont"></span>复制代码</div></pre><p>前面我有跟你介绍过 SQL 语句基本的执行链路，这里我再把那张图拿过来，你也可以先简单看看这个图回顾下。首先，可以确定的说，查询语句的那一套流程，更新语句也是同样会走一遍。</p><p><img src="https://static001.geekbang.org/resource/image/0d/d9/0d2070e8f84c4801adbfa03bda1f98d9.png" alt=""></p><center><span class="reference">MySQL 的逻辑架构图</span></center><p>你执行语句前要先连接数据库，这是连接器的工作。</p><p>前面我们说过，在一个表上有更新的时候，跟这个表有关的查询缓存会失效，所以这条语句就会把表 T 上所有缓存结果都清空。这也就是我们一般不建议使用查询缓存的原因。</p><p>接下来，分析器会通过词法和语法解析知道这是一条更新语句。优化器决定要使用 ID 这个索引。然后，执行器负责具体执行，找到这一行，然后更新。</p><!-- [[[read_end]]] --><p>与查询流程不一样的是，更新流程还涉及两个重要的日志模块，它们正是我们今天要讨论的主角：redo log（重做日志）和 binlog（归档日志）。如果接触 MySQL，那这两个词肯定是绕不过的，我后面的内容里也会不断地和你强调。不过话说回来，redo log 和 binlog 在设计上有很多有意思的地方，这些设计思路也可以用到你自己的程序里。</p><h1>重要的日志模块：redo log</h1><p>不知道你还记不记得《孔乙己》这篇文章，酒店掌柜有一个粉板，专门用来记录客人的赊账记录。如果赊账的人不多，那么他可以把顾客名和账目写在板上。但如果赊账的人多了，粉板总会有记不下的时候，这个时候掌柜一定还有一个专门记录赊账的账本。</p><p>如果有人要赊账或者还账的话，掌柜一般有两种做法：</p><ul>
<li>一种做法是直接把账本翻出来，把这次赊的账加上去或者扣除掉；</li>
<li>另一种做法是先在粉板上记下这次的账，等打烊以后再把账本翻出来核算。</li>
</ul><p>在生意红火柜台很忙时，掌柜一定会选择后者，因为前者操作实在是太麻烦了。首先，你得找到这个人的赊账总额那条记录。你想想，密密麻麻几十页，掌柜要找到那个名字，可能还得带上老花镜慢慢找，找到之后再拿出算盘计算，最后再将结果写回到账本上。</p><p>这整个过程想想都麻烦。相比之下，还是先在粉板上记一下方便。你想想，如果掌柜没有粉板的帮助，每次记账都得翻账本，效率是不是低得让人难以忍受？</p><p>同样，在 MySQL 里也有这个问题，如果每一次的更新操作都需要写进磁盘，然后磁盘也要找到对应的那条记录，然后再更新，整个过程 IO 成本、查找成本都很高。为了解决这个问题，MySQL 的设计者就用了类似酒店掌柜粉板的思路来提升更新效率。</p><p>而粉板和账本配合的整个过程，其实就是 MySQL 里经常说到的 WAL 技术，WAL 的全称是 Write-Ahead Logging，它的关键点就是先写日志，再写磁盘，也就是先写粉板，等不忙的时候再写账本。</p><p>具体来说，当有一条记录需要更新的时候，InnoDB 引擎就会先把记录写到 redo log（粉板）里面，并更新内存，这个时候更新就算完成了。同时，InnoDB 引擎会在适当的时候，将这个操作记录更新到磁盘里面，而这个更新往往是在系统比较空闲的时候做，这就像打烊以后掌柜做的事。</p><p>如果今天赊账的不多，掌柜可以等打烊后再整理。但如果某天赊账的特别多，粉板写满了，又怎么办呢？这个时候掌柜只好放下手中的活儿，把粉板中的一部分赊账记录更新到账本中，然后把这些记录从粉板上擦掉，为记新账腾出空间。</p><p>与此类似，InnoDB 的 redo log 是固定大小的，比如可以配置为一组 4 个文件，每个文件的大小是 1GB，那么这块“粉板”总共就可以记录 4GB 的操作。从头开始写，写到末尾就又回到开头循环写，如下面这个图所示。</p><p><img src="https://static001.geekbang.org/resource/image/b0/9c/b075250cad8d9f6c791a52b6a600f69c.jpg" alt=""></p><p>write pos 是当前记录的位置，一边写一边后移，写到第 3 号文件末尾后就回到 0 号文件开头。checkpoint 是当前要擦除的位置，也是往后推移并且循环的，擦除记录前要把记录更新到数据文件。</p><p>write pos 和 checkpoint 之间的是“粉板”上还空着的部分，可以用来记录新的操作。如果 write pos 追上 checkpoint，表示“粉板”满了，这时候不能再执行新的更新，得停下来先擦掉一些记录，把 checkpoint 推进一下。</p><p>有了 redo log，InnoDB 就可以保证即使数据库发生异常重启，之前提交的记录都不会丢失，这个能力称为<strong>crash-safe</strong>。</p><p>要理解 crash-safe 这个概念，可以想想我们前面赊账记录的例子。只要赊账记录记在了粉板上或写在了账本上，之后即使掌柜忘记了，比如突然停业几天，恢复生意后依然可以通过账本和粉板上的数据明确赊账账目。</p><h1>重要的日志模块：binlog</h1><p>前面我们讲过，MySQL 整体来看，其实就有两块：一块是 Server 层，它主要做的是 MySQL 功能层面的事情；还有一块是引擎层，负责存储相关的具体事宜。上面我们聊到的粉板 redo log 是 InnoDB 引擎特有的日志，而 Server 层也有自己的日志，称为 binlog（归档日志）。</p><p>我想你肯定会问，为什么会有两份日志呢？</p><p>因为最开始 MySQL 里并没有 InnoDB 引擎。MySQL 自带的引擎是 MyISAM，但是 MyISAM 没有 crash-safe 的能力，binlog 日志只能用于归档。而 InnoDB 是另一个公司以插件形式引入 MySQL 的，既然只依靠 binlog 是没有 crash-safe 能力的，所以 InnoDB 使用另外一套日志系统——也就是 redo log 来实现 crash-safe 能力。</p><p>这两种日志有以下三点不同。</p><ol>
<li>
<p>redo log 是 InnoDB 引擎特有的；binlog 是 MySQL 的 Server 层实现的，所有引擎都可以使用。</p>
</li>
<li>
<p>redo log 是物理日志，记录的是“在某个数据页上做了什么修改”；binlog 是逻辑日志，记录的是这个语句的原始逻辑，比如“给 ID=2 这一行的 c 字段加 1 ”。</p>
</li>
<li>
<p>redo log 是循环写的，空间固定会用完；binlog 是可以追加写入的。“追加写”是指 binlog 文件写到一定大小后会切换到下一个，并不会覆盖以前的日志。</p>
</li>
</ol><p>有了对这两个日志的概念性理解，我们再来看执行器和 InnoDB 引擎在执行这个简单的 update 语句时的内部流程。</p><ol>
<li>
<p>执行器先找引擎取 ID=2 这一行。ID 是主键，引擎直接用树搜索找到这一行。如果 ID=2 这一行所在的数据页本来就在内存中，就直接返回给执行器；否则，需要先从磁盘读入内存，然后再返回。</p>
</li>
<li>
<p>执行器拿到引擎给的行数据，把这个值加上 1，比如原来是 N，现在就是 N+1，得到新的一行数据，再调用引擎接口写入这行新数据。</p>
</li>
<li>
<p>引擎将这行新数据更新到内存中，同时将这个更新操作记录到 redo log 里面，此时 redo log 处于 prepare 状态。然后告知执行器执行完成了，随时可以提交事务。</p>
</li>
<li>
<p>执行器生成这个操作的 binlog，并把 binlog 写入磁盘。</p>
</li>
<li>
<p>执行器调用引擎的提交事务接口，引擎把刚刚写入的 redo log 改成提交（commit）状态，更新完成。</p>
</li>
</ol><p>这里我给出这个 update 语句的执行流程图，图中浅色框表示是在 InnoDB 内部执行的，深色框表示是在执行器中执行的。</p><p><img src="https://static001.geekbang.org/resource/image/2e/be/2e5bff4910ec189fe1ee6e2ecc7b4bbe.png" alt=""></p><center><span class="reference">update 语句执行流程</span></center><p>你可能注意到了，最后三步看上去有点“绕”，将 redo log 的写入拆成了两个步骤：prepare 和 commit，这就是"两阶段提交"。</p><h1>两阶段提交</h1><p>为什么必须有“两阶段提交”呢？这是为了让两份日志之间的逻辑一致。要说明这个问题，我们得从文章开头的那个问题说起：<strong>怎样让数据库恢复到半个月内任意一秒的状态？</strong></p><p>前面我们说过了，binlog 会记录所有的逻辑操作，并且是采用“追加写”的形式。如果你的 DBA 承诺说半个月内可以恢复，那么备份系统中一定会保存最近半个月的所有 binlog，同时系统会定期做整库备份。这里的“定期”取决于系统的重要性，可以是一天一备，也可以是一周一备。</p><p>当需要恢复到指定的某一秒时，比如某天下午两点发现中午十二点有一次误删表，需要找回数据，那你可以这么做：</p><ul>
<li>首先，找到最近的一次全量备份，如果你运气好，可能就是昨天晚上的一个备份，从这个备份恢复到临时库；</li>
<li>然后，从备份的时间点开始，将备份的 binlog 依次取出来，重放到中午误删表之前的那个时刻。</li>
</ul><p>这样你的临时库就跟误删之前的线上库一样了，然后你可以把表数据从临时库取出来，按需要恢复到线上库去。</p><p>好了，说完了数据恢复过程，我们回来说说，为什么日志需要“两阶段提交”。这里不妨用反证法来进行解释。</p><p>由于 redo log 和 binlog 是两个独立的逻辑，如果不用两阶段提交，要么就是先写完 redo log 再写 binlog，或者采用反过来的顺序。我们看看这两种方式会有什么问题。</p><p>仍然用前面的 update 语句来做例子。假设当前 ID=2 的行，字段 c 的值是 0，再假设执行 update 语句过程中在写完第一个日志后，第二个日志还没有写完期间发生了 crash，会出现什么情况呢？</p><ol>
<li>
<p><strong>先写 redo log 后写 binlog</strong>。假设在 redo log 写完，binlog 还没有写完的时候，MySQL 进程异常重启。由于我们前面说过的，redo log 写完之后，系统即使崩溃，仍然能够把数据恢复回来，所以恢复后这一行 c 的值是 1。<br>
但是由于 binlog 没写完就 crash 了，这时候 binlog 里面就没有记录这个语句。因此，之后备份日志的时候，存起来的 binlog 里面就没有这条语句。<br>
然后你会发现，如果需要用这个 binlog 来恢复临时库的话，由于这个语句的 binlog 丢失，这个临时库就会少了这一次更新，恢复出来的这一行 c 的值就是 0，与原库的值不同。</p>
</li>
<li>
<p><strong>先写 binlog 后写 redo log</strong>。如果在 binlog 写完之后 crash，由于 redo log 还没写，崩溃恢复以后这个事务无效，所以这一行 c 的值是 0。但是 binlog 里面已经记录了“把 c 从 0 改成 1”这个日志。所以，在之后用 binlog 来恢复的时候就多了一个事务出来，恢复出来的这一行 c 的值就是 1，与原库的值不同。</p>
</li>
</ol><p>可以看到，如果不使用“两阶段提交”，那么数据库的状态就有可能和用它的日志恢复出来的库的状态不一致。</p><p>你可能会说，这个概率是不是很低，平时也没有什么动不动就需要恢复临时库的场景呀？</p><p>其实不是的，不只是误操作后需要用这个过程来恢复数据。当你需要扩容的时候，也就是需要再多搭建一些备库来增加系统的读能力的时候，现在常见的做法也是用全量备份加上应用 binlog 来实现的，这个“不一致”就会导致你的线上出现主从数据库不一致的情况。</p><p>简单说，redo log 和 binlog 都可以用于表示事务的提交状态，而两阶段提交就是让这两个状态保持逻辑上的一致。</p><h1>小结</h1><p>今天，我介绍了 MySQL 里面最重要的两个日志，即物理日志 redo log 和逻辑日志 binlog。</p><p>redo log 用于保证 crash-safe 能力。innodb_flush_log_at_trx_commit 这个参数设置成 1 的时候，表示每次事务的 redo log 都直接持久化到磁盘。这个参数我建议你设置成 1，这样可以保证 MySQL 异常重启之后数据不丢失。</p><p>sync_binlog 这个参数设置成 1 的时候，表示每次事务的 binlog 都持久化到磁盘。这个参数我也建议你设置成 1，这样可以保证 MySQL 异常重启之后 binlog 不丢失。</p><p>我还跟你介绍了与 MySQL 日志系统密切相关的“两阶段提交”。两阶段提交是跨系统维持数据逻辑一致性时常用的一个方案，即使你不做数据库内核开发，日常开发中也有可能会用到。</p><p>文章的最后，我给你留一个思考题吧。前面我说到定期全量备份的周期“取决于系统重要性，有的是一天一备，有的是一周一备”。那么在什么场景下，一天一备会比一周一备更有优势呢？或者说，它影响了这个数据库系统的哪个指标？</p><p>你可以把你的思考和观点写在留言区里，我会在下一篇文章的末尾给出我的答案。</p><p>感谢你的收听，也欢迎你把这篇文章分享给更多的朋友一起阅读。</p><p><img src="https://static001.geekbang.org/resource/image/ce/d9/ce7f4e35916ed1aa49206a53a0547bd9.jpg" alt=""></p></div></div> <!----> <div class="_1fMbLOUg_0"><span class="_3suBPDWW_0">©</span>&nbsp;版权归极客邦科技所有，未经许可不得转载
        </div></div> <div class="_3PNMKN7j_0 _2_jLRfDz_0"><div class="_2d0QwC3-_0"><div class="_36LfGj1s_0">上一篇</div> <div class="_3TIVUaKt_0">01 | 基础架构：一条SQL查询语句是如何执行的？</div></div> <div class="_2d0QwC3-_0"><div class="_36LfGj1s_0">下一篇</div> <div class="_3TIVUaKt_0">03 | 事务隔离：为什么你改了我还看不见？</div></div></div> <div class="DU0gW1Le_0 _2_jLRfDz_0"><div class="iconfont _3XC20_-x_0"> 写留言</div> <h2><span>精选留言</span><span class="kZAdYTZh_0">(407)</span></h2> <ul><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/74/8b/840afbd8.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>super blue...</span> <span class="_1bkbsnjg_0">置顶</span></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">175</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">我可以认为redo log 记录的是这个行在这个页更新之后的状态，binlog 记录的是sql吗？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: Redo log不是记录数据页“更新之后的状态”，而是记录这个页 “做了什么改动”。<br><br>Binlog有两种模式，statement 格式的话是记sql语句， row格式会记录行的内容，记两条，更新前和更新后都有。<br>（谢谢你提这个问题，为了不打断文章思路，这个点没在正文写，但是又是很重要的点😄😄）</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/f5/de/c33e531e.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Jason</span> <span class="_1bkbsnjg_0">置顶</span></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">135</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">首先谈一下，学习后的收获<br>redo是物理的，binlog是逻辑的；现在由于redo是属于InnoDB引擎，所以必须要有binlog，因为你可以使用别的引擎<br>保证数据库的一致性，必须要保证2份日志一致，使用的2阶段式提交；其实感觉像事务，不是成功就是失败，不能让中间环节出现，也就是一个成功，一个失败<br>如果有一天mysql只有InnoDB引擎了，有redo来实现复制，那么感觉oracle的DG就诞生了，物理的速度也将远超逻辑的，毕竟只记录了改动向量<br>binlog几大模式，一般采用row，因为遇到时间，从库可能会出现不一致的情况，但是row更新前后都有，会导致日志变大<br>最后2个参数，保证事务成功，日志必须落盘，这样，数据库crash后，就不会丢失某个事务的数据了<br>其次说一下，对问题的理解<br>备份时间周期的长短，感觉有2个方便<br>首先，是恢复数据丢失的时间，既然需要恢复，肯定是数据丢失了。如果一天一备份的话，只要找到这天的全备，加入这天某段时间的binlog来恢复，如果一周一备份，假设是周一，而你要恢复的数据是周日某个时间点，那就，需要全备+周一到周日某个时间点的全部binlog用来恢复，时间相比前者需要增加很多；看业务能忍受的程度<br>其次，是数据库丢失，如果一周一备份的话，需要确保整个一周的binlog都完好无损，否则将无法恢复；而一天一备，只要保证这天的binlog都完好无损；当然这个可以通过校验，或者冗余等技术来实现，相比之下，上面那点更重要<br><br>不对的地方，望大神指点</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 👍🏿置顶了<br><br>你说的物理复制业界有团队在做了<br><br>而且官方新版本也把MySQL的表结构都收归InnoDB管理了😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/aa/21/81ee4e60.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>lfn</span> <span class="_1bkbsnjg_0">置顶</span></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">24</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师,今天MYSQL第二讲中提到binlog和redo log, 我感觉binlog很多余，按理是不是只要redo log就够了?[费解] <br>您讲的时候说redo log是InnoDB的要求，因为以plugin的形式加入到MySQL中，此时binlog作为Server层的日志已然存在，所以便有了两者共存的现状。但我觉得这并不能解释我们在只用InonoDB引擎的时候还保留Binlog这种设计的原因.</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: binlog还不能去掉。<br><br>一个原因是，redolog只有InnoDB有，别的引擎没有。<br><br>另一个原因是，redolog是循环写的，不持久保存，binlog的“归档”这个功能，redolog是不具备的。  </p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/f7/69/d8dba3de.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>DanielAnton</span> <span class="_1bkbsnjg_0">置顶</span></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">20</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">有个问题请教老师，既然write pos和checkout都是往后推移并循环的，而且当write pos赶上checkout的时候要停下来，将checkout往后推进，那么是不是意味着write pos的位置始终在checkout后面，最多在一起，而这和老师画的图有些出入，不知道我的理解是不是有些错误，请老师指教。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 因为是“循环”的，图中这个状态下，write_pos 往前写，写到3号文件末尾，就回到0号继续写，这样你再理解看看“追”的状态。<br><br>刚好借你这个问题，说明一下，文中“write pos和checkpoint之间的是’粉板’上还空着的部分，可以用来记录新的操作。” <br>这句话，说的“空着的部分”，就是write pos 到3号文件末尾，再加上0号文件开头到checkpoint 的部分。</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/97/59/6f9c036e.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Godruoyi</span> <span class="_1bkbsnjg_0">置顶</span></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">18</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">Bin log 用于记录了完整的逻辑记录，所有的逻辑记录在 bin log 里都能找到，所以在备份恢复时，是以 bin log 为基础，通过其记录的完整逻辑操作，备份出一个和原库完整的数据。<br><br>在两阶段提交时，若 redo log 写入成功，bin log 写入失败，则后续通过 bin log 恢复时，恢复的数据将会缺失一部分。(如 redo log 执行了 update t set status = 1，此时原库的数据 status 已更新为 1，而 bin log 写入失败，没有记录这一操作，后续备份恢复时，其 status = 0，导致数据不一致）。<br><br>若先写入 bin log，当 bin log 写入成功，而 redo log 写入失败时，原库中的 status 仍然是 0 ，但是当通过 bin log 恢复时，其记录的操作是 set status = 1，也会导致数据不一致。<br><br>其核心就是， redo log 记录的，即使异常重启，都会刷新到磁盘，而 bin log 记录的， 则主要用于备份。<br><br>我可以这样理解吗？还有就是如何保证 redo log 和 bin log 操作的一致性啊？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 几乎全对，除了这个“两阶段提交时，若redo log写入成功，但binlog写入失败…”这句话。<br><br>实际上，因为是两阶段提交，这时候redolog只是完成了prepare, 而binlog又失败，那么事务本身会回滚，所以这个库里面status的值是0。<br><br>如果通过binlog 恢复出一个库，status值也是0。<br><br>这样不算丢失，这样是合理的结果。<br><br>两阶段就是保证一致性用的。<br>你不用担心日志写错，那样就是bug了…</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/bb/10/f01eafe4.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>ricktian</span> <span class="_1bkbsnjg_0">置顶</span></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">7</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redo log的机制看起来和ring buffer一样的；<br>另外有个和高枕、思雨一样的疑问，如果在重启后，需要通过检查binlog来确认redo log中处于prepare的事务是否需要commit，那是否不需要二阶段提交，直接以binlog的为准，如果binlog中不存在的，就认为是需要回滚的。这个地方，是不是我漏了什么，拉不通。。。 麻烦老师解下疑，多谢～ </div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 文章中有提到“binlog没有被用来做崩溃恢复”，<br><br>历史上的原因是，这个是一开始就这么设计的，所以不能只依赖binlog。<br><br>操作上的原因是，binlog是可以关的，你如果有权限，可以set sql_log_bin=0关掉本线程的binlog日志。 所以只依赖binlog来恢复就靠不住。<br><br>@高枕、@思雨 也看下这个讨论😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/85/43/3dc8222d.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>小张</span> <span class="_1bkbsnjg_0">置顶</span></div> <div class="_1H1Z49Dr_0">2018-11-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">6</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师您好，有一个问题，如果在非常极端的情况下，redo log被写满，而redo log涉及的事务均未提交，此时又有新的事务进来时，就要擦除redo log，这就意味着被修改的的脏页此时要被迫被flush到磁盘了，因为用来保证事务持久性的redo log就要消失了。但如若真的执行了这样的操作，数据就在被commit之前被持久化到磁盘中了。当真的遇到这样的恶劣情况时，mysql会如何处理呢，会直接报错吗？还是有什么应对的方法和策略呢？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 👍🏿，会想到这么细致的场景<br><br>这些数据在内存中是无效其他事务读不到的（读到了也放弃），同样的，即使写进磁盘，也没关系，再次读到内存以后，还是原来的逻辑</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/43/38/72feb2e0.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>哇！怎么这么...</span> <span class="_1bkbsnjg_0">置顶</span></div> <div class="_1H1Z49Dr_0">2018-12-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师您好，我之前是做运维的，通过binlog恢复误操作的数据，但是实际上，我们会后知后觉，误删除一段时间了，才发现误删除，此时，我把之前误删除的binlog导入，再把误删除之后binlog导入，会出现问题，比如主键冲突，而且binlog导数据，不同模式下时间也有不同，但是一般都是row模式，时间还是很久，有没什么方式，时间短且数据一致性强的方式</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 其实恢复数据只能恢复到误删之前到一刻，<br>误删之后的，不能只靠binlog来做，因为业务逻辑可能因为误删操作的行为，插入了逻辑错误的语句，<br><br>所以之后的，跟业务一起，从业务快速补数据的。只靠binlog补出来的往往不完整</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/fe/68/e0bebd9a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>高枕</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">166</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">我再来说下自己的理解 。<br>1 prepare阶段 2 写binlog 3 commit<br>当在2之前崩溃时<br>重启恢复：后发现没有commit，回滚。备份恢复：没有binlog 。<br>一致<br>当在3之前崩溃<br>重启恢复：虽没有commit，但满足prepare和binlog完整，所以重启后会自动commit。备份：有binlog. 一致</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 👍🏿，get 完成</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>某、人</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">113</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">1.首先客户端通过tcp/ip发送一条sql语句到server层的SQL interface<br>2.SQL interface接到该请求后，先对该条语句进行解析，验证权限是否匹配<br>3.验证通过以后，分析器会对该语句分析,是否语法有错误等<br>4.接下来是优化器器生成相应的执行计划，选择最优的执行计划<br>5.之后会是执行器根据执行计划执行这条语句。在这一步会去open table,如果该table上有MDL，则等待。<br>如果没有，则加在该表上加短暂的MDL(S)<br>(如果opend_table太大,表明open_table_cache太小。需要不停的去打开frm文件)<br>6.进入到引擎层，首先会去innodb_buffer_pool里的data dictionary(元数据信息)得到表信息<br>7.通过元数据信息,去lock info里查出是否会有相关的锁信息，并把这条update语句需要的<br>锁信息写入到lock info里(锁这里还有待补充)<br>8.然后涉及到的老数据通过快照的方式存储到innodb_buffer_pool里的undo page里,并且记录undo log修改的redo<br>(如果data page里有就直接载入到undo page里，如果没有，则需要去磁盘里取出相应page的数据，载入到undo page里)<br>9.在innodb_buffer_pool的data page做update操作。并把操作的物理数据页修改记录到redo log buffer里<br>由于update这个事务会涉及到多个页面的修改，所以redo log buffer里会记录多条页面的修改信息。<br>因为group commit的原因，这次事务所产生的redo log buffer可能会跟随其它事务一同flush并且sync到磁盘上<br>10.同时修改的信息，会按照event的格式,记录到binlog_cache中。(这里注意binlog_cache_size是transaction级别的,不是session级别的参数,<br>一旦commit之后，dump线程会从binlog_cache里把event主动发送给slave的I/O线程)<br>11.之后把这条sql,需要在二级索引上做的修改，写入到change buffer page，等到下次有其他sql需要读取该二级索引时，再去与二级索引做merge<br>(随机I/O变为顺序I/O,但是由于现在的磁盘都是SSD,所以对于寻址来说,随机I/O和顺序I/O差距不大)<br>12.此时update语句已经完成，需要commit或者rollback。这里讨论commit的情况，并且双1<br>13.commit操作，由于存储引擎层与server层之间采用的是内部XA(保证两个事务的一致性,这里主要保证redo log和binlog的原子性),<br>所以提交分为prepare阶段与commit阶段<br>14.prepare阶段,将事务的xid写入，将binlog_cache里的进行flush以及sync操作(大事务的话这步非常耗时)<br>15.commit阶段，由于之前该事务产生的redo log已经sync到磁盘了。所以这步只是在redo log里标记commit<br>16.当binlog和redo log都已经落盘以后，如果触发了刷新脏页的操作，先把该脏页复制到doublewrite buffer里，把doublewrite buffer里的刷新到共享表空间，然后才是通过page cleaner线程把脏页写入到磁盘中<br>老师，你看我的步骤中有什么问题嘛？我感觉第6步那里有点问题,因为第5步已经去open table了，第6步还有没有必要去buffer里查找元数据呢?这元数据是表示的系统的元数据嘛,还是所有表的？谢谢老师指正</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 其实在实现上5是调用了6的过程了的，所以是一回事。MySQL server 层和InnoDB层都保存了表结构，所以有书上描述时会拆开说。<br><br>这个描述很详细，同时还有点到我们后面要讲的内通（编辑快来，有人来砸场子啦😄😄）<br><br></p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/d4/e0/513d185e.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>文@雨路</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">38</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，我想问下如果提交事务的时候正好重启那么redo log和binlog会怎么处理？此时redo log处于prepare阶段，如果不接受这条log，但是binlog已经接受，还是说binlog会去检查redo log的状态，状态为prepare的不会恢复？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 好问题👍🏿表示中间那段你都听明白了👍🏿<br><br>Binlog如果已经接受，那么redolog是prepare, binlog已经完整了对吧，这时候崩溃恢复过程会认可这个事务，提交掉。 （你可以分析下这种情况下，是否符合我们要达到的“用binlog恢复的库跟原库逻辑相同” 这个要求）</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/44/cc/3e62d111.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>justd</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">32</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">一个完整的交易过程：账本记上 卖一瓶可乐（redo log为 prepare状态），然后收钱放入钱箱（bin log记录）然后回过头在账本上打个勾（redo log置为commit）表示一笔交易结束。<br>如果收钱时交易被打断，回过头来整理此次交易，发现只有记账没有收钱，则交易失败，删掉账本上的记录（回滚）；如果收了钱后被终止，然后回过头发现账本有记录（prepare）而且钱箱有本次收入（bin log），则继续完善账本（commit），本次交易有效。<br></div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/2d/6a/21edc91e.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Mao</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">25</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，您好。您说MySQL 使用WAL，先写日志再写磁盘。请教一个问题，<br><br>执行一条Update 语句后，马上又执行一条 select * from table limit 10。<br><br>如果刚刚update的记录，还没持久化到磁盘中，而偏偏这个时候的查询条件，又包含了刚刚update的记录。<br><br>那么这个时候，是从日志中获取刚刚update的最新结果，还是说，先把日志中的记录先写磁盘，再返回最新结果？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/d4/e0/513d185e.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>文@雨路</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">21</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，也就是说状态恢复的过程会去同时检查redo log和binlog？不然怎么能确定一个prepare的redo log已经写好了binlog，因为不检查的话不能确定到底是写好了binlog之后奔溃的还是写之前奔溃的，也就不能确定这个prepare log的合法性。如果检查的话那么不用两阶段提交好像也没什么问题，无论先写哪个日志都可以。</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e2/9d/fbbd4611.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>cyberbit</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">20</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">我理解备份就是救命药加后悔药，灾难发生的时候备份能救命，出现错误的时候备份能后悔。事情都有两面性，没有谁比谁好，只有谁比谁合适，完全看业务情况和需求而定。一天一备恢复时间更短，binlog更少，救命时候更快，但是后悔时间更短，而一周一备正好相反。我自己的备份策略是设置一个16小时延迟复制的从库，充当后悔药，恢复时间也较快。再两天一个全备库和binlog，作为救命药,最后时刻用。这样就比较兼顾了。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 你是有故事的人😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/df/e7/e3c450c2.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>lionetes</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">17</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">昨天上午 恢复别人误操作配置表数据，幸好有xtarbackup凌晨的全量备份，只提取了改表的ibd文件，然后在本地 做了 一个一样的空表，释放该表空间，加载 提取后的ibd文件，提取昨天零晨到九点的binlog文件 筛选改表这个时段的操作记录 增量更新到本地导出csv 导入线上  。binlog太tm重要了</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 你选择了最优路径👍🏿</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/e9/0b/53bf91d3.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>WL</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-24</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">15</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">为该讲的内容总结了几个问题, 大家复习的时候可以先尝试回答这些问题检查自己的掌握程度:<br>&nbsp;&nbsp;&nbsp;1. redo log的概念是什么? 为什么会存在.<br>&nbsp;&nbsp;&nbsp;2. 什么是WAL(write-ahead log)机制, 好处是什么.<br>&nbsp;&nbsp;&nbsp;3. redo log 为什么可以保证crash safe机制.<br>&nbsp;&nbsp;&nbsp;4. binlog的概念是什么, 起到什么作用, 可以做crash safe吗? <br>&nbsp;&nbsp;&nbsp;5. binlog和redolog的不同点有哪些? <br>&nbsp;&nbsp;&nbsp;6. 物理一致性和逻辑一直性各应该怎么理解? <br>&nbsp;&nbsp;&nbsp;7. 执行器和innoDB在执行update语句时候的流程是什么样的?<br>&nbsp;&nbsp;&nbsp;8. 如果数据库误操作, 如何执行数据恢复?<br>&nbsp;&nbsp;&nbsp;9. 什么是两阶段提交, 为什么需要两阶段提交, 两阶段提交怎么保证数据库中两份日志间的逻辑一致性(什么叫逻辑一致性)?<br>&nbsp;&nbsp;10. 如果不是两阶段提交, 先写redo log和先写bin log两种情况各会遇到什么问题?</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/07/8c/51401220.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>小美</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">10</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，我这想请教两个问题：<br>1.写redo日志也是写io（我理解也是外部存储）。同样耗费性能。怎么能做到优化呢<br>2.数据库只有redo commit 之后才会真正提交到数据库吗</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 1. Redolog是顺序写，并且可以组提交，还有别的一些优化，收益最大是是这两个因素；<br><br>2.是这样，正常执行是要commit 才算完，但是崩溃恢复过程的话，可以接受“redolog prepare 并且binlog完整” 的情况</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/70/51/eb68ec53.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Lugyedo</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">9</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redo log和bin log怎么对应</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 事务ID （比较细节，就没在正文里写了</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/70/97/e5bf9ddb.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>jacket</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">9</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">【回答问题】<br>备份数据库的周期直接影响到了恢复的速度，一天一备的话，恢复时只需要重新执行最近一天的数据库修改操作。而一周一备则需要做很多。所以在对于系统恢复速度很敏感的系统，最好使用一天一备，甚至一小时一备等等。</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/dc/b7/e59c22f0.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>黄金的太阳</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">8</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请教老师，redo log是为了快速响应SQL充当了粉板，这里有两个疑问<br>1. redo log本身也是文件，记录文件的过程其实也是写磁盘，那和文中提到的离线写磁盘操作有何区别？<br>2.响应一次SQL我理解是要同时操作两个日志文件？也就是写磁盘两次？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 你的理解是对的。<br>1. 写redo log是顺序写，不用去“找位置”，而更新数据需要找位置<br><br>2. 其实是3次（redolog两次 binlog 1次）。不过在并发更新的时候会合并写</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/e2/cb/6bc95e09.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>喔～</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">7</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redo 是引擎提供的，binlog 是server 自带的，文中提到前者用在crash的恢复，后者用于库的恢复<br>两者是否在某种程度上是重复的？如果在都是追加写的情况下，是否两种日志都能用于 crash 与 库 的恢复呢？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: Crash-safe是崩溃恢复，就是原地满血复活；binlog恢复是制造一个影分身（副本）出来</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/7a/e0/3d5b28ef.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>清歌</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">6</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">binlog为什么说是逻辑日志呢？它里面有内容也会存储成物理文件，怎么说是逻辑而不是物理</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这样理解哈。 <br><br>逻辑日志可以给别的数据库，别的引擎使用，已经大家都讲得通这个“逻辑”；<br><br>物理日志就只有“我”自己能用，别人没有共享我的“物理格式”</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/4e/3a/2aa0f5cf.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>linqw</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-28</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">5</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">学习后的收获总结：<br>1、首先数据库更新操作都是基于内存页，更新的时候不会直接更新磁盘，如果内存有存在就直接更新内存，如果内存没有存在就从磁盘读取到内存，在更新内存，并且写redo log，目的是为了更新效率更快，等空闲时间在将其redo log所做的改变更新到磁盘中，innodb_flush_log_at_trx_commit设置为1时，也可以防止服务出现异常重启，数据不会丢失<br>2、redo log两阶段提交，是为了保证redo log和binlog的一致性，如果redo log写入成功处于prepare阶段，写binlog失败，事务回滚，redo log会回滚到操作之前的状态<br>3、redo log也是写磁盘，写redo log是顺序写，update直接更新磁盘，需要找到数据，再对此数据进行更新，如果没有使用索引，数据量大会导致更新效率慢，不对的地方，望老师指点哦</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 很好👍🏿<br><br>最后一段，“有索引”写数据也慢，因为是随机写</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/54/ce/ed58c82d.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>为你而来</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">5</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">记笔记:<br>redo  log 记录 做了什么改动（比如把某个字段从0改成了1）<br><br>binlog 记录 是怎么修改的（记录sql语句或者 记录更新前后的行）</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 好习惯：）</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/d2/c9/f262f947.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>卜卜口</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">4</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，有个疑问，怎么知道binlog是完整的？这个想不通</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 一个事务的完整binlog是有固定格式，也就是说有固定结尾的😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/8a/9a/7270d764.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Enterprize</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">4</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">爱学习的我表示可以更新快一些，每次看一篇不过瘾</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 👍🏿爱学习，周末休息下，下一篇是下周一凌晨啦😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/c6/e4/ec572f55.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>沙亮亮</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">4</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redo_log恢复是以什么状态为依据，是prepare，还是commit</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/dd/5d/ea2e41d0.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Victor</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">4</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">感谢老师分享，很有深度，有个问题，一直有疑惑？Buffer Pool中的脏页刷新到磁盘中，只能由ckeckpoint操作触发么？有没有可能未提交的事务也刷新到磁盘中啦？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不止是checkpoint, 有别的时机的。 这个展开比较复杂，会在第十讲说到</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/fe/68/e0bebd9a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>高枕</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">4</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师 与思雨有同样疑惑<br>也就是说状态恢复的过程会去同时检查redo log和binlog？不然怎么能确定一个prepare的redo log已经写好了binlog，因为不检查的话不能确定到底是写好了binlog之后奔溃的还是写之前奔溃的，也就不能确定这个prepare log的合法性。如果检查的话那么不用两阶段提交好像也没什么问题，无论先写哪个日志都可以</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 很好的思考，你考虑一下这个场景，redolog没写，binlog写好了，怎么算。 注意由于binlog写完了，在备份恢复回来以后是会重放这个事务的。 </p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>小妖精</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">4</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师讲解的真好，期待更新</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/ea/9a/02d589f9.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>斜面镜子 Bi...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-21</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">3</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">备份时间周期的长短，理解需要考虑<br>1.业务实际的数据存量，如果大到一天没有办法备份完成，只能一周一次，甚至更长<br>2.业务数据的增量，如果增量非常大，如果一周备份一次，增量备份的考验会比较大，极大的概率会出现增量备份失败问题，另外恢复时长和成功率也比较困难<br>3.业务比较重要并且对恢复时间的忍受程度低，并且历史上多次出现类似数据回滚的需求，而且增量还不小优先一天一备份，相反业务实际不重要，出问题后可以容忍一定的不可用，而且增量还不多，出于成本考虑可以用一周一备份备份<br>4.文件的恢复效率很高的话，大多业务增量一周的恢复时长还是可以保证的，这时候就是提供SLA让业务决策了<br><br>综合数据存量、增量、备份成本、恢复效率、业务SLA选择，我理解就有答案了！</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/f8/34/2ce5e546.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Elvis</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">3</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请教下redo log 和 binlog 也是需要写文件的，也会消耗IO，这个不会影响数据库的性能吗？ 从内容看redo log首先写道缓存中，如果这个时候断电了，缓存也清空了，尚未写道磁盘，这个时候不是redo log 不完整的如何保证恢复的完整性呢？麻烦老师指教下</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 要写IO，是会影响，但是为了数据可靠性，还是要做的。<br><br>Redolog是直接写盘的，更新的内存是数据的内存。<br><br>如果没有写完就重启，就回滚，不算的丢数据</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/f8/ba/14e05601.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>约书亚</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">3</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">看到了文@雨路的留言，和我的疑问一模一样。另外有个没提到，如果认可这个事务可以从crash恢复，起码要求服务器告知客户端事务成功了吧，那您说redo log prepare + bin log ok，就可以恢复了，说明bin log写入成功就算事务成功了？那最后一步确实没什么用呀。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 有用，如果redolog 已经commit了，崩溃恢复就不需要去找binlog. </p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/f8/ba/14e05601.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>约书亚</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">3</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">疑问，redo log是否必须处于commit状态，才能用于crash后的恢复？这样会不会在bin log写入，redo log commit之前发生crash？这样不是和您说情况2一样？<br>如果不是，那似乎又和情况1一样？<br>且如果最后commit之前crash，我理解是事务执行失败吧？那binlog这条记录不能用作恢复吧？<br>难道commit同时代表redo log和bin log生效?</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: Commit确实表示这两个日志都生效了。<br><br>可以看一下@高枕 在15:19 的评论</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>有铭</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">3</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">我觉得有些问题文中没有说的很清楚：<br>*. 文中说有可能先写在黑板上，暂时不会写到账本，是指的redo log本身，还是数据？如果是数据的话，那就有个新问题了，你update后数据不在硬盘上，此时select得到的数据不就是旧数据吗？<br>*. 从理论上讲，可不可以认为InnoDB引擎的事务特性完全是由redo log日志完成的？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 确实没写到数据上，但是不影响查询正确性，因为写了内存，下次查询是从内存里面读的。 <br><br>内存可能会被淘汰，又会触发相应的写盘操作。<br>这个在第十讲中会提到。<br><br>确实一篇文章没里办法全部展开，继续关注后面的文章哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/ad/37/abb7bfe3.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Allen</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">3</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">看了正文还有些不太能消化，再看看留言，还来也是有很重要的内容。看来留言也不能忽略，想当于大家学习后的交流和巩固</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 作者也很爱评论区，笔芯😁</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/14klQsmQShM1177FnuuN77X9u1QX9icktEec6dmmQwC3mRiaEJY1NFOzLRxG7tZFrjMmiaxhdouAmYgkLLqsRtyeg/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>T^T</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">3</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师可以把redo log和binlog日志贴一点点吗？有助于直观感受</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 额，我主要怕有占篇幅之嫌… binlog的我加到答疑篇，redo的… 对于非数据库内核开发人员是不可读的数据， 基本大家用不到</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>哈乐笑</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">2</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">看了作者的文章，我感觉redo log和binlog都有恢复数据库的功能，不过redo log是，当mysql服务挂掉之后，重启的时候回复用的恶，而binlog是用于数据库损坏或者误删等整体大规模恢复用的。不知道这样理解对不对</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/c9/46/094b06bf.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>菠菜</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">2</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">俩问题，一个是当mysql重启，对于innodb的启动是如何实现的，听文章说redo log会很大，比如一个G，需要全都加载一边才能算启动完成吗？另一个，二段提交，如果在commit之前crash了，innodb是如何界定这一条数据全是丢弃还是不丢弃？因为有两种情况，一种是bin log写成功了，但是commit没成功，另一个是bin log压根就没写成功</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 1. 从checkpoint开始到writepos结束，不需要全部4G<br><br>2. Binlog写成功事务算成功，就提交事务；binlog没写成功就回滚</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/f9/03/23706390.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>魔都浪子</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">2</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">在binlog写入磁盘后，commit提交前发生crash，由于commit没有成功，那返回给客户端的消息是事物失败，但是在系统恢复的时候却会重新提交事物，使之成功，这不是在欺骗客户端嘛？问题很大啊</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不是，并没有返回“事务失败”呀，而是“执行异常”。执行异常本来就可能成功也可能失败的。你想一下这个场景：执行全部完成了，在回复客户端的时候网络断了，这怎么算😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/9d/84/171b2221.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>jeffery</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">2</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">binglog 一般建议设置啥模式 假如row模式binglog 怎么回复</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 建议设置row模式，row模式日志一样的可以用于重放的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/2a/a5/625c0a2e.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>　</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">2</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">频繁的更新写入，导致redolog过大，适合短周期的备份？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: Redolog固定大小，不会“导致过大”的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/ea/dc/e3fcd3ee.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>一梦如是</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">2</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，undolog记录的是修改前的内容，这个是在什么时间写入和提交的呢？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 第三讲会讲到哦</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/46/48/e959b1e0.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>amazon1011</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">2</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师可以分享下MySQL 的redo和Oracle的redo有什么不一样吗?之前在书上看M中的的redo是物理逻辑日志，就是说记录到物理页面的，但记录页面的内容是逻辑的，基于这个原因，有了double write的设计，就是一定要保证数据页面是完整的才能应用redo，而O因为是真正的物理日志，才没有double write的设计，不知道理解的对不对，请指教，谢谢</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: Double write buffer这里理解不太对，是要保证数据页完整才能“写入磁盘”。 这个过程跟我们今天的内容关系不大哈。我们可以在第10讲讨论这个问题</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/c0/6c/efbb9020.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>随心而至</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">2</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">当每天需要进行大量的更新操作时，使用一天一备份较好，这样备份库使用bin log备份时可以更快地完成，而且备份库的数据不会落后主库太多</div>  <!----></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/ibZVAmmdAibBeVpUjzwId8ibgRzNk7fkuR5pgVicB5mFSjjmt2eNadlykVLKCyGA0GxGffbhqLsHnhDRgyzxcKUhjg/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>pyhhou</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">2</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师讲的浅显易懂，我这个数据库小白感觉收获颇多。有两个地方不太理解，一是，binlog也可以被引擎操作，那么binlog除了由执行器记录逻辑信息，是否引擎也会参与进binlog的记录？另外就是小结中提到的将log文件在磁盘中持久化，这是一个怎样的操作？因为一想到外部磁盘总感觉和内存相比会很慢，每次更新都持久化磁盘会不会影响效率？望老师指正</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 记录binlog这个动作是执行器做的，引擎会提供信息；<br><br>嗯，写盘点代价比内存高的。但是这个是没法避免的。除非业务可以接受主机掉电丢数据。对于不能接受的业务，这个是绕不开的成本。 <br><br>所以幸好我们已经过了机械硬盘时代（弹冠相庆.gif)</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/d2/cd/6fb14677.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>苍茫</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">我想问下，逻辑日志和物理日志有啥区别，能不能详细解答一下？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 第15篇和第23篇有提哈，你看下</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/16/a8/75476086.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>act</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">执行一条Update 语句后，马上又执行一条 select * from table limit 10。<br><br>如果刚刚update的记录，还没持久化到磁盘中，而偏偏这个时候的查询条件，又包含了刚刚update的记录。<br><br>那么这个时候，是从日志中获取刚刚update的最新结果，还是说，先把日志中的记录先写磁盘，再返回最新结果？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 都不是，<br>直接读内存😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/f8/70/f3a33a14.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>某、人</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-09</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师,打搅了,吃盘回锅肉,还有个问题想请假下。<br>开启了半同步复制after_sync以后，假设一个事务在已经把binlog sync到磁盘了,在传输binlog到从库上时,主库挂了。如果这时发生了主从切换,从库是没有这个事务的.但是挂掉的主库重新启起来,由于binlog已经fsync到磁盘,虽然引擎层未commit,但是会根据binlog来恢复这个事务.这个时候就是主从不一致了,那么和after_commit那就没区别呀。请问这个事务是恢复还是回滚呢？如果是回滚,内部又是怎么判断的呢？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 复习的好习惯呀👍🏿<br><br>如果你设置来双MM，启动以后binlog还会传到新主库的。<br><br>但是如果你设置的是单向的，那就会不一致了…<br></p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>null</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-06</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">思考题：<br>针对一周一备的情况下，假设最后一天因为误操作导致数据丢失，我们得找到上一周的整库备份文件进行恢复，同时还需要重放这周 7 天的 binlog 日志，恢复时间较长。而同样情况下，一天一备的场景，只需要重放今天的 binlog 日志便恢复数据了。<br><br>---<br><br>疑问：<br>为什么说“只依靠 binlog 是没有 crash-safe 能力的”？<br><br>原文提到：有了 redo log，InnoDB 就可以保证数据库发生异常重启，之前提交的记录都不会丢失，这种能力称之为 crash-safe。<br><br>假设我们将图“update 语句执行流程”中的“写入 redo log” 操作剔除，流程变成：... -&gt; “新行更新到内存” -&gt; “写 binlog” -&gt; “提交事务”。<br>1. 新行更新到内存，写 binlog 前发生异常重启，binlog 和 磁盘均无记录。（这种情况算数据丢失么？是否应该先写日志再更新内存呢？这样即使在写日志后，更新内存前，发生异常重启，数据在日志里未丢失。）<br>2. 写 binlog 之后发生异常，binlog 有记录，磁盘无记录，重放 binlog，磁盘状态与 binlog 一致，数据未丢失。<br><br>从上面 2 点来看，binlog 也可以保证数据库发生异常重启，之前提交的记录也不会丢失，即拥有 crash-safe 能力。<br><br>谢谢老师！</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: WAL机制里面有“已经提交但是还没落盘”的数据，binlog恢复不了这些</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/13/7d/1454db9c.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>还来得及</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-30</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">我有点蒙，<br>1.如果把innodb_flush_log_at_trx_commit设置成1每次都写入到磁盘，那不就等于是掌柜的每次记账都记到账本上嘛，那还要小黑板干嘛呢？感觉我从文中没理解到各位大神已知的信息一样。<br>2.binlog是逻辑，redolog是物理，两者都能记录历史，如果发生异常情况binlog就可以恢复数据，为什么说只有redolog才能算是crash-safe了呢。<br>可能是我基础不够就看大神的文章，有些懵，还烦老师给解一下疑惑～谢谢。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 1. Redolog是顺序写，数据文件是随机写。虽然都写盘，顺序写还是快很多的<br><br>2. 这个我在答疑文章中展开哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/1c/f9/abb7bfe3.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>查尔斯</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-26</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">有个疑问是，我们保证断电数据不丢失，可以在事务每次commit时候直接写磁盘落地，当然这性能太差，我们采取写日志的形式，日志是顺序写的，性能会高些，那这样的话我觉得可以直接使用binlog做断电后的恢复，每次写入binlog后再做commit，不写binlog当他没提交，这样理论上和直接写数据感觉是一样的，为什么还是要是用redo log呢？<br><br>~~~~~~~~~~~~~~~~~~~~~~~~~<br><br>书接上文，不支持直接回复有些难受<br><br>感谢您对我的解答，我的意思是使用binlog做断电数据恢复，没写log的不提交，但是 回滚操作使用undolog实现，redo log不写的话感觉不影响的呀</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: Undolog是依赖redo来恢复的，没有redo的话，undolog就不完整…</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/e8/90/d63f8347.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>yushing</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-21</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">文本提到“如果每一次的更新操作都需要写进磁盘，磁盘还要找到对应的那条记录再更新，整个过程IO和查找成本都很高，于是使用WAL技术进行优化”，我的疑问是redo log和binlog不是也要写入磁盘么，那么使用redo log和binlog怎么能够解决更新时磁盘IO和查找成本高的问题呢？还望老师能够解答，谢谢~</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/68/73/3cda533e.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>乔良qiaolian...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-21</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">"先写日志在写磁盘" 这里的是日志和磁盘是逻辑上的所指？ 日志（粉板）本身不也在磁盘上么？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/0e/fe/00a9b201.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Albert</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请问redo log是写磁盘吗？如果是，那这种写字盘和把数据直接写到磁盘上，如果有什么区别？如果不是那怎么保证灾难发生之后可以重新恢复？谢谢！</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/f6/b0/837f5d36.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Mackie .We...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，非常感谢你的优质文章，你的每篇文章，我都要研究一段时间，而且一直做笔记，而且真的使我对mysql一个全新的认识，因为之前总感觉一直止步于数据恢复等业务操作都无法前行了。<br>恕我冒昧我突然想到前不久刚遇到的一个mysql的问题，我总感觉和我们学习的有很大关系，不知道是不是通过binlog来修复的。<br>情形是这样的，我们因为磁盘IO异常导致数据库异常重启了，并发现某个表数据损坏了（无数据备份）且mysql无法开启，一开始的做法innodb_force_recovery设置到1-6直到数据库可以启动，然后进行mysqldump备份，然而并不能备份，报错是mysqldump:&nbsp;Error&nbsp;2013:&nbsp;Lost&nbsp;connection&nbsp;to&nbsp;MySQL&nbsp;server&nbsp;during&nbsp;query&nbsp;when&nbsp;dumping&nbsp;table&nbsp;`XX表`&nbsp;at&nbsp;row:&nbsp;31961089。于是就跳过这个表进行备份，并修复了其他数据库，但是这个表的数据丢失最终请了外援修复好了，但是具体没告诉我们，不知道和我们这个有没联系？有没提示让我学学习下这方面？是可以用ibd文件修复吗？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 你说的这个case我分析了一下。<br>1. 这个现象应该是数据页（page) 的内容错了。InnoDB在读到数据页的时候会判断checksum，碰到有不对的页，就会自己crash掉<br>2. 修改 force_recovery启动以后，mysqldump会显示Lost connection，表示出错的表是在主键索引上（如果是叶子节点，dump的时候是不会访问到的）<br>3. 这种场景的坏表修复，有一种方法，是把错误的page先忽略掉。每个page有checksum，可以扫文件找到checksum不对的page，清空掉内容，初始化成空的。（另一种做法是修改MySQL的代码让MySQL忽略这个错误，而不是crash）<br>4. 总之第3步的目的就是跳过那些已经错了的数据页，把表里面别的数据取出来<br>5. 按照前说的，可以判断出这个错误的页是在主键上面，所以会丢几行的。<br>6. 找回这几行的方法，有几个地方： 这个表其他索引里面有部分字段；undolog；binlog；业务对账。 但是这些都不能保证能够100%拿回全部数据。 <br>一般尽量用binlog，业务对账已经是属于数据库本身没辙了。<br><br>我碰到过这种情况，没有binlog的情况下，做到第5步，业务就满意了。<br><br>最后总结一下 ：一定要备份，包括数据和binlog。</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/49/a5/e4c1c2d4.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>qpm</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师我问个笨问题，更新停留在redo-log bin-log上时，查询是如何把新数据也包括进来？是在查询启动的时候把redo-log的数据刷新到页数据里面么？同一个数据库里，查询和更新同样多时，岂不是会让redo-log的“粉笔板”效果失效？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不会，最新的结果会保存在内存里面，就是“掌柜的记忆”，查询直接从内存返回就可以了<br></p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/13/35/b6328a05.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>如余</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">如果binlog写入成功，而此时事务正在提交时crash了，那不是redo log  与 binlog 不一致，同时如果用binlog 恢复数据，是不是也会造成数据不一致，望老师解惑</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这时候崩溃恢复时，事务会提交的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/57/d8/abb7bfe3.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Andylee</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">刚开始我也是比较疑惑既然有了binlog，为何还需要redolog。把老师的文章反复看了几遍大概弄明白了，redolog是innodb引擎特有的，为了WAL而存在,更新操作是先写入redolog，之后异步写到数据的磁盘文件中。假设现在前后更新了2条记录并且都写入binlog后突然宕机，在服务重启后，如果只根据binlog是无法获知当前磁盘上的数据文件中那2条记录的状态是否是最新的（除非从头开始跑一遍binlog），所以一定要借助redolog才能知道宕机前有哪些记录还没更新到磁盘。如果存储引擎不支持WAL，也不支持事务回滚，每次更新都是直接更新到数据磁盘中，这应该不需要考虑宕机的问题。因为WAL的异步写入存在，所以需要解决宕机的恢复问题，需要redolog的协助，而redolog需要和binlog保持状态一致，这又要依靠两阶段提交。</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/06/b1/ba6b4335.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>高强</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">两阶段提交是针对自动提交事务的语句来说的吗？<br>如果是手动提交事务呢？<br>执行更新语句，只更新当前session缓存。当手动commit的时候，才是  记录redo log  处于prepare状态，执行器执行，记录binlog，然后 redlog commit<br>是这样吗<br><br>-------<br>如果用户手动commit，但是第三步redlog变成  commit的时候挂掉，这时候用户收到的执行结果是什么?---这时候恢复的时候是认可这次commit的</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不是，这个跟手动还是自动无关。你说的commit是一个命令，“提交这个事务”，包含了整个提交过程（也就是说两次redolog和一次binlog操作，都是在你的这个commit **命令**中做的）</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>wida</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">先写日志后写文件如何理解 日志不是在文件里吗？ 是不是redolog 是先在内存里头的？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 我们分成日志 (redolog)和 数据文件 ，不在一起的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/f3/1e/8ea92c76.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>毓殇笳</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">讲得非常好，有条不紊，温文尔雅</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 哎呀作者害羞了😁</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>ghostfevil</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师能讲的时候讲讲源码吗</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这个专栏不太会讲源码，会讲原理+实践</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/A94RKUfWfwzRzb68T9xskctQ43TBgXSBIL78p0N0ria2tQxmsTTJebYmefhkbHK7zwpoxokxs43UxpgDTdwm5tg/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>慕塔</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">多写场景需要吧 指标应该是RTO。有个问题既然innodb事务性这么强，为什么在恢复临时库不用redo恢复呢？直接对页进行恢复 数据一致性强，恢复时长也短，不用多写一份binlog，减少写放大。这样做主从直接redo同步岂不是更好吗(就是redo量有点大) 谢谢</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 很好的提问方式👍🏿<br><br>Redo主要就是因为循环使用会覆盖；不过你说的这个逻辑，业界已经有团队通过改造InnoDB行为在做了，只是不是官方做的，所以正文中没提</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/46/48/e959b1e0.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>amazon1011</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，明白double write是为了保证数据页面的完整性，我上午问的是db 异常关闭起来需要做恢复的时候，因为MySQL 的redo 是物理逻辑日志，记录的是页面逻辑的改动，所以要保证数据页面的完整性，这个就是靠double write 去保证的，是这样吗？而Oracle因为redo是物理日志，所以不需要double write技术的保证?</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 对，这样说就精确👍🏿 <br><br>不过现在有些硬盘支持16K的原子写保证，就可以关掉double write buffer. <br>MariaDB 就提供了这个参数允许关掉</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/a1/07/abb7bfe3.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>杨智晓 ✟</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">Redis还有HBASE的思路好像也是用redo log的方式，先写log，然后写入内存，最后再根据log把数据更新到磁盘</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 嗯嗯，WAL 是数据库的通用设计思路：）</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/36/d2/c7357723.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>发条橙子 。</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">innodb结构为内存池和后台线程 ， 其中内存池里存在redo日志缓冲 和 缓冲池，其中缓冲池以页为单位缓冲磁盘数据 。<br><br>问题： <br>1.之前老师说更新语句时执行器调用innodb存储引擎先从内存读数据，指的就是从innodb缓存池中读取数据把，没有的话就去读取磁盘找， 找到后再同步到缓冲池。<br><br>2. 在 server层中， 连接器先 查询缓存 ， 这个缓存指的也是 innodb 的缓冲池么。mysql 通过公有的缓冲组件调用 innodb 的缓冲池来获取值。 获取不到在走 分析器 --&gt; 优化器 --&gt; 执行器的流程 。<br><br>3. 从缓冲中取的时候 ，为什么没有  分析器 --&gt; 优化器 --&gt; 执行器 的流程呢</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 1 是的<br>2 不是，server 层的查询缓存就是（query_cache) Server层跟innodb的buffer pool是没有交集的，引擎没有暴露这个接口，只有操作数据的接口<br>3 跟2 类似，不是一个东西哦</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e7/b7/5aa9a011.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>代贤君</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">备份也是有锁的，特别是myisam引擎</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 是的，我们在 第六讲会提到</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/c6/e4/ec572f55.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>沙亮亮</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redo_log分为两阶段提交的一个原因是不是为了恢复binlog的时候不用去检查redo_log中对应语句的状态，因为binlog恢复的时候不可能每句都去检查redo_log是否提交成功，那样太繁琐？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 崩溃恢复用的是redolog</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/ce/db/9dba29ea.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>暴君•熊</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">头一次觉得概念变得如此清晰</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 👍🏿听得认真就有奖励😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/76/93/c78a132a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>果然如此</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">一天一备份恢复的时候重放的时间更短。<br>有个问题：更新流程中，更新之前先返回这行数据，这里返回也是内存吧，这个内存和更新后写入的内存有什么区别？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e3/44/ecc6e5b5.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Jager</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">在频繁更新的场景下，binlog会非常大，这时候通过更高频率的备份就可以缩短binlog的保留时长，减少磁盘空间占用，另外就是在这种更新频繁的场景下，如果一周一次备份，恢复起来没有一天一个备份那么快，我想到的一个点，不知道有没有挨到边？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/57/4f/6fb51ff1.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>一步</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，在两阶段提交那部分，每当一个动作完成后，会有事件通知吗？比如在binlog写入成功后，进行commit redo log，这个commit动作在成功或者失败后，会有回调或者事件通知吗？我感觉如果有通知机制的话，能更好的保持两个log的一致性，老师怎么认为呢？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这个就涉及“组提交”概念。是的，有通知，commit完成然后才继续后面的流程（比如返回ack给客户端）</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/ec/01/978d54af.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Justin</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师 我有一个问题 比如因为删表等操作需要回滚，但不希望数据库执行binlog中全部的语句 比如说删除语句不执行的话 可以通过自己手动筛选数据库执行的binlog类型吗？还是必须都要执行呢？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 可以在线程里面单独设置 是否使用binlog, 也可以单独设置binlog格式，前提是要有super权限</p></div></div></li><li class="reJj6Thl_0"><img src="https://wx.qlogo.cn/mmopen/vi_32/ZP5xhL8zv874pBibuLof7bzkZpD6k5dW6wdqpdRncH8O82KAtEGRG8ResUibabVcogd4CfTaDBPM9KprGbPLtcDg/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>angeltails</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redo log 是记录记录这个数据改动后的值<br>而bin log 是记录这个数据是如何改动的这样吗？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 看一下置顶评论哦</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/18/ba/b7194745.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>动脉</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class="">1</span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">真好</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/5e/2e/bc539981.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>vitojiang</span> <!----></div> <div class="_1H1Z49Dr_0">2019-02-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请教个问题：不用两阶段也可以保证两个log状态的一致性吧，比如先写binlog，在事务提交的时候写redolog，redolog写成功，即事务commit成功，sql执行成功；否则commit失败？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/1e/96/3162d51f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>等风来</span> <!----></div> <div class="_1H1Z49Dr_0">2019-02-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师第五部，如果提交事物失败怎么处理，修改redo log状态失败，怎么回滚binlog?</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: binlog这时候还没写到磁盘上的，直接删掉binlog cache李忠的内容就可以</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/cd/2c/a02a8372.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>巅</span> <!----></div> <div class="_1H1Z49Dr_0">2019-02-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师你好，关于redo 和binlog写入完成<br>但是不commit的情况<br><br>此时我断开连接，这个事务应该是失败的。<br>按照上面的说法，恢复的时候binlog这一条记录存在了，所以这条记录应该存在。<br>这个观点有问题还是mysql的bug</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: “此时我断开连接，这个事务应该是失败的。”<br><br>----这里有问题，此时你主动断开连接，这个事务就是“异常”，而不是“失败”<br><br>异常的事务，状态可能是提交，也可能是为提交，所以记录存在，是合理状态的一种。<br>好问题<br></p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/fb/96/d2777aa7.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>图灵能量</span> <!----></div> <div class="_1H1Z49Dr_0">2019-02-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师你好，看完你的这篇文章，我有一个疑惑，希望能够予以解答，1、写入redo log，处于prepare状态，2、写binlog，3、redo log commit;<br>如果在第2步执行完了之后，MySQL进程异常，恢复数据库后，会认为该条记录redo log处于prepare但binlog完整，所以该条记录自动提交且有效，但是如果业务系统请求认为数据库异常，所以业务系统认为此次处理未生效，告知其他业务系统，那么其他业务系统再次提交请求，是不是就造成了重复提交的问题，在平时业务系统应该怎么处理这类情况。</div>  <!----></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLwVgXx5UCmXuUJIibytjfxlfia7XJBX6ricaVuGpAREA9fm8mK7WwKXEzictLQRIicvrIgRCGtrwfsS9g/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Mingjie</span> <!----></div> <div class="_1H1Z49Dr_0">2019-02-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redlog是一个存在于磁盘上的文件 ，不是一个内存文件是吧</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 是一组磁盘上的文件<br></p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/98/90/d9659fae.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>心语心愿</span> <!----></div> <div class="_1H1Z49Dr_0">2019-02-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">有一个问题没想通想请教下老师，如果不分为两个阶段，而把写redo和binlog放在一个事务里面，如果写redo失败，则失败回滚，binlog写失败，则同样回滚，只有两个一同成功才算真正成功，这样也可以保证数据一致性，为什么一定需要两阶段呢</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 是这样的，redolog是innodb里面的，<br><br>如果按照你说的这种方式，redolog提交后，在引擎内就得算是事务完成了（因为没有第二阶段让事务“真正完成”）<br><br>这样binlog失败的时候，想让引擎回滚就回滚不了了</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTLwVgXx5UCmXuUJIibytjfxlfia7XJBX6ricaVuGpAREA9fm8mK7WwKXEzictLQRIicvrIgRCGtrwfsS9g/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Mingjie</span> <!----></div> <div class="_1H1Z49Dr_0">2019-02-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">InnoDB的crash-safe的功能，如果服务器突然掉电，那redo log内存中的执行记录还没来得及写到磁盘里，这部分操作不久丢失了吗？但MySQL一定不会让这种情况发生的，它是通过binlog日志找回的吗？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 如果你是设置的“双1模式”，“那redo log内存中的执行记录还没来得及写到磁盘里”就意味着事务还没提交，这时候事务回滚不算数据丢失。<br><br>具体可以看15篇和23篇哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/03/39/18956b2e.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Eureka</span> <!----></div> <div class="_1H1Z49Dr_0">2019-02-15</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">還是不太明白redo和binlog的區別， binlog 記錄的sql  和 redo記錄改動不是一個意思么？都可以通過這個來恢復數據呀，另外是不是還有個undo日誌，這個和redo的協作關係是怎樣的？能否請老師通過具體的日誌內容來講解一下~</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: undolog和redolog的协作关系，看一下08篇；<br>redolog 和 binlog恢复数据问题，看一下15篇^_^</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/31/d1/dc1f9b95.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Nero</span> <!----></div> <div class="_1H1Z49Dr_0">2019-02-14</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">有个疑问，更新语句应该是在分析器以后才能确定表名的吧。那它怎么在这之前去清空该表的缓存的呢？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 在之前是查缓存，执行语句以后才更新（失效）缓存</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/1e/a5/85b05303.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>金龙</span> <!----></div> <div class="_1H1Z49Dr_0">2019-02-14</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">为什么说MyISAM 没有 crash-safe 的能力，binlog不能用来恢复吗？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 实现上异常重启后，myisam就是放着不管的，会在你下次使用的时候提示 “表损坏，需要修复”<br><br>binlog不能崩溃恢复的原因，看下第15篇</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pv/uAA5BZG9iZQBkwAAAAAH/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgMDAwMDAwMDAwMBAQEBAQEBAgEBAgICAQICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA//AABEIAO4A7gMBEQACEQEDEQH/xACGAAEAAgIDAQEBAAAAAAAAAAAABwgBBgIDBQQJCgEBAAAAAAAAAAAAAAAAAAAAABAAAgIBAwIDBAYECgkFAAAAAAECAwQRBQYhEjFBB1FhIhNxgTIUFgiRQnIjUmKC0jNjJBWVVqGx0ZLCQ1Nzk9NEdCUXEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwD+wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADKTbSSbbeiS6tt+CS82wPXp49v+TFSx9j3jIi+qlTtmbbF/Q4USTA4ZGxb3iRc8rZt1xoLxlkbfl0xX0yspikB5QAAAAAAAAAAAAAAAAAAAAAAAAAAAAHfjY2RmX1YuJRbk5N81XTRTCVltk34RhCCcpMCcuNejrnCvL5Pkyq1SktswrI98df1cvL0lFP2xq1/b8gJj2vYdj2SEYbVteJidq7fm11ReRJaafvMqzvybX+1Jgev3v2IB3v2IDwd14xx3fYyW57TiXWTT/tMa1TlJvzjl0fLyF166OWntAg3mPpNn7ZjX7jxdX7zVUlZLaZuuO5KvuXzHi2/u6cxwhq1DSFktFFdzYEJY+ZRkuyEHKF1M5V5GNdCVOTj2wk4TrvosUbK5wmmnqvFAfUAAAAAAAAAAAAAAAAAAAAAAAAfZt+Bl7pmY+34FE8jLyrFVTVDxlJ6ttt6RhCEU5Sk9FGKbfRAWx4ZwjA4liRskq8reL60svOcde3XRyxsTuWtWNF+L6Ssa1l5RiG6Nt+IGAAAABlSa/2AQz6pelGNy+izfePqG3cvxYd8LqmseveIVx0WLmyXbFZPatKrn7oT1ho4BUPG5FkYWRbt2+41mPlYt1mNkSdTrtpuqm4WV5WPonGdc4tPtXivs+YG203VZFcbaLIW1y6xnXJSi/dqvNea8UB2AAAAAAAAAAAAAAAAAAAAAAWd9LeIw2bbI77m1L+890qUqFNfFibfPSdUIp9Y25einJ+Kj2rppLUJUbberAwAAAAAADKbTAq7+YT08rvxvx5tFCWRjqqjkNVUf6fGfbTjbm4x8bcZ9tVr661uMnooSbCpuFuGXt9nzMW6UNWu+H2qrEvKdb+GXTz8V5NAb5tvJ8TL7asvtxL3ou5v+zzf8Wb61v3S6e9gbOnr1XVPqmvMAAAAAAAAAAAAAAAAAAANu4NsH4i5JgYNkO/Eqk83PX6v3PGcZTrl7sixxq93eBcSWi0jFJRikkl0S06JJLokkBxAAAAAAAAAdWTi42fiZWBmVQyMTNx7sXJosWsLqL65VXVSXi42VzaYH5k8w47fxPk288fv7m9tzbKqbJLR34diV2DkPwSeRh2wm15N6Aa0B7W277nbdpCMvn46/8Ab2tuMV/VT6yqf0fD7gN/27esHcko1T+Xfp1x7dI2e/sf2bV9HXTxSA9cAAAAAAAAAAAAAAAAAsN6K7Yq8LeN5nH478ivb6ZNdVXj1xyL+32xsnfBP3wAmoAAAAAAAAAAyno0wKd/mZ2OOPvfH+QVQ0W54GRt2S4ro79tthbTOb8520Zvav4tXuArEAAym0002mmmmno011TTXVNMDadt5Rk43bVmqWVStErNV94gv2norv5Wj94G94mdi51fzcW6Nsencl0nBvysg9JQf0rr5AfWAAAAAAAAAAAAAABbf0yxljcI2ppaSyXm5M/e7M6+EH/4a4gbyAAAAAAAAAAAID/MhhRyOCYGWkvmYHIMKfd5qnIw87Hsj7lK2db/AJIFGwAAAB3UZF+LZG7HtnTZHwnB6P3p+UovzT1TA3bbeVwn21blHsl4LJri3B++2tauH0x1XuQG412V3QjZVOFlc1rGcJKUZL2qUW0wOYAAAAAAAAAAAAXG4Hp+DNg08PuMf0/Os1/0gbUAAAAAAAAAAAIZ9f8At/8AzTO18f7y2rt/a++L/h1AoKAAAAAAD78Hc8zbp92Na4xb1nVL4qbP2oN6a6ea0fvA37bOSYeb21X6YmQ+nbOX7mb/AKu16JN+yWj8lqBsYAAAAAAAAAAAtr6Y5SyeE7XFPWeLPNxbPPRwzbrYL3aU2xA3sAAAAAAAAAAAQD+ZHOjj8G27DUv3mfyDEXbr40YuFnXWS9/bb8tfWBR0AAAAAAAAB6UN2zo4duD8+Use2MYpSbcqlGcZ6VT1Uoxl26NdY6N9AJeAAAAAAAAAALB+iu6KeNvOyzl8Vdte5UR16uF0I4uS17FXKqr65gTaAAAAAAAAAAZS1aQFN/zL77HK3/YuP1TUo7Tt92dkqL6Ryd0shGFc1/DrxsKMl7Fb7wKzAAAAAAAAAAE4AAAAAAAAAAG1cK378OcjwNxnJrFc3i56Wr1w8nSFsml1l8iXbYl5uCAuQ3GSjZCUZQnFSjKLUoyTWqlGS6OMk9U/MDiAAAAAAAAA+fMzcXa8HM3POtjRh4GNfl5N0/s1UY9crbZv26Qi9Eur8APzI5XyDI5TyPeOQZKlGzc822+Fcn3OjGWlWJja9dVjYtcK0/PtA14AAAAAAAAAAnAAAAAAAAAAAAWW9KuXw3Pb48dz7V/eG3V6YMpvSWXgVr4YRb+1dhR+HTxdWj69smBLbTT0YGAAAAAAAZSbYFUvzCeotbh+AtnvUn3VX8jvqlqo9jjbi7SpJ9Zd6jbd7NIR1+2kFSwAAAAAAAAAABOAAAAAAAAAAAA+nDzMnb8qjNw7p4+VjWxuourekq7IPVNeKafg09U10aaYFrOE88weV48MXJlXib5TD9/it9sMlRXxZOF3PWcGlrKHWVfvWkmG+OLXj+nyAwAAAAOSi39HtAgb1Z9ZMPiVGTx/jl1eXyeyEqr74dtuPsanHSVlz6wt3JJ/BV1UH8VnRKEwo1ddbkW25F9tl199k7brrZystttsk52WWWTblOyc222222wOsAAAAAAAAAAATgAAAAAAAAAAAAHZVbbRbXdRZZTdVONlVtU5V2Vzi9YzhODUoSi1qmnqgJq4z6wZWLGvE5JjzzqopQW44qhHMjFdE8iiThTk6ecouEtPFSYEx7ZyzjG8QUsDecKU5afuLbli5Cb8njZPyrn1emqTWvmBsXZqk009f0ae1NagHFRTlKSikm234JJattvRJJAaHyD1O4HxmFj3HkODdkwT/sO32x3LNc1/y5Y+G7fkSl5O1wj7wKxc6/MHve+13bdxWi3j222KVc86U4y3rIrfTSFlTdO2qSfX5TnYvKxdUBXaUpTlKUpOUpNylKTblKTerlJvVttvqwMAAAAAAAAAAAABOAAAAAAAAAAAAAAAHCyuu2Eq7YQsrmtJQnFShJexxaaYGv5O2bpiwb2Hd9xwIrV/c6s/Kop9rVUq7Y9mvslqtfNAaPuObvVk5Ubrm7ldOPjXm5WTd9DSusnGUX5NapgeUAAAAAAAAAAAAAAAAnAAAAAAAAAAA27ZODcn39QswttsrxZ6NZuY/umK4v8AXhO3Sd8f+3GYEn7b6KVxUZ7zvj10XfTttMYJe3ty8vu7l9NKA3HF9MuD4iXzMG7Omv18rNypN/TDGnj0P/dA9mviPDKlpHj22NL/AKmJC5/pu72wO38M8Q/y1s/+F4X8wB+GeIf5a2f/AAvC/mAdF/EOEZKisjiew3qL1irdn2+ztb8XHuqemoHzfgT09/yVxv8AwPbf/RA+e7049N79VPh+xxT86cCvH/Q8f5bX1Aa1uHoZ6X7gn8rasna7Ja62bfuefBpvzVeZbmY0dPdDQCN97/LJTJTs41yeafX5eLvWNGyL9nduGAoOP1YzAgrk/pZzjiUbLt02S+3Br1cty21rcMFQXjZbZQnbi1++6FYEegAAAAAAAAAE4AAAAAAAAbXxnhu98pu0wKPlYcJ9t+45HdDEp85RjLRyvuS/Ugm1qtdF1AsPx70741xtQutpW7blFJvKza4TjCa6642I+6nHSa1TffYv4QG7TyZvpHSC93j+kDobberbb9rerAwAAAAAAAAAym09U2n7U9GB3wyZrpLSa9/j+kCLOZejfDOZxtyaMeOwb1NSktw2ymuuFtj692dt6cMbLTk9ZSj8u1vxn5AU55x6bcn4Hkdu7Yqv262xwxN4w+63b8hvVxhObip4uQ4r+jsUZPR9vclqBoAAAAAAAAE4AAAAAAAl/gfppbvKq3ffo2Y20vSzGxNZVZG4x8VOb6Tow5eTWk7F9nRaSYWFrWPh0VYeBTVjY1EFXVXTCNddcF4RrhFKMV/rA6wAAAAAAAAAAAAAAAGcirE3HFv2/c8ajNwsquVWRRk1Quptrl4wtqnGUZx+ro+oFOPVf0Sv41HI5FxSFuZx+PddmbfrK/L2eHjK2uTcrMvboecnrZVHrPuinNBXUAAAAAAE4AAAAABMfprwGO7ShyDeqf8A6qmbeFi2r4dwtrk07rU/tYVM1pp4WTWj+FNSCwltvfpCC7a49El0108Onkl5IDoAAAAAAAAAAAAAAAAAAHdVaopwmlKqSalFrVaPo+j6NNeKApz62eksOPTt5bxrH02LJtT3PApj8G0ZF0tI5GPGP2dtyLJadvhTY0l8EoqIVvAAAAACcAAAABunBeKWcr3mGPYpx23E7Mjcro6rSnu0hjQl5XZUouK81FSl17dALZNVUVVYeLXCnHx64VV11JRrhXXFRhVCMdFGEIpJIDpAAAAAAAAAAAAAAAAAAAABzdePl49+Bm015GJl1WY99F0VZVbTdB1202QknGVdkJNNPp1A/Pj1U4DdwHktuJVGyey7gp5myZE9ZN4/clbh2Tf2sjAnJQl5yg4TendogjMAAAATgAAAZScmoxTlKTSjFJttt6JJLq22BcDhnHo8V47jYsoRW4ZSWVuE/GX3q2K/da+cMSvSC8m035sD3wAAAAAAAAAAAAAAAAAAAAAAGlepvDoc74dm4FdcZbvgqW4bPZolP79j1yax+56aV59XdVLr2qUlJ/ZQH5yyjKEpRlFxlFuMoyTUoyT0cZJ6NNNdUBgAAAnAAAAkT0x2NbzynGsuh34m1Qe5Xpr4ZWUyjHErfk28mUZaPxjBgWivn32P2R+FfV4v62B0gAAAAAAAAAAAAAAAAAAAAAAO6ifZYvZL4X9fg/qYFC/XHiseNc7zbsetV7fv8FvWKorSELsic4bhStPhTjmwnNRWijCyKAh0AAAnAAAAst6PbasPjuduso6W7lmShXLT7WNgxdVfX/5Nluv0ASUAAAAAAAAAAAAAAAAAAAAAAAAAIJ/Mfsi3Dh+179CGt+yblGu2en2cLdIrHu1a8vvtOOlr06gUlAAAJwAAALk8UxFt/D+P4yWjlt2LfNeGlmXD77an71bcwPXAAAAAAAAAAAAAAAAAAAAAAAAAGreoe3Ld/Tzl2E4qTWzZuVXF9dbtugtyoS97vxo6e8D82AAACcAAAC8VKrW3bcqX3UrFx1VJJqMq1RX8tpNJrWHh0A4gAAAAAAAAAAAAAAAAAAAAAAAADrzVTLZ93jkSUMd7fmK+ck3GFLxbVbJpJtqMNW+gH5ZgAAH/2Q==" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>何小鸟</span> <!----></div> <div class="_1H1Z49Dr_0">2019-02-11</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">Red inno独有.不持久保存<br>bin持久存档<br>任何引擎可以使用</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/ec/fd/bad2abf5.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>帽子掉了</span> <!----></div> <div class="_1H1Z49Dr_0">2019-02-09</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师您好，我翻遍了答案，感觉您还是没有解释这个问题。<br>二阶段提交能够解决，binlog和redolog的一致性问题，这个是能够得到证明的。但是我的疑惑是，二阶段提交相对于之前的一个方案的优势在哪里？ 具体是先写redolog，再写binlog，然后通过判断binlog是否写完成了同一个事务，来决定redolog是否需要回滚。  <br>因为两阶段提交也要检查binlog和redolog的一致性来决定redolog是否回滚。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这样是担心如果binlog写不成功（比如磁盘满了），事务就来不及回滚了。<br><br>可以看下15篇哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e0/9c/1c4d12a6.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>阳光</span> <!----></div> <div class="_1H1Z49Dr_0">2019-02-08</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">mysql&gt; create table T(ID int primary key, c int);</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epjDxrsib6EUtKt6ROhrCNXlEQSoZQNlCG4mPjCGyvicibYbUlGrwiarMSTV3LNoE7IPtDf1NDZ4X2ib2g/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Geek_75b4cd</span> <!----></div> <div class="_1H1Z49Dr_0">2019-02-01</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redo log有什么用，binlog可以用来恢复数据</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 看一下第15和第23篇哈 </p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/be/d4/ff1c1319.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>金龟</span> <!----></div> <div class="_1H1Z49Dr_0">2019-02-01</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师我有个问题:<br>1.begin;<br>2.update talble set a=1 where id=1;//这一步产生redo log 的prepare阶段和binlog了<br>3...其他逻辑操作（比如java里面的判断语句等等）<br>4.commit;<br><br>按照我看评论的说法如果3之前mysql crash掉，再恢复会自动提交，这里应该会有问题吧，因为下面的操作有可能会抛异常回滚之类的</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不是这样，你看一下15篇，<br>实际上我们图中的两阶段，都是发生在你的 “4.commit;”这个动作里。</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/cb/50/66d0bd7f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>杰之7</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">可不可以叫您奇奇老师，😊,晚上的上一节的留言您让我发微博，这样可以更好帮我解答，我已经发了。<br><br>先回到您的问题，全量备份的周期，在什么场景下，一天一备会比一周更有优势。我觉得对于需要在更短时间内及时更新的数据一天一备更有优势。我想当发生crash之时，对于已经一天一备份的数据，可以立刻找到昨天到之后的所有数据，而一周就没有在这么快的时间上能够找到。<br><br>通过这一节的复习，老师这一节的内容通过恢复过去半个月的某时刻的数据的问题，给我们讲述了redo log与binlog,关键点是两阶段提交。通过反证法的例子给我们介绍了为什么要设计两阶段提交。<br><br>另外，这节还有一个实践性非常强的可做案例，通过binlog和全量备份扩容搭建备份的问题。我之后会先在网上查一些资料，有疑问，在微博上给您留言。<br><br></div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 👍 </p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/f8/85/3c072e6f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>这菜真香呀</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师好，两阶段提交的重点是不是应该是redo log bin log 的刷盘，而非写日志？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 额 都是重点，不过如果说耗时，确实是刷盘才是主要的耗时的点</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/96/4e/2acbc3a8.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>vvsuperman</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-26</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">能否拉出redo和bin在实际环境中一条记录的例子，还是有点绕，感觉是一样的</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 15篇和23篇看一下 😆</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/74/ea/10661bdc.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>kivensu</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-25</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">---更新操作<br>涉及redo log，binlog<br>redo log是InnoDB引擎 binlog是Server层实现<br>redo log是物理日志，binlog是逻辑日志<br>redo log循环写 binlog追加写<br>数据库恢复-有备份的情况下，首先恢复临时库，然后重放故障时刻的binlog日志！<br>理解俩阶段提交的重要性！！！<br>innodb_flush_log_at_trx_commit参数设置成1，表示每次事务的redo log日志直接持久化到磁盘<br>sync_binlog参数设置成1，表示每次事务的binlog持久化到磁盘<br></div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 👍</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pv/uAA5BZG9iZQBkwAAAAAH/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgMDAwMDAwMDAwMBAQEBAQEBAgEBAgICAQICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA//AABEIAO4A7gMBEQACEQEDEQH/xACGAAEAAgIDAQEBAAAAAAAAAAAABwgBBgIDBQQJCgEBAAAAAAAAAAAAAAAAAAAAABAAAgIBAwIDBAYECgkFAAAAAAECAwQRBQYhEjFBB1FhIhNxgTIUFgiRQnIjUmKC0jNjJBWVVqGx0ZLCQ1Nzk9NEdCUXEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwD+wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADKTbSSbbeiS6tt+CS82wPXp49v+TFSx9j3jIi+qlTtmbbF/Q4USTA4ZGxb3iRc8rZt1xoLxlkbfl0xX0yspikB5QAAAAAAAAAAAAAAAAAAAAAAAAAAAAHfjY2RmX1YuJRbk5N81XTRTCVltk34RhCCcpMCcuNejrnCvL5Pkyq1SktswrI98df1cvL0lFP2xq1/b8gJj2vYdj2SEYbVteJidq7fm11ReRJaafvMqzvybX+1Jgev3v2IB3v2IDwd14xx3fYyW57TiXWTT/tMa1TlJvzjl0fLyF166OWntAg3mPpNn7ZjX7jxdX7zVUlZLaZuuO5KvuXzHi2/u6cxwhq1DSFktFFdzYEJY+ZRkuyEHKF1M5V5GNdCVOTj2wk4TrvosUbK5wmmnqvFAfUAAAAAAAAAAAAAAAAAAAAAAAAfZt+Bl7pmY+34FE8jLyrFVTVDxlJ6ttt6RhCEU5Sk9FGKbfRAWx4ZwjA4liRskq8reL60svOcde3XRyxsTuWtWNF+L6Ssa1l5RiG6Nt+IGAAAABlSa/2AQz6pelGNy+izfePqG3cvxYd8LqmseveIVx0WLmyXbFZPatKrn7oT1ho4BUPG5FkYWRbt2+41mPlYt1mNkSdTrtpuqm4WV5WPonGdc4tPtXivs+YG203VZFcbaLIW1y6xnXJSi/dqvNea8UB2AAAAAAAAAAAAAAAAAAAAAAWd9LeIw2bbI77m1L+890qUqFNfFibfPSdUIp9Y25einJ+Kj2rppLUJUbberAwAAAAAADKbTAq7+YT08rvxvx5tFCWRjqqjkNVUf6fGfbTjbm4x8bcZ9tVr661uMnooSbCpuFuGXt9nzMW6UNWu+H2qrEvKdb+GXTz8V5NAb5tvJ8TL7asvtxL3ou5v+zzf8Wb61v3S6e9gbOnr1XVPqmvMAAAAAAAAAAAAAAAAAAANu4NsH4i5JgYNkO/Eqk83PX6v3PGcZTrl7sixxq93eBcSWi0jFJRikkl0S06JJLokkBxAAAAAAAAAdWTi42fiZWBmVQyMTNx7sXJosWsLqL65VXVSXi42VzaYH5k8w47fxPk288fv7m9tzbKqbJLR34diV2DkPwSeRh2wm15N6Aa0B7W277nbdpCMvn46/8Ab2tuMV/VT6yqf0fD7gN/27esHcko1T+Xfp1x7dI2e/sf2bV9HXTxSA9cAAAAAAAAAAAAAAAAAsN6K7Yq8LeN5nH478ivb6ZNdVXj1xyL+32xsnfBP3wAmoAAAAAAAAAAyno0wKd/mZ2OOPvfH+QVQ0W54GRt2S4ro79tthbTOb8520Zvav4tXuArEAAym0002mmmmno011TTXVNMDadt5Rk43bVmqWVStErNV94gv2norv5Wj94G94mdi51fzcW6Nsencl0nBvysg9JQf0rr5AfWAAAAAAAAAAAAAABbf0yxljcI2ppaSyXm5M/e7M6+EH/4a4gbyAAAAAAAAAAAID/MhhRyOCYGWkvmYHIMKfd5qnIw87Hsj7lK2db/AJIFGwAAAB3UZF+LZG7HtnTZHwnB6P3p+UovzT1TA3bbeVwn21blHsl4LJri3B++2tauH0x1XuQG412V3QjZVOFlc1rGcJKUZL2qUW0wOYAAAAAAAAAAAAXG4Hp+DNg08PuMf0/Os1/0gbUAAAAAAAAAAAIZ9f8At/8AzTO18f7y2rt/a++L/h1AoKAAAAAAD78Hc8zbp92Na4xb1nVL4qbP2oN6a6ea0fvA37bOSYeb21X6YmQ+nbOX7mb/AKu16JN+yWj8lqBsYAAAAAAAAAAAtr6Y5SyeE7XFPWeLPNxbPPRwzbrYL3aU2xA3sAAAAAAAAAAAQD+ZHOjj8G27DUv3mfyDEXbr40YuFnXWS9/bb8tfWBR0AAAAAAAAB6UN2zo4duD8+Use2MYpSbcqlGcZ6VT1Uoxl26NdY6N9AJeAAAAAAAAAALB+iu6KeNvOyzl8Vdte5UR16uF0I4uS17FXKqr65gTaAAAAAAAAAAZS1aQFN/zL77HK3/YuP1TUo7Tt92dkqL6Ryd0shGFc1/DrxsKMl7Fb7wKzAAAAAAAAAAE4AAAAAAAAAAG1cK378OcjwNxnJrFc3i56Wr1w8nSFsml1l8iXbYl5uCAuQ3GSjZCUZQnFSjKLUoyTWqlGS6OMk9U/MDiAAAAAAAAA+fMzcXa8HM3POtjRh4GNfl5N0/s1UY9crbZv26Qi9Eur8APzI5XyDI5TyPeOQZKlGzc822+Fcn3OjGWlWJja9dVjYtcK0/PtA14AAAAAAAAAAnAAAAAAAAAAAAWW9KuXw3Pb48dz7V/eG3V6YMpvSWXgVr4YRb+1dhR+HTxdWj69smBLbTT0YGAAAAAAAZSbYFUvzCeotbh+AtnvUn3VX8jvqlqo9jjbi7SpJ9Zd6jbd7NIR1+2kFSwAAAAAAAAAABOAAAAAAAAAAAA+nDzMnb8qjNw7p4+VjWxuourekq7IPVNeKafg09U10aaYFrOE88weV48MXJlXib5TD9/it9sMlRXxZOF3PWcGlrKHWVfvWkmG+OLXj+nyAwAAAAOSi39HtAgb1Z9ZMPiVGTx/jl1eXyeyEqr74dtuPsanHSVlz6wt3JJ/BV1UH8VnRKEwo1ddbkW25F9tl199k7brrZystttsk52WWWTblOyc222222wOsAAAAAAAAAAATgAAAAAAAAAAAAHZVbbRbXdRZZTdVONlVtU5V2Vzi9YzhODUoSi1qmnqgJq4z6wZWLGvE5JjzzqopQW44qhHMjFdE8iiThTk6ecouEtPFSYEx7ZyzjG8QUsDecKU5afuLbli5Cb8njZPyrn1emqTWvmBsXZqk009f0ae1NagHFRTlKSikm234JJattvRJJAaHyD1O4HxmFj3HkODdkwT/sO32x3LNc1/y5Y+G7fkSl5O1wj7wKxc6/MHve+13bdxWi3j222KVc86U4y3rIrfTSFlTdO2qSfX5TnYvKxdUBXaUpTlKUpOUpNylKTblKTerlJvVttvqwMAAAAAAAAAAAABOAAAAAAAAAAAAAAAHCyuu2Eq7YQsrmtJQnFShJexxaaYGv5O2bpiwb2Hd9xwIrV/c6s/Kop9rVUq7Y9mvslqtfNAaPuObvVk5Ubrm7ldOPjXm5WTd9DSusnGUX5NapgeUAAAAAAAAAAAAAAAAnAAAAAAAAAAA27ZODcn39QswttsrxZ6NZuY/umK4v8AXhO3Sd8f+3GYEn7b6KVxUZ7zvj10XfTttMYJe3ty8vu7l9NKA3HF9MuD4iXzMG7Omv18rNypN/TDGnj0P/dA9mviPDKlpHj22NL/AKmJC5/pu72wO38M8Q/y1s/+F4X8wB+GeIf5a2f/AAvC/mAdF/EOEZKisjiew3qL1irdn2+ztb8XHuqemoHzfgT09/yVxv8AwPbf/RA+e7049N79VPh+xxT86cCvH/Q8f5bX1Aa1uHoZ6X7gn8rasna7Ja62bfuefBpvzVeZbmY0dPdDQCN97/LJTJTs41yeafX5eLvWNGyL9nduGAoOP1YzAgrk/pZzjiUbLt02S+3Br1cty21rcMFQXjZbZQnbi1++6FYEegAAAAAAAAAE4AAAAAAAAbXxnhu98pu0wKPlYcJ9t+45HdDEp85RjLRyvuS/Ugm1qtdF1AsPx70741xtQutpW7blFJvKza4TjCa6642I+6nHSa1TffYv4QG7TyZvpHSC93j+kDobberbb9rerAwAAAAAAAAAym09U2n7U9GB3wyZrpLSa9/j+kCLOZejfDOZxtyaMeOwb1NSktw2ymuuFtj692dt6cMbLTk9ZSj8u1vxn5AU55x6bcn4Hkdu7Yqv262xwxN4w+63b8hvVxhObip4uQ4r+jsUZPR9vclqBoAAAAAAAAE4AAAAAAAl/gfppbvKq3ffo2Y20vSzGxNZVZG4x8VOb6Tow5eTWk7F9nRaSYWFrWPh0VYeBTVjY1EFXVXTCNddcF4RrhFKMV/rA6wAAAAAAAAAAAAAAAGcirE3HFv2/c8ajNwsquVWRRk1Quptrl4wtqnGUZx+ro+oFOPVf0Sv41HI5FxSFuZx+PddmbfrK/L2eHjK2uTcrMvboecnrZVHrPuinNBXUAAAAAAE4AAAAABMfprwGO7ShyDeqf8A6qmbeFi2r4dwtrk07rU/tYVM1pp4WTWj+FNSCwltvfpCC7a49El0108Onkl5IDoAAAAAAAAAAAAAAAAAAHdVaopwmlKqSalFrVaPo+j6NNeKApz62eksOPTt5bxrH02LJtT3PApj8G0ZF0tI5GPGP2dtyLJadvhTY0l8EoqIVvAAAAACcAAAABunBeKWcr3mGPYpx23E7Mjcro6rSnu0hjQl5XZUouK81FSl17dALZNVUVVYeLXCnHx64VV11JRrhXXFRhVCMdFGEIpJIDpAAAAAAAAAAAAAAAAAAAABzdePl49+Bm015GJl1WY99F0VZVbTdB1202QknGVdkJNNPp1A/Pj1U4DdwHktuJVGyey7gp5myZE9ZN4/clbh2Tf2sjAnJQl5yg4TendogjMAAAATgAAAZScmoxTlKTSjFJttt6JJLq22BcDhnHo8V47jYsoRW4ZSWVuE/GX3q2K/da+cMSvSC8m035sD3wAAAAAAAAAAAAAAAAAAAAAAGlepvDoc74dm4FdcZbvgqW4bPZolP79j1yax+56aV59XdVLr2qUlJ/ZQH5yyjKEpRlFxlFuMoyTUoyT0cZJ6NNNdUBgAAAnAAAAkT0x2NbzynGsuh34m1Qe5Xpr4ZWUyjHErfk28mUZaPxjBgWivn32P2R+FfV4v62B0gAAAAAAAAAAAAAAAAAAAAAAO6ifZYvZL4X9fg/qYFC/XHiseNc7zbsetV7fv8FvWKorSELsic4bhStPhTjmwnNRWijCyKAh0AAAnAAAAst6PbasPjuduso6W7lmShXLT7WNgxdVfX/5Nluv0ASUAAAAAAAAAAAAAAAAAAAAAAAAAIJ/Mfsi3Dh+179CGt+yblGu2en2cLdIrHu1a8vvtOOlr06gUlAAAJwAAALk8UxFt/D+P4yWjlt2LfNeGlmXD77an71bcwPXAAAAAAAAAAAAAAAAAAAAAAAAAGreoe3Ld/Tzl2E4qTWzZuVXF9dbtugtyoS97vxo6e8D82AAACcAAAC8VKrW3bcqX3UrFx1VJJqMq1RX8tpNJrWHh0A4gAAAAAAAAAAAAAAAAAAAAAAAADrzVTLZ93jkSUMd7fmK+ck3GFLxbVbJpJtqMNW+gH5ZgAAH/2Q==" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>summer_7196</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-24</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">两阶段提交是原子性的吧？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不是，如果保证原子性，就不用两阶段啦</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>summer_7196</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-24</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">binlog设计成逻辑是怕生成的日志过大吗？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不是😆</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/0e/6c/3f179ea8.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>翟毅</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-24</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师您好，innodb_flush_log_at_trx_commit 设置 1，并且sync_binlog也设置为1，就表示redo log和bin log都是同步刷盘的，而库的数据先写内存，后写磁盘。库的数据保存在内存是安全，因为log中有全量数据可以恢复，请问库的数据何时刷盘，是依赖操作系统的pdflush还是mysql主动调用刷盘的系统调用？这是第一个疑问。第二个疑问是既然binlog中有全量的备份，为什么还需要redo log的，感觉关闭redolog也ok的吧，也没有两阶段提交的问题了？请老师答疑解惑~~</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: “请问库的数据何时刷盘” ----两种情况，redo log在推进checkpoint的时候，和脏页被淘汰出内存的时候；<br><br>第二个问题看第15篇哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/0e/6c/3f179ea8.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>翟毅</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-24</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师您好，请问日志写刷盘跟修改库的数据这两者什么关系。也就是粉板的数据什么时候算总账，在没算账之前如何能查到最新的值？希望老师答疑解惑~</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 内存里是正确的值，直接从内存读走就行；<br>日志和数据的关系，是日志记录了数据从状态1到状态2的过程<br><br>这个过程持久化了，状态1也是已经持久化到磁盘的，那么状态2就可以不着急一定要写到磁盘。<br>这个是WAL机制的逻辑😆</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/1a/66/2d9db9ed.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>苦行僧</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">一天一备 还是一周一备 取决于业务需求 数据实时要求高的 比如金额的增减就要求一天一备</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 对的，恢复的时间需求</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/96/84/43f24eec.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>黑白尤文</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-22</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">感觉redolog类似于redis持久化里的aof，binlog类似于redis里的rdb。</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/56/8c/a8317e23.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>磊</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-22</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师您好，看到后面的文章越来越吃力，所以想回来再精细的看一遍，有个疑问，翻出了很多留言也没有找到有人问这个问题：<br>文章中写到：write pos 和 checkpoint 之前是“粉板”上还空着的部分，我的疑问是 checkpoint到write pos 这块内容的大小是如何定的，是不是一直是固定的大小？<br></div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 好问题，不是固定的大小哦<br><br>整个文件系统空间是固定大小的（根据系统配置）<br><br>write pos是“当前写入的位置”；<br>checkpoint是“已经将更新持久化到数据的位置”<br><br>所以如果系统TPS短时间内增大，这两个距离就会增大；<br>反之如果系统空闲的时候，这两个距离就会减小。<br><br>看到文章吃力也可以先跳过，可能之后的一篇就没那么难了。总之有问题随时发出来哈。<br><br>当然回头复习是好习惯，给你点赞👍</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/15/32/0a/f9b44e11.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Fj_yyyy...</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-22</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师, 我是一个初学者, 我有些不太理解为何要用redo.log, 前面举的那个记账的例子我可以理解, 但是binlog只是记录变化, 不是应该就是不停的写下去吗, 就不像是账本需要找到人, 然后对应的计入这个人的账目.....所以我觉得binlog就是那个粉板了...因为我是初学者, 所以可能很多基础知识有缺失, 老师直接指出搜索哪些相关知识可以帮助我理解这个问题也可以, 我可以自己去看</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: redo log和binlog其实都是粉板的概念，<br>只是redo log是专门给innodb用的，而且在MySQL的实现里面，是用redo log来达到“崩溃恢复”这个作用的。<br><br>binlog一直的定位是“归档日志”</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI01GCG9MdMibbI3ykWu9zicMTTaE06bGzGRrb0MKDZaSAmcAmOUNysBaBYB1CB2atURtzbcHrdreqg/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>颜海航</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-21</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师 可以讲讲undo log吗</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 08篇有涉及到一点，你看下哦<br></p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>二马</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">您说“redo log 可以是4组文件，每个文件大小1G”，从大并发update性能方面考虑，这个文件大小及几组一般怎样配置比较合适?</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复:  我觉得如果是1T以上的磁盘&amp;不小于64G的内存，都可以按照4*1G来配置redo log</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/31/b8/b1e0356d.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>傅萌</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，redo log处在commit状态就是已经在check point了吗</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 没有，checkpoint是后台线程追上来的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/b2/5a/574f5bb0.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Lukia</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">文中的redo log其实是redo+undo log吧，因为记录更新前和更新后的值都记录了的</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这里主要还是讲“数据更新逻辑”哈， undo log是有的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/0a/dd/88fa7b52.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>spark</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">您好老师,下面这段话是不是矛盾了,希望老师帮忙解答下<br>既然redo log 本身就配置了一组4个文件,每个文件的大小是 1GB，那么这块“粉板”总共就可以记录 4GB 的操作,这个时候不是持久化到磁盘吗?<br>为什么还要设置<br>innodb_flush_log_at_trx_commit 这个参数设置成 1 的时候，表示每次事务的 redo log 都直接持久化到磁盘.</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 是这样的，<br>innodb_flush_log_at_trx_commit =1 的时候，才是确保redo log里的数据是持久化到磁盘的；<br><br>如果是innodb_flush_log_at_trx_commit=2， 其实只是“写到redo log文件，但是没有持久化(fsync)”</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/62/10/c1b4770d.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>球魁</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师你好，按照上面所讲我觉得redo有点多余了，binlog 日志可以恢复某个点之前的操作，并且在异常重试的时候只有binlog 和redo共同存在的时候才会进行commit ，我用binlog也可以恢复数据，所以redo是不是多余了呢</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 看一下15篇哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/a0/fe/ac5a62f3.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>grey</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-15</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师你好，复习这篇文章的时候有几个新的问题，还请老师解答：<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. 如果更新语句涉及到索引，索引是什么时候被更新的，是否跟数据一样，先更新内存，然后再持久化到磁盘？<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. 如果事务失败，回滚的时候，是否也会写redo log和binlog。回滚涉及到索引的更新话，索引如何回滚的呢？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 1. 索引也是数据的一部分哈，一样的策略<br>2. 会写redolog，打上回滚标签，binlog就直接丢弃啦。回滚都是把没用的内存版本删掉</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/10/d9/acc787a6.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>李大飞</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-15</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">落下了很多，正在不断学习。现在在公司直接利用每天午休的2小时来学习，感觉很充实，丁奇大大的文章很到位，评论区也很到位，常有高手出没，感谢丁奇大大和你们！感谢！</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 👍🤝</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/68/a7/abb7bfe3.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>聪</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-15</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师有个问题，WAL可以保证之前提交的记录不会丢失。所以是不是只能是checkpoint过的记录不会丢失呢？那没有checkpoint过的数据但是已经write到redo log里的，在数据库发生问题了，应该都丢失了吧。如果发生这样的问题，如何恢复呢？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不会呀，崩溃恢复的时候，会从checkpoint开始往后主动去刷数据的，没有checkpoint过的并不会丢失，只是崩溃恢复的时候花点时间</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/38/c8/dfc7a25b.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>readyao</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-13</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，任何事务如果在回滚的时候系统异常重启了或者回滚操作失败了， 那是不是就导致数据状态可能不一致？ 这样情况会发生吗？ 如果发生了怎么避免？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 没问题的<br><br>回滚中系统异常重启，重启后会继续回滚😆<br><br>是通过扫描redo log状态来发现的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/38/c8/dfc7a25b.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>readyao</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-13</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师你好，我想问一下，如果最后一步commit提交的时候MySQL异常重启了，那怎么办？ 那此时redo log还处于prepare的状态，但是binlog已经写入了。这样是不是就也不一致了？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不会，你看下15篇，有说明哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/f3/89/fcfecb46.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>我爱学习</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-12</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，有个地方不明白想请教下：为什么binlog不具备craahsafe功能呢</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 看下15篇哈</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erFY9H3mxyTpZ9gxAmdeKic565hicicDZmv7cjswd8hdernmxib0chdQrlDNKUZQ8AticQCgDdgVEmJNuA/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>changshan</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-09</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师好，【update 语句执行流程】这张图的update更新流程是不是有点问题啊，既然是WAL了，为什么是将这一行的c值加1，写入新行，然后才是写入redo log呢？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: WAL是指在“数据真正写入对应的磁盘数据页“ 之前写日志</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/85/88/9b2973fc.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>jzyu</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-09</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">关于两阶段提交有个问题想请教一下。写redo log处于prepare阶段后，如果写binlog失败是会回滚redo log的记录吗？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不用回滚日志，只需要打上“rollback”标签</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/e6/98/289484e2.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>TM_01</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-08</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，innodb的update数据，是何时刷入磁盘的，也是和redo log buffer在commit阶段写入通过fsync延迟写入的机制一样嘛</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 没看懂你的意思， “innodb的update数据” 是什么意思，是update语句，还是“引擎更新数据”这个动作</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/6a/07/96c1e57f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>大牙</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-05</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，还是对 redo log 的内容和 bin log的内容有些疑惑，假设redo log 和 bin log 都想记录“把c 从 0改成了1” 这个操作，那么redo log 就是 记录“把c 从 0改成了1”，bin log 记录的是实际的sql 语句：“update table set c = 1 where ... ” 或者记录 具体修改的行之前的值和更改之后的值。<br><br>我认为上述记录的内容很类似啊，一个系统crash之后，假设两个log 都可以用来恢复，我可以用bin log来恢复吗？如果不能，是哪里不能呢？ <br><br>谢谢老师</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 看一下15篇，有提到这个问题😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/a5/ff/884d865e.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Geek_89bbab</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-05</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">引用@高枕的留言<br>1 prepare阶段 2 写binlog 3 commit<br>当在2之前崩溃时<br>重启恢复：后发现没有commit，回滚。备份恢复：没有binlog 。<br>一致<br>当在3之前崩溃<br>重启恢复：虽没有commit，但满足prepare和binlog完整，所以重启后会自动commit。备份：有binlog. 一致<br>—————<br>在3之前崩溃后，重启是如何判断prepare的redo log 已经记录了相应的binlog日志记录的？难道是redolog里面有一个事务id，binlog也有回应的事务id，通过在binlog中查询是否包含有对应事务id的binlog吗？求老师指点迷津</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 哈哈你猜对啦 👍🏿<br><br>看一下15篇</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/1f/2e/27d8b06d.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>蓝天</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-03</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请教下老师：关于先写redo log再写binlog的分析有些不理解。假设redo log写完后binlog还没写完，这时数据库出现意外宕机，修改数据的物理记录虽然记录到redo log，但是事务还没提交，我理解未提交意味着数据没有最终落盘，您说的c=1是因为innodb的崩溃恢复机制能把未提交的事务恢复到提交状态么？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 如果redo没落盘，那会回滚的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/b0/37/d654fbac.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>几近虚年</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-03</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">看了2遍稍微看懂了一些，理论性的知识点还是要多看几遍才行...<br>工作1年多的，之前只知道增删查改的sql语句，跟着老师学习，感觉发现了新大陆一样，学起来也感觉新奇，有意思。<br>跟着老师学完看能进步多少，嘿嘿嘿</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 一起加油</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/06/cf/ef0da49a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>三木圈圈</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-03</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">一天一备和一周一备的场景有一个因素，就是取决于服务器硬件的配置，比如redo log的容量，如果一天一备在容量小的情况下就安全些，如果一周一备，需要更大的配置。当然一天一备从另一个维度看，需要对服务器另一方面的花销，就是这个频率的备份IO的花销比一周一备更大。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 👍🏿</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/2a/76/315cccab.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>低调</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-03</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">这个binlog和主从的binlog是一个概念么？这个binlog不是可以关闭么，那两阶段提交也就没有意义了吧，懵了~</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 是同一个binlog😄<br><br>你看一下15篇，有说到你提的这个问题</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/03/15/293a185d.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>JRich</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-03</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，binlog和redolog的那两个参数都设置为1的话，每次事务结束之后立马持久化到磁盘会不会影响性能。</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 会，你明天看下今晚会发的23篇，有说到😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/8d/b4/ff82483d.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>邵俊达</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-03</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请问，当目前改动只写入了 redo log 还没有写入磁盘的时候，这时有一条查询语录会发生什么？不会不一致么？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 08篇看一下😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/d3/b3/4f5550c0.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>大宝</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-02</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师 能不能问一下binlog为什么不能保证crash safe</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 看下15篇</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/c7/99/6403695d.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>强哥</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-01</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">喜欢孔乙己这个例子，说明read log很清楚</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 🤝</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoqjK62ZEuj3220ZAAqLBIgiayGn2MfvSOJb1uPz2TmwibSfxKURFj68ITdn6K0EK6MRW1llJBSzLJg/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>just4cn</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-01</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">接前一个问题<br>原问题：更新数据的过程是在确保数据能成功更新的情况下就写binlog，然后事务才提交commit，通过binlog来同步数据，当接收到binlog后还需要获取其它数据进行计算，此时立刻去读数据库会发现读不到刚更新的数据。<br>您的回复：做好区分，对延迟敏感的请求，需要去主库上查询。<br>------<br>感谢老师的回复，之前表达的不完善。这里就是接收到主库发出的binlog后，立刻去主库查询数据，有时查不到此条binlog对应的更新内容，当sleep 0.5s(或更久)再去获取便能取到正确的数据，初步怀疑是binlog发送时主库的事务尚未commit导致的，不知道有没有什么好的解决方法。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 确实有可能，binlog确实先发了，你还有这种场景啊，<br><br>比较少见到这种方案哈，我现在能想起来的就是轮询了。<br>当然还有可以去查解析出binlog里面的线程id 和时间戳，然后去查select  * from information_schema.innodb_trx where trx_mysql_thread_id=$tid and trx_started &lt; $timestamp;<br>必须返回空才行，本质上还是轮询就是了…<br><br>不过，<br>都拿到binlog了，看看能不能考虑设置成row格式，直接解析更更好些；<br><br></p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eoqjK62ZEuj3220ZAAqLBIgiayGn2MfvSOJb1uPz2TmwibSfxKURFj68ITdn6K0EK6MRW1llJBSzLJg/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>just4cn</span> <!----></div> <div class="_1H1Z49Dr_0">2019-01-01</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，问个困扰较久的问题：目前更新数据的过程是在确保数据能更新成功的情况下就写binlog了，然后事务才提交commit，如果通过binlog来同步数据，当接收到binlog后还需要获取其它数据进行计算，此时立刻去读数据库的会发现有时候读不到刚更新的这条数据，这个有没有什么办法避免？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这个是读写分离常见的问题…只能做好区分，对延迟敏感的请求，需要到主库上去查</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/d1/4f/c52f9f6d.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>陈星</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-29</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师您好，如果redo log和bin log都已经提交，但是，没有写入到磁盘中的时候，突然发生重启，那么此时，进来的查询请求，会得到及时的响应吗？。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 重启过程中连接都连不了<br><br>你是说重启之后吗？崩溃恢复完成后开始提供服务</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/23/98/bd96932f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>xm</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-28</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">Mysql redo、undo、bin、relay log这几个日志都晕了，老师会将下这几个日志的么？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 会，往后看哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/f9/86/ba830df4.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>小叶</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-28</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">接上一个问题。<br>写内存的时候查询到的数据是不是最新的数据？如果写入内存成功，redolog，binlog失败了，会不会造成读到这个非法数据呢？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不会，事务没提交呢，MVCC会让别的线程看不到这个内存的修改的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/f9/86/ba830df4.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>小叶</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-28</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师你好，有个问题<br>写入新行、新行更新到内存、写入redolog写入binlog。这4个操作应该是原子性的吧？<br>这边的写内存，写redolog，写binlog是怎么保证原子性的呢？<br><br><br>还有提个建议，文中图的字体有点过于难分辨了。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 只是逻辑上原子，实现上不会加这么大一个锁哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/be/d4/ff1c1319.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>金龟</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-28</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">binlog的写入时机，应该是在事务提交的时候一次性写入的吧，老师</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 对的</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKqDeE8vfUhETcZibFiacSgn863AIqNSGHGgvb1flfLGfOJcQjZomEeh9ibM3WFjWDia5eVMrRDKnUbOg/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>paul</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请老师回答下，前面一个同学的问题，我也想到这个问题。 问题如下：<br><br>“ 老师，您好。您说MySQL 使用WAL，先写日志再写磁盘。请教一个问题，<br><br>执行一条Update 语句后，马上又执行一条 select * from table limit 10。<br><br>如果刚刚update的记录，还没持久化到磁盘中，而偏偏这个时候的查询条件，又包含了刚刚update的记录。<br><br>那么这个时候，是从日志中获取刚刚update的最新结果，还是说，先把日志中的记录先写磁盘，再返回最新结果？“</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 都不是，直接从内存读走，内存里可是有修改的最新的结果哦</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/4d/0d/63d5a1f8.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>tailender</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">update 执行过程的图里 写入新行深色 是代表已经写入磁盘了吗？ 不是先写redo log，大小满了才写磁盘吗</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这里说的是commit阶段哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/14/b1/7d974f0a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>黄明恩</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-26</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师好，redo log是innodb特有的，那么其他存储引擎有这个机制或者类似思路吗？要不然其他引擎的更新性能和crash safe能力都没保证吗？<br><br>还有就是顺序写和随机写在SSD硬盘开启差别很大吗</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/7a/68/f2bc8fcb.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Hyun</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-26</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">如果没有或者禁用 binlog， 我觉得效率会更高一些。不知道 MySQL 后期是不是会调整。2 段式提交，理论上是用于分布式环境的，用在单机 OLTP 里面，是不是贵了点？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/1d/30/4a82c7af.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>fancion</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-26</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">1、其实这个地方不只是有redo，应该还有一个undo日志吧，用于保障未提交事务不会对数据库的ACID特性产生影响<br>2、Binlog模式除了statement和row，是不是还有混合模式</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/6b/c6/2534e14a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>spraith</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-26</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">我觉得也可以这样理解：redolog和binlog可以看成是数据日志的两种不同存储方式（在短时间内），所以它们必须是一致的才行，不然它们本质上就不相同了。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 是的哦😄</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pv/uAA5BZG9iZQBkwAAAAAH/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgMDAwMDAwMDAwMBAQEBAQEBAgEBAgICAQICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA//AABEIAO4A7gMBEQACEQEDEQH/xACGAAEAAgIDAQEBAAAAAAAAAAAABwgBBgIDBQQJCgEBAAAAAAAAAAAAAAAAAAAAABAAAgIBAwIDBAYECgkFAAAAAAECAwQRBQYhEjFBB1FhIhNxgTIUFgiRQnIjUmKC0jNjJBWVVqGx0ZLCQ1Nzk9NEdCUXEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwD+wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADKTbSSbbeiS6tt+CS82wPXp49v+TFSx9j3jIi+qlTtmbbF/Q4USTA4ZGxb3iRc8rZt1xoLxlkbfl0xX0yspikB5QAAAAAAAAAAAAAAAAAAAAAAAAAAAAHfjY2RmX1YuJRbk5N81XTRTCVltk34RhCCcpMCcuNejrnCvL5Pkyq1SktswrI98df1cvL0lFP2xq1/b8gJj2vYdj2SEYbVteJidq7fm11ReRJaafvMqzvybX+1Jgev3v2IB3v2IDwd14xx3fYyW57TiXWTT/tMa1TlJvzjl0fLyF166OWntAg3mPpNn7ZjX7jxdX7zVUlZLaZuuO5KvuXzHi2/u6cxwhq1DSFktFFdzYEJY+ZRkuyEHKF1M5V5GNdCVOTj2wk4TrvosUbK5wmmnqvFAfUAAAAAAAAAAAAAAAAAAAAAAAAfZt+Bl7pmY+34FE8jLyrFVTVDxlJ6ttt6RhCEU5Sk9FGKbfRAWx4ZwjA4liRskq8reL60svOcde3XRyxsTuWtWNF+L6Ssa1l5RiG6Nt+IGAAAABlSa/2AQz6pelGNy+izfePqG3cvxYd8LqmseveIVx0WLmyXbFZPatKrn7oT1ho4BUPG5FkYWRbt2+41mPlYt1mNkSdTrtpuqm4WV5WPonGdc4tPtXivs+YG203VZFcbaLIW1y6xnXJSi/dqvNea8UB2AAAAAAAAAAAAAAAAAAAAAAWd9LeIw2bbI77m1L+890qUqFNfFibfPSdUIp9Y25einJ+Kj2rppLUJUbberAwAAAAAADKbTAq7+YT08rvxvx5tFCWRjqqjkNVUf6fGfbTjbm4x8bcZ9tVr661uMnooSbCpuFuGXt9nzMW6UNWu+H2qrEvKdb+GXTz8V5NAb5tvJ8TL7asvtxL3ou5v+zzf8Wb61v3S6e9gbOnr1XVPqmvMAAAAAAAAAAAAAAAAAAANu4NsH4i5JgYNkO/Eqk83PX6v3PGcZTrl7sixxq93eBcSWi0jFJRikkl0S06JJLokkBxAAAAAAAAAdWTi42fiZWBmVQyMTNx7sXJosWsLqL65VXVSXi42VzaYH5k8w47fxPk288fv7m9tzbKqbJLR34diV2DkPwSeRh2wm15N6Aa0B7W277nbdpCMvn46/8Ab2tuMV/VT6yqf0fD7gN/27esHcko1T+Xfp1x7dI2e/sf2bV9HXTxSA9cAAAAAAAAAAAAAAAAAsN6K7Yq8LeN5nH478ivb6ZNdVXj1xyL+32xsnfBP3wAmoAAAAAAAAAAyno0wKd/mZ2OOPvfH+QVQ0W54GRt2S4ro79tthbTOb8520Zvav4tXuArEAAym0002mmmmno011TTXVNMDadt5Rk43bVmqWVStErNV94gv2norv5Wj94G94mdi51fzcW6Nsencl0nBvysg9JQf0rr5AfWAAAAAAAAAAAAAABbf0yxljcI2ppaSyXm5M/e7M6+EH/4a4gbyAAAAAAAAAAAID/MhhRyOCYGWkvmYHIMKfd5qnIw87Hsj7lK2db/AJIFGwAAAB3UZF+LZG7HtnTZHwnB6P3p+UovzT1TA3bbeVwn21blHsl4LJri3B++2tauH0x1XuQG412V3QjZVOFlc1rGcJKUZL2qUW0wOYAAAAAAAAAAAAXG4Hp+DNg08PuMf0/Os1/0gbUAAAAAAAAAAAIZ9f8At/8AzTO18f7y2rt/a++L/h1AoKAAAAAAD78Hc8zbp92Na4xb1nVL4qbP2oN6a6ea0fvA37bOSYeb21X6YmQ+nbOX7mb/AKu16JN+yWj8lqBsYAAAAAAAAAAAtr6Y5SyeE7XFPWeLPNxbPPRwzbrYL3aU2xA3sAAAAAAAAAAAQD+ZHOjj8G27DUv3mfyDEXbr40YuFnXWS9/bb8tfWBR0AAAAAAAAB6UN2zo4duD8+Use2MYpSbcqlGcZ6VT1Uoxl26NdY6N9AJeAAAAAAAAAALB+iu6KeNvOyzl8Vdte5UR16uF0I4uS17FXKqr65gTaAAAAAAAAAAZS1aQFN/zL77HK3/YuP1TUo7Tt92dkqL6Ryd0shGFc1/DrxsKMl7Fb7wKzAAAAAAAAAAE4AAAAAAAAAAG1cK378OcjwNxnJrFc3i56Wr1w8nSFsml1l8iXbYl5uCAuQ3GSjZCUZQnFSjKLUoyTWqlGS6OMk9U/MDiAAAAAAAAA+fMzcXa8HM3POtjRh4GNfl5N0/s1UY9crbZv26Qi9Eur8APzI5XyDI5TyPeOQZKlGzc822+Fcn3OjGWlWJja9dVjYtcK0/PtA14AAAAAAAAAAnAAAAAAAAAAAAWW9KuXw3Pb48dz7V/eG3V6YMpvSWXgVr4YRb+1dhR+HTxdWj69smBLbTT0YGAAAAAAAZSbYFUvzCeotbh+AtnvUn3VX8jvqlqo9jjbi7SpJ9Zd6jbd7NIR1+2kFSwAAAAAAAAAABOAAAAAAAAAAAA+nDzMnb8qjNw7p4+VjWxuourekq7IPVNeKafg09U10aaYFrOE88weV48MXJlXib5TD9/it9sMlRXxZOF3PWcGlrKHWVfvWkmG+OLXj+nyAwAAAAOSi39HtAgb1Z9ZMPiVGTx/jl1eXyeyEqr74dtuPsanHSVlz6wt3JJ/BV1UH8VnRKEwo1ddbkW25F9tl199k7brrZystttsk52WWWTblOyc222222wOsAAAAAAAAAAATgAAAAAAAAAAAAHZVbbRbXdRZZTdVONlVtU5V2Vzi9YzhODUoSi1qmnqgJq4z6wZWLGvE5JjzzqopQW44qhHMjFdE8iiThTk6ecouEtPFSYEx7ZyzjG8QUsDecKU5afuLbli5Cb8njZPyrn1emqTWvmBsXZqk009f0ae1NagHFRTlKSikm234JJattvRJJAaHyD1O4HxmFj3HkODdkwT/sO32x3LNc1/y5Y+G7fkSl5O1wj7wKxc6/MHve+13bdxWi3j222KVc86U4y3rIrfTSFlTdO2qSfX5TnYvKxdUBXaUpTlKUpOUpNylKTblKTerlJvVttvqwMAAAAAAAAAAAABOAAAAAAAAAAAAAAAHCyuu2Eq7YQsrmtJQnFShJexxaaYGv5O2bpiwb2Hd9xwIrV/c6s/Kop9rVUq7Y9mvslqtfNAaPuObvVk5Ubrm7ldOPjXm5WTd9DSusnGUX5NapgeUAAAAAAAAAAAAAAAAnAAAAAAAAAAA27ZODcn39QswttsrxZ6NZuY/umK4v8AXhO3Sd8f+3GYEn7b6KVxUZ7zvj10XfTttMYJe3ty8vu7l9NKA3HF9MuD4iXzMG7Omv18rNypN/TDGnj0P/dA9mviPDKlpHj22NL/AKmJC5/pu72wO38M8Q/y1s/+F4X8wB+GeIf5a2f/AAvC/mAdF/EOEZKisjiew3qL1irdn2+ztb8XHuqemoHzfgT09/yVxv8AwPbf/RA+e7049N79VPh+xxT86cCvH/Q8f5bX1Aa1uHoZ6X7gn8rasna7Ja62bfuefBpvzVeZbmY0dPdDQCN97/LJTJTs41yeafX5eLvWNGyL9nduGAoOP1YzAgrk/pZzjiUbLt02S+3Br1cty21rcMFQXjZbZQnbi1++6FYEegAAAAAAAAAE4AAAAAAAAbXxnhu98pu0wKPlYcJ9t+45HdDEp85RjLRyvuS/Ugm1qtdF1AsPx70741xtQutpW7blFJvKza4TjCa6642I+6nHSa1TffYv4QG7TyZvpHSC93j+kDobberbb9rerAwAAAAAAAAAym09U2n7U9GB3wyZrpLSa9/j+kCLOZejfDOZxtyaMeOwb1NSktw2ymuuFtj692dt6cMbLTk9ZSj8u1vxn5AU55x6bcn4Hkdu7Yqv262xwxN4w+63b8hvVxhObip4uQ4r+jsUZPR9vclqBoAAAAAAAAE4AAAAAAAl/gfppbvKq3ffo2Y20vSzGxNZVZG4x8VOb6Tow5eTWk7F9nRaSYWFrWPh0VYeBTVjY1EFXVXTCNddcF4RrhFKMV/rA6wAAAAAAAAAAAAAAAGcirE3HFv2/c8ajNwsquVWRRk1Quptrl4wtqnGUZx+ro+oFOPVf0Sv41HI5FxSFuZx+PddmbfrK/L2eHjK2uTcrMvboecnrZVHrPuinNBXUAAAAAAE4AAAAABMfprwGO7ShyDeqf8A6qmbeFi2r4dwtrk07rU/tYVM1pp4WTWj+FNSCwltvfpCC7a49El0108Onkl5IDoAAAAAAAAAAAAAAAAAAHdVaopwmlKqSalFrVaPo+j6NNeKApz62eksOPTt5bxrH02LJtT3PApj8G0ZF0tI5GPGP2dtyLJadvhTY0l8EoqIVvAAAAACcAAAABunBeKWcr3mGPYpx23E7Mjcro6rSnu0hjQl5XZUouK81FSl17dALZNVUVVYeLXCnHx64VV11JRrhXXFRhVCMdFGEIpJIDpAAAAAAAAAAAAAAAAAAAABzdePl49+Bm015GJl1WY99F0VZVbTdB1202QknGVdkJNNPp1A/Pj1U4DdwHktuJVGyey7gp5myZE9ZN4/clbh2Tf2sjAnJQl5yg4TendogjMAAAATgAAAZScmoxTlKTSjFJttt6JJLq22BcDhnHo8V47jYsoRW4ZSWVuE/GX3q2K/da+cMSvSC8m035sD3wAAAAAAAAAAAAAAAAAAAAAAGlepvDoc74dm4FdcZbvgqW4bPZolP79j1yax+56aV59XdVLr2qUlJ/ZQH5yyjKEpRlFxlFuMoyTUoyT0cZJ6NNNdUBgAAAnAAAAkT0x2NbzynGsuh34m1Qe5Xpr4ZWUyjHErfk28mUZaPxjBgWivn32P2R+FfV4v62B0gAAAAAAAAAAAAAAAAAAAAAAO6ifZYvZL4X9fg/qYFC/XHiseNc7zbsetV7fv8FvWKorSELsic4bhStPhTjmwnNRWijCyKAh0AAAnAAAAst6PbasPjuduso6W7lmShXLT7WNgxdVfX/5Nluv0ASUAAAAAAAAAAAAAAAAAAAAAAAAAIJ/Mfsi3Dh+179CGt+yblGu2en2cLdIrHu1a8vvtOOlr06gUlAAAJwAAALk8UxFt/D+P4yWjlt2LfNeGlmXD77an71bcwPXAAAAAAAAAAAAAAAAAAAAAAAAAGreoe3Ld/Tzl2E4qTWzZuVXF9dbtugtyoS97vxo6e8D82AAACcAAAC8VKrW3bcqX3UrFx1VJJqMq1RX8tpNJrWHh0A4gAAAAAAAAAAAAAAAAAAAAAAAADrzVTLZ93jkSUMd7fmK+ck3GFLxbVbJpJtqMNW+gH5ZgAAH/2Q==" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>坏淡一个</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-25</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">如果有一个备份库的时间点，最接近误删除的时间点，但这个备份库的时间比误删除的晚，能不能用binlog倒过来回溯？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: binlog都保留了、并且是row格式、并且误删操作是“delete” 才行</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>坏淡一个</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-24</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">执行器将值+1后，调用引擎接口，写入这行新数据，然后“引擎将新数据更新到内存中”，也就是说新数据是缓存在内存中的？在redo log把数据写入磁盘前，查询的都是内存中的数据？是不是等redo log把新数据实际写入磁盘后，这些缓存数据才会失效？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>坏淡一个</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-24</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">用了两阶段提交，如果redo log处于prepare状态，然后binlog写入完成，这时，在把redo log改为commit状态的过程中出问题崩溃重启了，这种情况会怎么办？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 看下15篇</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/a6/43/cb6ab349.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>%E6%9D%8E...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redo log记录了数据页做了什么变动，他会在适当的时候刷盘。而我们查询是从磁盘查出来的，如何保证我们读到的数据是更新后的数据呢？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/43/38/72feb2e0.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>哇！怎么这么...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师您好，有个问题需要请教您，我发现ibdata0文件无限膨胀并且不分裂初ibdata1文件，具体会是什么原因导致，有没什么有效的方式解决</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 就是回滚段导致的。<br>Ibdata不会帮你自动生成ibdata1,<br>会变大是因为有事务没提交，导致别的事务更新的回滚段不能回收，最终把文件撑大。<br>查一下数据库里的长事务，kill掉。不过这样只能避免继续膨胀，现有的空间不能回收了，<br><br>实在要回收只能靠把数据逻辑导入另外一个干净的库…</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/0c/c2/310f15a4.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Geek_zy</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">又一个疑问如果把redolog的innodb_flush_log_at_trx_commit设置为1<br>不就相当于每一次都要提交到磁盘，就用不到他的记录到小黑板上的功能（先都写到日志，找一个合适的时间记录到磁盘），不是把他的优势给弄丢了吗？<br></div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 没丢，顺序写比随机写的成本低</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/a4/97/83e63e00.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>张锋</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">在一个表上有更新的时候，跟这个表有关的查询缓存会失效，所以这条语句就会把表 T 上所有缓存结果都清空。<br><br><br>如果做了主从，把所有的读操作都指到从库上进行，主库update表，从库同步更新表数据，这个时候从库会不会有清空查询缓存的操作？<br><br></div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 会，数据同步到从库其实也是在从库做更新，相同逻辑</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/ae/01/12818bab.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Geek_4de7b1</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请问一下执行最后commit，innodb的commit具体是做了哪些操作呀？移动checkpoint指针吗？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不是，<br>Redolog上打上commit 标签，写盘</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/6a/2d/ec4ed8ce.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>shawn</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，对于WAL我还有两个疑问如下：<br>1. 比如WAL 有两个记录（update amount = amount +1 where id = 2,  update amount = amount +1 where id = 200000 ）,虽然wal文件是顺序性的，但是数据库中id =2 ,id = 200000记录可能相差很远，这种寻址速度（寻找数据库中记录）应该也不会很快。不过wal到数据库文件操作是异步后台操作，不影响效率对么？<br><br>&nbsp;2.另外根据前面事物隔离级别，一条记录只要写入WAL且WAL 持久化到磁盘，就算事物的原子性和持久性保证了对么。 至于WAL数据什么时候更新到数据库文件里不用管对么？<br><br>期待老师的解答，谢谢！</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 两个理解都对</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/50/99/44378317.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>李皮皮皮皮皮</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师你好，看完这篇我有几个疑问：<br>1.如果不设置立即刷到磁盘标志，redo log和binlog应该是放在内存中的吧，它们应该是写到两个不同的文件中的，会不会出现部分写的问题呢？<br>2.prepare-写binlog-commit这个过程中，如果异常重启了。怎么根据binlog找到对应的redo log或者反过来。难道有一个全局唯一id？<br>3.如果在上面写binlog阶段崩溃了，binlog未写入成功。恢复程序会撤销prepare状态的redo log。redo log和最终磁盘中的数据更新是不是只会存在一个？删redo log和写磁盘会不会出现不一致，比如中间又异常重启了</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/50/99/44378317.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>李皮皮皮皮皮</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师你好，看完这篇我有几个疑问：<br>1.如果不设置立即刷到磁盘标志，redo log和binlog应该先在内存中的吧。它们应该是写到两个不同的文件，会不会存在部分写的问题<br>2.prepare-写binlog-commit这个过程中，如果有异常重启。回复程序怎么根据binlog查找redo log或者反过来呢？其实可以有连续执行几个相同的sql语句。难道有一个唯一的id关联吗？<br>3.redo log是最终硬盘中数据更新是不是只能存在一个？比如一次更新，要么更新到最终数据了，要么有一条redo log。不能两者都有。如果只能有一个，那么紧跟着更新后面的针对这个更新的字段查询怎么处理？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/12/03/c657c350.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>MichaelChen</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">使用show [session|global] status可以查看统计各种SQL执行数以及MySQL各种状态，不写中间的global，默认参数为session，只查询当前链接中的参数，所以我们一般加上global，查询MySQL从上一次启动至今的数据统计，例如：show global status like 'Com_select%'用来查询MySQL执行select 的次数</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/bc/fc/cf98963a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>张伟益</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">我有两个问题<br>1.redo.log你说记录的是“做了什么改动”，这个以怎样的形式来显明改动的内容？<br>2.既然binlog记录了sql，那不是可以通过sql来回复数据吗，它为什么不支持crash safe呢不太理解</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/77/fd/c6619535.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>XD</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">执行器先找引擎取 ID=2 这一行。ID 是主键，引擎直接用树搜索找到这一行。如果 ID=2 这一行所在的数据页本来就在内存中，就直接返回给执行器；否则，需要先从磁盘读入内存，然后再返回。<br><br>执行器拿到引擎给的行数据，把这个值加上 1，比如原来是 N，现在就是 N+1，得到新的一行数据，再调用引擎接口写入这行新数据。<br><br>-----<br><br>老师，这里有个疑问。执行器为什么不直接调用引擎的更新接口而非要先获取这条数据呢？<br>假如满足条件的数据很多，有1000条，innodb也会全部返回给执行器、执行器一条条记录去修改完、然后再调用写入接口一条条的去更新吗？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/87/dd/4f53f95d.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>进阶的码农</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">innodb_flush_log_at_trx_commit 和 sync_binlog 都设置成1，那么都是每个事务结束直接写磁盘，那是不是就浪费了WAL的作用，这样每一次的更新操作都需要写进磁盘，然后磁盘也要找到对应的那条记录，然后再更新，整个过程 IO 成本、查找成本都很高。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这个是为了保证数据安全必须的成本，但是WAL还是有用的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/f7/0a/067537fc.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>别皱眉</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，您好。我是一个小白<br>这里有个问题 希望您看看 谢谢😃<br>执行器先找引擎取 ID=2 这一行。ID 是主键，引擎直接用树搜索找到这一行。如果 ID=2 这一行所在的数据页本来就在内存中，就直接返回给执行器；否则，需要先从磁盘读入内存，然后再返回。<br><br>上篇文章中您说到<br>执行器调用InnoDB引擎取这个表的第一行，然后返回给执行器，由执行器判断ID是不是我们想要的值，在留言娶里您回答同学的问题说这个判断动作是由执行器发出的<br>但是这里怎么是InnoDB判断了呢<br><br></div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/f8/e9/f16a536b.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>极客-绝影</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-14</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">回答问题<br>老师好，个人认为备份周期没有统一或者固定标准与规范，合适才是最好的，那么我认为合适有三个主要的考虑指标，分别是业务场景，数据重要性和数据量的多少。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 对的👍🏿</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/32/0b/981b4e93.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>念你如昔</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-13</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">仔细考虑了一下两阶段提交的异常情况：（请老师看看有没有问题）<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;因为是采用的redolog来做崩溃后恢复的，所以在检测到有redolog处于prepare状态时，他应该会扫描binlog读取xid，将此xid与prepare事务链表中的xid做比较，如果存在，则前滚；如果不存在，则回滚。<br></div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/32/0b/981b4e93.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>念你如昔</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-12</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，两阶段提交中，如果redo log prepare之后，出现意外情况，事务会回滚。我有个疑问，如果服务器挂了的情况，比如说断电等情况，那么此时事务还会回滚吗</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/f4/d6/0ff4ebe5.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>雨中漫步</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-12</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">有个疑问，据之前的理解，应该是commit完成后才会写入binlog到binlog cache。看您说的update过程是先落盘binlog再commit。假设这样的话，在主从复制中，在主库事务未提交的情况下，binlog就已经被同步到从库了。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不是哦，我们说的都是“提交过程”哦。<br><br>在事务“执行计期间”，binlog 没有写盘，如你所说，这时候在binlog cache,没往备库发的<br><br></p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/55/f7/af3feb56.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>itczl</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-12</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，如果在执行器提交commit时挂了咋么办</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 要看阶段。<br><br>第15篇会说</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/cd/9b/451d8c08.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>patient</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-12</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redolog使用两阶段提交，会不会出现一种情况：redolog完成了prepare, 并且binlol也成功了，在redolog 进行commit时失败？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/b4/57/95c14e47.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>吾道</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-12</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">买了很多课程，感觉就这个讲得最容易弄懂😂</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/71/7f/4eba4781.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>木小易</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-11</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，您好，最近生产环境遇到一个问题，show full processlist中抓到一个update语句，根据主键更新的，时间是30s，state为updating，但是slow log中没有记录，我知道slow log中只会记录执行时间&gt;long_query_time的查询，不包括lock_time。我的问题是updating过程中做了哪些事情，是有加锁的动作吗？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 那看来就是被行锁锁住了…</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/59/68/b1b5e8bb.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>刘常青</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-11</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，数据库在卡的情况，在插入数据的时候会出现重复数据，这个原理是啥?是写入binlog日志在提交事务处于commit状态一直处于等待状态，出现的数据重复吗？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不是，应该是你们业务超时重试导致的吧…</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/df/0e/4e2b06d5.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>流浪在寂寞古...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-11</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">没有太理解为什么redo分为两段就可以保证一致，可以举个例子吗？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 第15篇答疑会说哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/09/8e/2ff2823e.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>howhigh</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-10</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，我有一个疑问，如果临时账本数据是写在内存里的，那计算机宕机后，内存数据岂不是没有了，那为啥具备crash_safe的能力？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/13/35/b6328a05.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>如余</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-10</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">丁奇老师，问一下为什么redo log 中第四个文件不写内容，具体承载着什么作用</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 没有不写呀，都要写的</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/e02A8tGW0yw86v11TrfaydPegHRDMyq4OL1iauZia7MVV9ibSNANibibVZTjP1GviacnNWhEzHvJuXUX09bdTiaGraUOQ/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>pain</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-09</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redo log 跟 bin log 都是针对事务吧？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epLbHgQhI0pFNI9iblcKdXqI8F5Fc4fTW0OR78oPdT8rsdq6kIicLhjAUO8atSTIpYk66X1dv08RFcw/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>TimiPai</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-09</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，您好，我在网上有看到一个innodb_log_buffer， 好像是介于内存和redo log之间的一个缓冲区，不知道这个该怎么理解呢？或者说它的优势在哪？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 嗯好几个评论说到，在答疑篇说这个哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/e6/26/de4f01e7.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Genius  ...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-09</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，二阶段提交，是写完binlog就会返回给程序执行成功么？还是必须redo commit才会给程序成功？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/a3/40/e0df3b84.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>力挽狂澜爆炸...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-08</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">为什么不能用binlog的数据进行crash恢复呢？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 15篇会说哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/18/d0/49b06424.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>qinggeouye</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-08</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redo log 记录物理日志（做了什么改动），事物的提交在 redo log 里完成，bin log 记录逻辑日志（执行语句SQL的原始逻辑、记录更新前后的内容）；<br><br>「两阶段提交」那块，先写入 redo log 处于 prepare 状态，再写 bin log，最后 redo log 提交事物处于 commit 状态。<br><br>有个疑问：<br>如果在最后 redo log 提交事物这一步，数据库发生了 crash 导致没有提交成功，但由于 bin log 里已经记录了逻辑日志，数据恢复的时候仍然从 bin log 取出逻辑SQL来恢复数据吗？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTL17yp3TmdQNXWELQvjIA2azwZ6ib7Riae9Hcf2YFl1uvnvocQoicTOtJLnvjUPtpbYhSng7DtPR9lfg/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>wvalianty</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-08</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，请教一个问题，两段式提交，如果redolog  prepare和binlog都成功了，最后commit失败了，会怎样？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/e6/26/de4f01e7.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Genius  ...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-08</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，问个问题，redo log不是先写redo log buffer,然后再写到redo log磁盘文件么？  看您说的好像没有写到refo log buffer 这个过程啊。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这个问题15篇会说哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e8/5c/561caff2.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>陈</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-07</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">如果值相同有判断不写binlog那么按逻辑，数据应该也不会在内存中改，从而减少写磁盘，从而不会写redo log,至于怎么判断就要去看write pos是否有改变，可以通过一个大量的更新相同值语句来测试，这是我想到的方法，不知老师是否有其他方法？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 你是不是要回复11讲的，回复到02来了😓</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/cd/aa/33d48789.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>卫江</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-07</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">我想问一下，update最后一步，既修改对应redo日志的状态为commit，这个时候，系统crash，会出现什么情况</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 重启后，崩溃恢复过程中提交该事务</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/04/b8/3fd2f448.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>lucky star</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-07</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">建议老师把redo日志和binlog日志两阶段提交那里说仔细一点，比如说： <br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1，binlog是有固定格式的，是可以检查出来写binlog的时候有没有出错（可以解疑写binlog时出错了恢复的时候怎么知道binlog数据是否正确的问题）；<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2， binlog和redo日志是有事物ID对应的（可以解疑如果刚好写完redo第一阶段， 还没开始写binlog，然后挂掉了， 这时候binlog是格式正确的， 恢复的时候是怎么确定binlog数据不缺失的问题）；<br>这都是我带着疑问从评论里找到的答案！ 如果在原文中写上会给读者省掉很多时间去找答案<br></div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 嗯，其实每个同学疑问的点可能都不一样，没法全部展开。答疑篇和评论区其实就是扩展正文的</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaEJjTz6oOKAXefgCNHTuTmwibBPJX9a4c407GHYmFPdMRgX67nZiavj2KhbiczicaaeSGxOxiaibnqH7icnVw/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>broken_open</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-06</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">1 prepare阶段 2 写binlog 3 commit<br>当在2之前崩溃时<br>重启恢复：后发现没有commit，回滚。备份恢复：没有binlog 。<br>一致<br>当在3之前崩溃<br>重启恢复：虽没有commit，但满足prepare和binlog完整，所以重启后会自动commit。备份：有binlog. 一致</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/ed/d2/e3ae7ddd.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>三木禾</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-06</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">还有如果二阶段操作，在binlog写入磁盘之后，MySQL崩溃了，事物还未提交，此时redolog的状态还是prepared，如何处理?<br>还有如果二阶段操作，在binlog未写入磁盘，MySQL崩溃了，事物还未提交，此时redolog的状态还是prepared，如何处理?<br></div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/ed/d2/e3ae7ddd.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>三木禾</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-06</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">然后，从备份的时间点开始，将备份的 binlog 依次取出来，重放到中午误删表之前的那个时刻。<br>这，这段话不太理解，重放，将binlog取出来</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/ed/d2/e3ae7ddd.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>三木禾</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-06</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">貌似不太理解数据页的概念，希望下次讲解一下数据库是如何组织数据的，谢谢老师</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/5b/53/200fda62.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>vivien_zh</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-06</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">一周一备 需要保证在恢复的时间点之内的所有binlog日志必须没有损坏<br>一日一备 则需要更多的存储空间，而且恢复的速度也会快很多</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/5b/53/200fda62.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>vivien_zh</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-06</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">感谢老师 细致的说清楚了redo log 和binlog的区别，更主要的是具体的解释了数据库异常crash后，通过备份+日志恢复中间的差异。</div>  <!----></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELZPnUAiajaR5C25EDLWeJURggyiaOP5GGPe2qlwpQcm5e3ybib8OsP4tvddFDLVRSNNGL5I3SFPJHsA/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>null</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-06</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">谢谢老师回复。<br>老师经常半夜回复留言，上次有一条是凌晨 2 点多回复，老师辛苦了！！<br><br>---<br><br>疑问一：<br>老师您回复：WAL机制里面有“已经提交但是还没落盘”的数据，binlog恢复不了这些。<br>这是因为一开始 binlog 就是设计为归档日志，因此恢复不了“已经提交但是还没落盘”的数据么？<br>从图“update 语句执行流程”来看，提交前已经写 binlog 日志了，即使没落盘，这部分数据仍然是未丢失的。<br><br>疑问二：<br>文章的例子：某天下午两点发现中午十二点有一次误删表，需要找回数据<br>最近一次全量备份文件 + 重放到误删表之前那一时刻，这样十二点到两点的数据是不是丢失了，恢复不了了？<br><br>谢谢老师，晚安！</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 1. 但是binlog并不知道他们没有落盘，这个是引擎内部机制。不会去重新执行。<br><br>2. 对… 一般是这样，恢复出一个临时库是误删前的。然后把里面的数据按需取出来放到线上的库里</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/06/f5/0f1adaf3.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>戴</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-05</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请问答疑的文章在哪里看呢</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 第十五篇😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e8/5c/561caff2.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>陈</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-05</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，今天遇到一个问题，当对一个表T中的字段t1做两次更新，update T set t1=2 where id=125;<br>update T set t1=2 where id=125;两次更新的值都相同， binlog只会记录一次日志，如果T表中的t1值原来就等于2，则Binlog不会记录日志。从原理中得知这个操作是没有导致行改变，因此不记录日志，Mysql源码更新操作是否有新值和原值的判读逻辑？<br></div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 有判断，相同就不写binlog了。<br><br>不过你这个问题可以衍生一个好问题，我问你一下，你怎么判断，这时候innodb里面改了(执行了修改动作，只是值不变），还是没改（直接跳过）？</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/ee/0d/892eb1bb.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>清凉薄荷糖</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-05</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">具体来说，当有一条记录需要更新的时候，InnoDB 引擎就会先把记录写到 redo log（粉板）里面，并更新内存，这个时候更新就算完成了。同时，InnoDB 引擎会在适当的时候，将这个操作记录更新到磁盘里面，而这个更新往往是在系统比较空闲的时候做，这就像打烊以后掌柜做的事。<br>老师，这一段里提到的将这个操作疾苦更新到磁盘里，是从redo log刷新过去还是直接从buffer pool呢？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: Buffer pool中</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/f3/f6/55f8364f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>股海旗舰</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-04</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">高枕同学提到的，有点疑问，烦请老师解答：<br>1 prepare阶段 2 写binlog 3 commit<br>..........<br>当在3之前崩溃<br>重启恢复：虽没有commit，但满足prepare和binlog完整，所以重启后会自动commit。备份：有binlog. 一致<br><br>疑问：虽没有commit，但满足prepare和binlog完整，所以重启后会自动commit。<br>--这里的binlog完整，通过什么方式或机制来判断？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 每个事务的binlog日志都有标准的结尾的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/f3/f6/55f8364f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>股海旗舰</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-04</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">1、写入redolog prepare<br>2、写binlog<br>3、提交事务(commit)<br>如果2执行完，在执行3之前宕机，这时候，binlog已经写完了，如果使用binlog做备份恢复，那么恢复的库和实际的库的数据(MySQL重启后会将事务回滚？)应该是不一致吧。<br>如果数据一致，那不是第3步都不需要了？<br>我记得以前看过文档，要处理这种情况，需要将参数 innodb_support_xa设置为1来确保数据同步。</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/e5/e8/033bdbf5.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>王灯武</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-04</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">两阶段提交那个地方用了反证法，个人认为并不一定用了两阶段提交就一定可靠，写入redolog--&gt;写binlog--&gt;提交事务处于commit状态，这个是3步，可能在写完binlog后直接服务器断电，碰到过从库的binlog比主库还超前的状况（可能是binlog已通过网络传给从库，但是主库断电数据没落盘），大神可以解释下这种场景，谢谢！</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这就是为什么MySQL 在崩溃恢复的时候，会在主库提交这个事务</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/cb/50/66d0bd7f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>杰之7</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-04</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">通过本节的学习熟悉了更新语句除了有查询语句的执行流程，还增加了两个日志，redolog和binlog。老师，我有一点疑问，文章写到redolog是物理日志，记录在某个数据页做了什么修改，binlog是逻辑日志，是原始逻辑。我是否可以这样理解，redolog是增加新的内容，binlog是对表中已有数据做改动。回到老师的问题，一天一备份与一周一在什么指标上更有优势，我的理解是在优化指标上更有优势，备份时间越长，之后查询建立索引上就需要花更多的时间，所以对优化指标有影响，请老师回复我的问题疑问，感谢与老师一同进步。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: Redolog和binlog都是记录数据的改动，前者是针对数据页，后者是记录修改逻辑（这一行要怎么改）</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAibnPX9jW8kqLcIfibjic8GbkQkEUYyFKJkc39hZhibVlNrqwTjdLozkqibI2IwACd5YzofYickNxFnZg/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Sinyo</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-04</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，您有提到以下两点，不知道是不是有点矛盾呢？第一点提到redolog能持久化到磁盘，第二点提到不能持久保存。<br><br>1. redo log 用于保证 crash-safe 能力。innodb_flush_log_at_trx_commit这个参数设置成 1 的时候，表示每次事务的 redo log 都直接持久化到磁盘。这个参数我建议你设置成 1，这样可以保证MySQL 异常重启之后数据不丢失；<br>2. binlog还不能去掉。<br>一个原因是，redolog只有InnoDB有，别的引擎没有。<br>另一个原因是，redolog是循环写的，不持久保存，binlog的“归档”这个功能，redolog是不具备的。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不能持久保存，是因为redolog是循环写的，这样没矛盾呀</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e8/c7/aba1275d.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>……</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-04</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，有一点我有点想不通。两阶段提交的第一阶段，将变更的记录写入redo日志，这个阶段是写到了log buffer还是 log file？binlog也是一样。<br>在第二阶段提交，binlog和redo是这个时候进行刷盘，还是目前已经完成刷盘，二阶段提交确保两者已经刷盘的情况下才会真正意义上完成commit,否则进行rollback。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 1. 到了提交阶段，就是把logbuffer写入redolog duke<br><br>2. 第二阶段，其实就是binlog和redolog最终提交的阶段</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/dc/fa/3975f8da.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>王先统</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-04</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">看了下留言，大家普遍对两阶段提交中的三个步骤再打散怎么保持一致有疑问，请老师再补充一下呢</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: “再打散”是啥意思</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/dc/fa/3975f8da.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>王先统</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-04</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">问一个两阶段提交的问题: 如果最后写完binlog，但是没有commit redolog，这个时候redolog处于prepare的状态，岂不是也不一致了？或者说，我只prepare了redolog系统就挂了， binlog都没写呢，又怎样呢？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 1. 系统重启后会提交这个事务<br><br>2. 系统重启后会回滚这个事务</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>疾风狂草</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-03</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">是否可以理解为：write pos是redolog记录的位置，而check point就是purge了的位置。如果是的话，redolog的末尾就是write pos，而check point 需要真实记录，并且落盘，才可以保证crash safe，那么他的机制是怎样的呢？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 前面对的，“Checkpoint需要真实记录”开始没看懂你的意思</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/c7/a1/6e500f6b.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>可凡不凡</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-03</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">Redo log不是记录数据页“更新之后的状态”，而是记录这个页 “做了什么改动”。 <br>redo log 不是记录的更新后的状态吗</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/c7/a1/6e500f6b.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>可凡不凡</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-03</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">感觉老是应该把redo log 和 undo log 放一起说说 有点迷糊了</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 看08篇哈，那里有</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/da/bb/a20f37b2.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>湘江鸿</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-03</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请教下，如果是redo log处于prepare状态，执行器写完了binlog，然后在提交事务给存储引擎的时候，存储引擎这边操作成功了，但是返回给执行器的时候宕机了，这样两边状态就不一致了吧？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这样不算，这样得应用程序自己check</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/PiajxSqBRaELtOO0HKrj5SI5JSlmwiaCvaF6GLiaTmf5NX88OZaO3HymTAGTeIoicBUjqzmMF6sF5raPFjuqLFibrrw/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>gesanri</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-02</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">看完文章我觉得可以只用binlog，不用redo log，没明白为什么binlog没有crash safe的能力?它不也是存文件吗？异常重启也可以通过它恢复啊，仅仅是因为binlog可以被关闭?那我不关它是不是就可以不用redo log了</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不只的，这个问题很多同学问，答疑文章来说哈</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTK1V6BNbTzjPMFPXQLia7jGpKiczxASA2ooAy1tcTkVzbF4upxMZLTxj6GoIlJibudSrJUBCgB0pj9bA/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>飞飞走走</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-02</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，我想问下，装库的时候，redo 应该设置成几个文件，以及每个文件的大小怎么设置的，应该从哪些方面去考虑呢</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 主要看你预设多大的TPS，现在SSD机器+32G 以上内存，建议设置4个1G</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/ce/c6/664ddb78.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>sugar</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-02</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师您好，看到prepare-commit两阶段提交这里，想请问一下：如果系统运行到prepare阶段时断电，于是 这一次修改还未commit，那么下一次系统重启后会将此次中间态的redolog继续落到binlog中，还是将此条redolog回滚掉呢？重启后 Innodb是否会检查redolog与当前磁盘上物理存储的数据做diff呢？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/bd/ed/95e8a314.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>过去、今日</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-02</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">两阶段提交<br>1、prepare 2、写入binlog 3、commit<br>如果到2后，系统奔溃，binlog没写入，事务回滚<br>如果到3后，系统奔溃，binlog写入，事务自动提交<br>那有个疑问在这过程中，事务回滚和提交mysql是怎么判断的？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 只好靠恢复后，应用程序自己来查数据验证</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/6f/63/8808cc00.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>扬～</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-02</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">只设计使用binlog不行吗，对于里面的操作也分2阶段，这样崩溃时，也能根据记录最近的状态来判断是否回滚提交</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/02/84/add96944.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>顺流逆流</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-01</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">我感觉binlog也可以保证crash-safe能力吧？因为如果binlog记录数据库所有执行更新语句，那么可以通过更新语句恢复数据库的状态吧？还有如果我只有binlog感觉就很安全了，为什么还需要redo log？我一直不太理解</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/33/af/dda311cf.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>TiTi</span> <!----></div> <div class="_1H1Z49Dr_0">2018-12-01</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">对于"redo log 用于保证 crash-safe 能力"这个描述，如果在写redo log的时候发生异常(比如断电)，那重启后该条更新是不是失败了？但是在这种情况下redo log、binlog和磁盘上的数据文件里都没有该条更新的记录，从数据一致性角度来看，整个MySQL系统是“安全”的。更新失败的事务可以通知客户端重新提交。不知道我这样理解对不对？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这时候崩溃恢复肯定是要回滚了<br><br>但是确没办法再“通知客户端”了，因为之前连接就已经断开了。<br><br>只能靠客户端发起新连接去查数据确认</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/13/7d/1454db9c.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>还来得及</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-30</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">把评论看完才能理解的很透彻，嗯～～～</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 评论区是个好地方， 不怕无限展开，越用心看的人奖励越多😄</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pv/uAA5BZG9iZQBkwAAAAAH/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgMDAwMDAwMDAwMBAQEBAQEBAgEBAgICAQICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA//AABEIAO4A7gMBEQACEQEDEQH/xACGAAEAAgIDAQEBAAAAAAAAAAAABwgBBgIDBQQJCgEBAAAAAAAAAAAAAAAAAAAAABAAAgIBAwIDBAYECgkFAAAAAAECAwQRBQYhEjFBB1FhIhNxgTIUFgiRQnIjUmKC0jNjJBWVVqGx0ZLCQ1Nzk9NEdCUXEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwD+wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADKTbSSbbeiS6tt+CS82wPXp49v+TFSx9j3jIi+qlTtmbbF/Q4USTA4ZGxb3iRc8rZt1xoLxlkbfl0xX0yspikB5QAAAAAAAAAAAAAAAAAAAAAAAAAAAAHfjY2RmX1YuJRbk5N81XTRTCVltk34RhCCcpMCcuNejrnCvL5Pkyq1SktswrI98df1cvL0lFP2xq1/b8gJj2vYdj2SEYbVteJidq7fm11ReRJaafvMqzvybX+1Jgev3v2IB3v2IDwd14xx3fYyW57TiXWTT/tMa1TlJvzjl0fLyF166OWntAg3mPpNn7ZjX7jxdX7zVUlZLaZuuO5KvuXzHi2/u6cxwhq1DSFktFFdzYEJY+ZRkuyEHKF1M5V5GNdCVOTj2wk4TrvosUbK5wmmnqvFAfUAAAAAAAAAAAAAAAAAAAAAAAAfZt+Bl7pmY+34FE8jLyrFVTVDxlJ6ttt6RhCEU5Sk9FGKbfRAWx4ZwjA4liRskq8reL60svOcde3XRyxsTuWtWNF+L6Ssa1l5RiG6Nt+IGAAAABlSa/2AQz6pelGNy+izfePqG3cvxYd8LqmseveIVx0WLmyXbFZPatKrn7oT1ho4BUPG5FkYWRbt2+41mPlYt1mNkSdTrtpuqm4WV5WPonGdc4tPtXivs+YG203VZFcbaLIW1y6xnXJSi/dqvNea8UB2AAAAAAAAAAAAAAAAAAAAAAWd9LeIw2bbI77m1L+890qUqFNfFibfPSdUIp9Y25einJ+Kj2rppLUJUbberAwAAAAAADKbTAq7+YT08rvxvx5tFCWRjqqjkNVUf6fGfbTjbm4x8bcZ9tVr661uMnooSbCpuFuGXt9nzMW6UNWu+H2qrEvKdb+GXTz8V5NAb5tvJ8TL7asvtxL3ou5v+zzf8Wb61v3S6e9gbOnr1XVPqmvMAAAAAAAAAAAAAAAAAAANu4NsH4i5JgYNkO/Eqk83PX6v3PGcZTrl7sixxq93eBcSWi0jFJRikkl0S06JJLokkBxAAAAAAAAAdWTi42fiZWBmVQyMTNx7sXJosWsLqL65VXVSXi42VzaYH5k8w47fxPk288fv7m9tzbKqbJLR34diV2DkPwSeRh2wm15N6Aa0B7W277nbdpCMvn46/8Ab2tuMV/VT6yqf0fD7gN/27esHcko1T+Xfp1x7dI2e/sf2bV9HXTxSA9cAAAAAAAAAAAAAAAAAsN6K7Yq8LeN5nH478ivb6ZNdVXj1xyL+32xsnfBP3wAmoAAAAAAAAAAyno0wKd/mZ2OOPvfH+QVQ0W54GRt2S4ro79tthbTOb8520Zvav4tXuArEAAym0002mmmmno011TTXVNMDadt5Rk43bVmqWVStErNV94gv2norv5Wj94G94mdi51fzcW6Nsencl0nBvysg9JQf0rr5AfWAAAAAAAAAAAAAABbf0yxljcI2ppaSyXm5M/e7M6+EH/4a4gbyAAAAAAAAAAAID/MhhRyOCYGWkvmYHIMKfd5qnIw87Hsj7lK2db/AJIFGwAAAB3UZF+LZG7HtnTZHwnB6P3p+UovzT1TA3bbeVwn21blHsl4LJri3B++2tauH0x1XuQG412V3QjZVOFlc1rGcJKUZL2qUW0wOYAAAAAAAAAAAAXG4Hp+DNg08PuMf0/Os1/0gbUAAAAAAAAAAAIZ9f8At/8AzTO18f7y2rt/a++L/h1AoKAAAAAAD78Hc8zbp92Na4xb1nVL4qbP2oN6a6ea0fvA37bOSYeb21X6YmQ+nbOX7mb/AKu16JN+yWj8lqBsYAAAAAAAAAAAtr6Y5SyeE7XFPWeLPNxbPPRwzbrYL3aU2xA3sAAAAAAAAAAAQD+ZHOjj8G27DUv3mfyDEXbr40YuFnXWS9/bb8tfWBR0AAAAAAAAB6UN2zo4duD8+Use2MYpSbcqlGcZ6VT1Uoxl26NdY6N9AJeAAAAAAAAAALB+iu6KeNvOyzl8Vdte5UR16uF0I4uS17FXKqr65gTaAAAAAAAAAAZS1aQFN/zL77HK3/YuP1TUo7Tt92dkqL6Ryd0shGFc1/DrxsKMl7Fb7wKzAAAAAAAAAAE4AAAAAAAAAAG1cK378OcjwNxnJrFc3i56Wr1w8nSFsml1l8iXbYl5uCAuQ3GSjZCUZQnFSjKLUoyTWqlGS6OMk9U/MDiAAAAAAAAA+fMzcXa8HM3POtjRh4GNfl5N0/s1UY9crbZv26Qi9Eur8APzI5XyDI5TyPeOQZKlGzc822+Fcn3OjGWlWJja9dVjYtcK0/PtA14AAAAAAAAAAnAAAAAAAAAAAAWW9KuXw3Pb48dz7V/eG3V6YMpvSWXgVr4YRb+1dhR+HTxdWj69smBLbTT0YGAAAAAAAZSbYFUvzCeotbh+AtnvUn3VX8jvqlqo9jjbi7SpJ9Zd6jbd7NIR1+2kFSwAAAAAAAAAABOAAAAAAAAAAAA+nDzMnb8qjNw7p4+VjWxuourekq7IPVNeKafg09U10aaYFrOE88weV48MXJlXib5TD9/it9sMlRXxZOF3PWcGlrKHWVfvWkmG+OLXj+nyAwAAAAOSi39HtAgb1Z9ZMPiVGTx/jl1eXyeyEqr74dtuPsanHSVlz6wt3JJ/BV1UH8VnRKEwo1ddbkW25F9tl199k7brrZystttsk52WWWTblOyc222222wOsAAAAAAAAAAATgAAAAAAAAAAAAHZVbbRbXdRZZTdVONlVtU5V2Vzi9YzhODUoSi1qmnqgJq4z6wZWLGvE5JjzzqopQW44qhHMjFdE8iiThTk6ecouEtPFSYEx7ZyzjG8QUsDecKU5afuLbli5Cb8njZPyrn1emqTWvmBsXZqk009f0ae1NagHFRTlKSikm234JJattvRJJAaHyD1O4HxmFj3HkODdkwT/sO32x3LNc1/y5Y+G7fkSl5O1wj7wKxc6/MHve+13bdxWi3j222KVc86U4y3rIrfTSFlTdO2qSfX5TnYvKxdUBXaUpTlKUpOUpNylKTblKTerlJvVttvqwMAAAAAAAAAAAABOAAAAAAAAAAAAAAAHCyuu2Eq7YQsrmtJQnFShJexxaaYGv5O2bpiwb2Hd9xwIrV/c6s/Kop9rVUq7Y9mvslqtfNAaPuObvVk5Ubrm7ldOPjXm5WTd9DSusnGUX5NapgeUAAAAAAAAAAAAAAAAnAAAAAAAAAAA27ZODcn39QswttsrxZ6NZuY/umK4v8AXhO3Sd8f+3GYEn7b6KVxUZ7zvj10XfTttMYJe3ty8vu7l9NKA3HF9MuD4iXzMG7Omv18rNypN/TDGnj0P/dA9mviPDKlpHj22NL/AKmJC5/pu72wO38M8Q/y1s/+F4X8wB+GeIf5a2f/AAvC/mAdF/EOEZKisjiew3qL1irdn2+ztb8XHuqemoHzfgT09/yVxv8AwPbf/RA+e7049N79VPh+xxT86cCvH/Q8f5bX1Aa1uHoZ6X7gn8rasna7Ja62bfuefBpvzVeZbmY0dPdDQCN97/LJTJTs41yeafX5eLvWNGyL9nduGAoOP1YzAgrk/pZzjiUbLt02S+3Br1cty21rcMFQXjZbZQnbi1++6FYEegAAAAAAAAAE4AAAAAAAAbXxnhu98pu0wKPlYcJ9t+45HdDEp85RjLRyvuS/Ugm1qtdF1AsPx70741xtQutpW7blFJvKza4TjCa6642I+6nHSa1TffYv4QG7TyZvpHSC93j+kDobberbb9rerAwAAAAAAAAAym09U2n7U9GB3wyZrpLSa9/j+kCLOZejfDOZxtyaMeOwb1NSktw2ymuuFtj692dt6cMbLTk9ZSj8u1vxn5AU55x6bcn4Hkdu7Yqv262xwxN4w+63b8hvVxhObip4uQ4r+jsUZPR9vclqBoAAAAAAAAE4AAAAAAAl/gfppbvKq3ffo2Y20vSzGxNZVZG4x8VOb6Tow5eTWk7F9nRaSYWFrWPh0VYeBTVjY1EFXVXTCNddcF4RrhFKMV/rA6wAAAAAAAAAAAAAAAGcirE3HFv2/c8ajNwsquVWRRk1Quptrl4wtqnGUZx+ro+oFOPVf0Sv41HI5FxSFuZx+PddmbfrK/L2eHjK2uTcrMvboecnrZVHrPuinNBXUAAAAAAE4AAAAABMfprwGO7ShyDeqf8A6qmbeFi2r4dwtrk07rU/tYVM1pp4WTWj+FNSCwltvfpCC7a49El0108Onkl5IDoAAAAAAAAAAAAAAAAAAHdVaopwmlKqSalFrVaPo+j6NNeKApz62eksOPTt5bxrH02LJtT3PApj8G0ZF0tI5GPGP2dtyLJadvhTY0l8EoqIVvAAAAACcAAAABunBeKWcr3mGPYpx23E7Mjcro6rSnu0hjQl5XZUouK81FSl17dALZNVUVVYeLXCnHx64VV11JRrhXXFRhVCMdFGEIpJIDpAAAAAAAAAAAAAAAAAAAABzdePl49+Bm015GJl1WY99F0VZVbTdB1202QknGVdkJNNPp1A/Pj1U4DdwHktuJVGyey7gp5myZE9ZN4/clbh2Tf2sjAnJQl5yg4TendogjMAAAATgAAAZScmoxTlKTSjFJttt6JJLq22BcDhnHo8V47jYsoRW4ZSWVuE/GX3q2K/da+cMSvSC8m035sD3wAAAAAAAAAAAAAAAAAAAAAAGlepvDoc74dm4FdcZbvgqW4bPZolP79j1yax+56aV59XdVLr2qUlJ/ZQH5yyjKEpRlFxlFuMoyTUoyT0cZJ6NNNdUBgAAAnAAAAkT0x2NbzynGsuh34m1Qe5Xpr4ZWUyjHErfk28mUZaPxjBgWivn32P2R+FfV4v62B0gAAAAAAAAAAAAAAAAAAAAAAO6ifZYvZL4X9fg/qYFC/XHiseNc7zbsetV7fv8FvWKorSELsic4bhStPhTjmwnNRWijCyKAh0AAAnAAAAst6PbasPjuduso6W7lmShXLT7WNgxdVfX/5Nluv0ASUAAAAAAAAAAAAAAAAAAAAAAAAAIJ/Mfsi3Dh+179CGt+yblGu2en2cLdIrHu1a8vvtOOlr06gUlAAAJwAAALk8UxFt/D+P4yWjlt2LfNeGlmXD77an71bcwPXAAAAAAAAAAAAAAAAAAAAAAAAAGreoe3Ld/Tzl2E4qTWzZuVXF9dbtugtyoS97vxo6e8D82AAACcAAAC8VKrW3bcqX3UrFx1VJJqMq1RX8tpNJrWHh0A4gAAAAAAAAAAAAAAAAAAAAAAAADrzVTLZ93jkSUMd7fmK+ck3GFLxbVbJpJtqMNW+gH5ZgAAH/2Q==" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>leon</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-30</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，有个问题一直很困惑<br><br>两阶段提交为了保证binlog和redolog的一致性，<br>1 prepare阶段  2 写binlog  3 commit阶段<br>假如在3之前崩溃，恢复时，虽没有commit，但prepare和binlog完整，所以重启后会自动commit，以此来保证有binlog一致性。<br><br>既然能这样做，那为什么不把commit阶段去掉，恢复时，只要redolog和binlog完整就认为redolog有效，否则回滚呢？ 是因为效率还是其他的原因？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 如果redolog是完整的，（包括了prepare和commit），就直接认为成功，不去判断binlog </p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/0e/3b/66ec78f8.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>彭莉</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-30</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">只有redo-log，没有undo-log，innodb应该没有办法做到crash safe，楼主可不可以把这块也稍微讲一下呢？目前有点一知半解。</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: Undo log跟数据一样，也是WAL机制写入，需要依赖redolog 恢复出来<br><br></p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/72/89/1a83120a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>yihang</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-29</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">有一点没有看懂为什么binlog没有crash-safe的能力？而redolog有？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 已加入答疑文章topic</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/07/8f/3ef096f3.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>yu🐟</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-29</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师您好，如果update写入日志，还没写进磁盘，此时执行查询，如何保证不会产生数据脏读的？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 内存里数据是对的<br></p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epLLXBLBLgticobxvBYRezd304Y66Q8ibYCl7mG9dvTHGrx9obRcn7ZmJBcib3ibsQPIX3xIbNYiaAUrOA/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Geek_c991e0</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-29</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师好，问个问题，如果两种log都写完成了，但是redolog没有写磁盘，物理机挂了，redolog在内存中就丢失了吧，再启动跟磁盘中的binlog就不一致，后期恢复数据的时候会有问题吧</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 是的，这就trx_commit没设置成1的后果…</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/1f/c3/1ef2bccf.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>包子木有馅</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-29</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师好，“同时，InnoDB 引擎会在适当的时候，将这个操作记录更新到磁盘”，想问一下这里“更新到磁盘”是指将日志写入磁盘呢还是说通过redolog更新磁盘里的数据页，如果是后一种的话，那和insert buffer不是一样了吗？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: “更新到磁盘” 就是后者，<br><br>Insert buffer本身是数据的一种， 只是说insert buffer也可以把随机读写变成顺序写。<br>这个我们后面讲唯一索引的时候会提到哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/GrQsm2lOxnBhFuegVwNxrA2dd9qQLwLOlV3xUB615eqKia5vQPdRcnz1T6sxLcmiaSnibTEIVia9ebThaVWxF2TMnw/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>zxx</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-29</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">如果commit写入失败怎么办呢？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e0/cc/011b163c.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>scream</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-29</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">上面id为某·人的关于二阶段提交，也就是14/15描述貌似有点问题，preper阶段是刷redo到磁盘，commit阶段才刷binlog到磁盘，根据淘宝同学提的建议，5.7.之后某一个版本后改到了只需要确保刷binlog之前刷redo(根据lsn判断)，不知道我描述的对不对，请老师确认下！</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 是的，但是两阶段的逻辑没变😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/44/2f/42a8d353.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>王宝龙</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-28</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">1. 在没有 InnoDB 的 redo log 之前，MyISAM 引擎就已经在做 “粉板” 功能了？只是没有写入日志而已，仅保留在内存中而已。如果是这样的话，那么就会产生 crash 后数据差异的状况。<br>2. 在更新操作时，作者举的例子，是“写入新行”之后再写入 redo log 和 binlog 的，但是按作者的话是，应该是“Write-Ahead Logging”先写日志，等不忙时在写磁盘。也就是说，在文中的第三张图中，作者是按 MySQL 不忙为前提，假如以 MySQL 繁忙为前提，那么 redo log 是不是应该在“写入新行”之前，然后 MySQL 等空闲时，再根据 redo log 写入。</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/f9/aa/4437fe1a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>龙猫9527</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-28</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">mysql的插入操作是否也有两个日志呢，对于批量性的insert在values后面跟多少条值是上线？我看有人说2w多条。</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/31/e8/3e61e916.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>天马行空</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-28</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">两个日志的记录是如何建立对应关系的？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>流血的手指</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-28</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redolog binlog是直接写到硬盘吗？还是内存里</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/6a/2d/ec4ed8ce.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>shawn</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，对于wal我还有一些疑问：<br>1. 当你写入 插入一条记录c的时候，要先把c写入到WAL文件。commit 后做了两个动作，先把WAL文件持久化要磁盘，然后更新数据库（磁盘记录）。 我想问，是否要吧WAL文件持久化到磁盘，才更新数据库表和索引的记录到磁盘。<br>2.为什么WAL可用，是不是因为WAL是顺序性的文件，读写起来比较快？<br></div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 1. 是，而且更新的数据写到磁盘是后台操作<br><br>2. 是的，就是转成了顺序写</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/52/63/a58ae0ab.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Kongk0ng</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请问如果写完binlog后crash，redolog还没commit，这时候会发生什么？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 重启后崩溃恢复时提交事务</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/f7/7a/5a4843ed.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>剃刀吗啡</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">如果是redo log是直接写磁盘，为什么不把更新的数据直接写磁盘？是因为慢太多？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 是的，顺序写比随机写快</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/e1/bf/7b22efac.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>seafooler</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，我有个问题。如果将innodb_flush_log_at_trx_commit参数设置为1，那么每次redo log都要被刷新到磁盘，这样效率也会比较低吧。感觉就不太符合您讲的“掌柜写粉板提高效率”例子了。谢谢老师的解答</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 日志顺序写盘，比直接写数据（随机写盘）还是快的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/21/5b/09940ac6.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>动与静</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，什么叫数据页？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/e1/bf/7b22efac.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>seafooler</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，您这个逻辑架构图是用什么工具画的啊？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/52/07/5d74b03f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>静静的等</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">1. redo log做的事情和binlog的row格式有什么区别呢？都是记录了“做了什么改动”。<br><br>Redo log不是记录数据页“更新之后的状态”，而是记录这个页 “做了什么改动”。<br>Binlog有两种模式，statement 格式的话是记sql语句， row格式会记录行的内容，记两条，更新前和更新后都有。</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/52/07/5d74b03f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>静静的等</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">1. 写完binlog提交redo log之前，数据库crash了，这时候binlog和redo log的状态是怎样的？binlog 和redo log会回滚吗？<br>2. binlog为什么不能保证crash-safe?</div>  <!----></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJoyqXrhQS7Chvj4yNxUlZ1Ltribiat2uQMiabQURjwA9KQojKicjjQOdJDZ85VwaI5t4LrOHOHjOLRgw/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>zhxleon</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">innodb肯定是MySQL用的最多的存储引擎，redo为什么不能像oracle一样直接生成一份归档日志，这样MySQL也可以和oracle一样做物理复制了，只需要把redo产生吨位归档传输到从库应用即可，同时也能保证数据完全一致，而且从库应用日志速度也会比现在快的多</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 官方的动作有这个趋势</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/02/fc/f18b97c3.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>王大英</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，我这个小白不懂，字段由0变1时，在“先写redo后写bin”下，写完redo就crush，您说用binlog恢复会导致结果是0和原库不一致。但那也还没commit啊，原库不还是0，用binlog恢复出来数据库也还是0，那不是反而保证了和原库一致吗？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: Innodb里面，redolog写完就算成功了，崩溃恢复以后这个行是1</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>大卫</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，有一点我一直不太理解，比如执行器查询一条记录的时候，引擎是从磁盘取数据放到内存在从内存中取数据返回的。更新的时候重做日志没有commit之前就更新内存了，这个时候其他的查询是不是就可以查到未提交的数据？如果加锁那么是对这块内存加锁吗？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 你先看一下第三讲哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/70/70/e8f4bbeb.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>臧忠超</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">使用redo log，有热点表的时候，对热点表的查询效率会较差—需要查询磁盘上的原始数据再查redo log，效率如何保证？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不用，查内存就行</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/27/c4/eb7c7b29.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>仰泳的双鱼</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-27</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">如果先写binlog  再写redolog ，出现crash时我以之前全备份加binlog进行恢复，不需要redolog了,出现不一致也没有问题啊？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 嗯，你这么做是可以的，但是正常重启innodb 要做崩溃恢复的，它一看，没redolog, 这个事务是没有的。但是binlog里面已经有了，用你的方法事务就存在。<br><br>设计上要避免使用方式的问题出现不一致的结果</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/f5/68/686d1a0b.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>wq</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-26</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">Redolog是在系统闲时将更新到数据库，那在未更新到数据库之前，读取这条数据流程是什么样的</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/ec/cb/27033e11.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>王木鱼</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-26</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师好。请问可不可以这样总结归纳：<br>事务的两阶段提交：<br>t-3 时刻：事务开始前，数据库一致<br>t-2 时刻：写入 redo log。redo log 中 本次事务为 prepare 状态<br>t-1 时刻：写入 bin log<br>t 时刻：提交事务，redo log 中 本次事务为 commit 状态<br>两阶段提交的好处是能恢复到 t时刻。<br><br>另有疑问：<br>1. 假设 bin log 可以在事务提交后 append 一个数据一致的标识，那是不是可以仅使用 binlog 就能恢复到 t-3 时刻？<br>2. redo log 是 InnoDB 特有的日志。那么从软件设计的角度来说，是不是由 MySQL 实现一个通用的 redo log(具体实现或接口定义) 会更好？这样以后还可以由开源社区提供其他更好的引擎，并且具有完整的 crash-free 能力</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/b8/36/542c96bf.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Mr.Strive....</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-26</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，第一次课的答案第二次课好像没提到答案呢？？还有就是二阶段提交：redo log一阶段perpare后，bin log记录时crash。这个时候没有commit，那redo log 如何处理？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 在第一次课的置顶评论里面。<br><br>如果binlog没写完，这个事务在崩溃恢复过程中会回滚</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/49/08/9da90ad5.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>亚伯拉罕·林</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-26</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">我采用mysqxtrabackup来全量和增量备份数据库,没有备份binlog，这样可以的吧</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 看你的系统可靠性要求哈。两次增量备份之间如果机器挂了怎么解决的，要有个预案</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/c7/d7/b9f93eec.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>特斯拉</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-26</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">一天备份一次在经常需要扩容的的场景下可以提高系统的读能力。<br><br>有个小问题，为什么增加备份能提高读能力?</div>  <!----></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>加班工程师</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-26</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">如果是在 新行更新到内存 到 写入redo-log 这两个阶段中间崩了(内存更新了但还没写入redo-log)会有什么措施吗</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/78/31/c7f8d1db.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Laputa</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-25</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">文章和就留言中提到了数据页的概念，老师能否简单解释下什么是数据页</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>大大大dvavid</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-25</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请问数据库备份是怎么做？可以通过主从数据库，将从库的复制时间设置为1天后复制的方法实现备份么？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这个叫延迟从库，你可以在这个库上备份。不过一般建议在一个普通从库上备份</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>大大大dvavid</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-25</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">想问下老师，在没有数据库备份的情况下，仅仅通过binlog文件是否可以回复一次误删除的表数据？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 《误删数据后除了跑路还能做啥》这篇会提到</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Geek_9ca34e</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-25</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师你好，关于redo log和binlog大概思路我已明白，但是两阶段提交部分我还是有一点纠结，redo先写日志但是状态标记为prepare，再写binlog日志，整个事物提交时再把redo的状态改为commit，问题如下：1、redo 修改状态为commit的时候突然断电，服务器恢复后redo log和binlog是否就不一致了？2、redo 修改状态为commit的时候失败，整个事物回滚但是突然断电是否也会导致redo log和binlog不一致？3、如果通过binlog实现主从复制，那么是事物提交成功才复制到slave节点，还是只有写了binlog就复制到slave节点？4、不管是redo log还是binlog写了日志就理解刷到磁盘，还是写入磁盘缓冲器，实际的刷盘动作有磁盘来保证，不管是否断电重启都不影响实际耍盘和数据丢失？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/e9/0b/53bf91d3.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>WL</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-24</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">一天一备份, 每份bin log都比较小, 数据恢复比较快, 但是每天数据库备份占用的硬盘空间会比较大, 相比每周备份几乎多了一个数量级. </div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 对的，存储成本和RTO的权衡</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJZBOcesNKYJRJKR6noK2VClOS8iaeEsibpXSLlFT87mARozsicHSAo8VibSEOZSRVw2XWK4UyqjQDYJQ/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>蓝色十三月</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-24</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">哥，想了解下如果写binlog成功了，然后通知redolog commit失败了会怎么样？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>coolep</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-24</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">文中有两处内容让我迷惑，感觉描述不一致，如下：<br>“具体来说，当有一条记录需要更新的时候，InnoDB 引擎就会先把记录写到 redo log（粉板）里面，并更新内存”<br>“3.引擎将这行新数据更新到内存中，同时将这个更新操作记录到 redo log 里面”<br><br>该过程是先把新数据更新到内存中再写到redo log里吗？望老师给小白指导一下</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 如果是MySQL 代码里的精确顺序，是先更新内存的。这里主要是要说明WAL机制，这两个的顺序你可以认为“同时”，会更方便理解</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/71/97/09bc55dc.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>张永志</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-24</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">一天一备在恢复时应用binlog会更少，恢复起开更快，影响恢复所需时间。<br>如果只有最新一天的全备，恢复是快了，但是可恢复到的时间点就太有限了。<br>如果支持恢复到最近7天任意时点，在库不大且备份空间足够的情况下，可一个全备+隔天一个增量来做，但保留最近7天的binlog。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 正确😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/31/a0/96698bbc.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>三七</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-24</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">非常感谢老师，但是心中有个小疑问，望老师解答，innodb引入redo log是为了提高效率，并且有了它，InnoDB 就可以保证即使数据库发生异常重启，之前提交的记录都不会丢失，那没有redo log的myisam，数据库发生异常重启会丢失数据吗？如果不会丢失数据，那么myisam是否也算是crash-safe</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: Myisam就是会丢…</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/10/7b/eed9d6d6.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>小笨蛋</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-24</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">方便问一句吗？像你说的WAL这种关键技术等东西是在什么官方渠道看到的。</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: https://en.wikipedia.org/wiki/Write-ahead_logging WAL是数据库通用技术哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/e8/30/0a4eca46.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>小怪</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">厉害，需要看多遍</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJ1DjK3gmzm8zABTS9VOfX0sIrNtcrKHMpuw61xORGicUtu3BbDlEBsbDRc736EnicY132biaNQctianQ/0" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>乔俊杰</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">留言板里的内容比文章更精彩</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这确实是意外之喜</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/ff/c3/b90b862c.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>zyy</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">反复看了几遍，根据正文和文末留言大致了解了这些概念。<br>有一个疑问 redo log记录 在某个数据页做了什么修改，这里数据页要怎么理解，数据查询的结果数据？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不是，存放数据的地方，你可以理解为按块儿存，一块儿16K</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/42/d3/5cb266ea.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>静处常思己过</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">在两阶段提交那段绕了半天。想了想：<br>1.redo log记录的数据状态，就是用户视角数据库中应该保存的状态。但是实际却可能还在内存中，没有写入磁盘。<br>2.异常重启：当MySQL异常重启后，会读取redo log，将没有写入磁盘的数据写进去。用户视角中的数据完整的保存了下来。并不会因为之前保存在内存中而丢失。此时redo log中没有commit状态的，就会回滚（如果redo log prepare + binlog = redo log commit）。<br>3.备份/复制：当需要恢复数据到某一节点的时候，会用备份+重放binlog的方式。<br>4.如果没有两阶段提交存在。修改status 0 →1，写入redo log成功，写入binlog失败，那么MySQL异常重启后，根据redo log，数据库中的status已经是1 。但是如果我用binlog去恢复另外一个库，因为没有这个事务记录，所以status = 0。两个库对比，会出现一个stauts是0，另外一个是1的情况。反之同理。<br>5.上面是思考的过程，最后感觉可能也有同学跟我一样懵逼。我觉得要点是：redo log是MySQL用来保存类似工作现场快照的东西，MySQL崩溃后自己修复自己的时候用。手动备份或者恢复数据库的时候并不是依据它来做。binlog是给用户恢复到数据库某一节点用的。不能混了，不然绕不出来。<br>6.不知道上面的理解是不是都对。。。。</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/2f/fd/dead7549.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>AJIE</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，还是不太理解binlog为什么不具有crash safe的能力</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/2f/fd/dead7549.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>AJIE</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">既然恢复数据是基于binlog，那在恢复是基本上没redo log什么事，难道用来校验？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83eqOpANMwDibLmj5IGJh6dTw300sZ1BHM5sG3sZv1A1rvCHOiblPD3jgFOiaMVVujtctWnQbVFoNPpRgw/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>alioo</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">关于“一天一备会比一周一备更有优势”我谈谈的我观点：<br>binlog一般情况下是崩溃时用来恢复的，恢复时间越短，对业务的影响越小，一天一备的话只需要利用昨天的备份+今天截止到目前的增量binlog，增量数据相对小一些，恢复的时间自然要高效一些。<br>反过来说如果一周一备的话，首先binlog需要存储的至少是一周的数据（binlog如果小于一周的话否则故障发生时就无法恢复了）。所以我认为影响到的指标是expire_logs_days（可以通过 show variables like '%expire_logs_days%'来进行查看）</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/0f/44/396d2d8e.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>zj-de</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">先写redo log。再写bin log。如果在系统崩溃时。没有写redo log，那么这次修改就是真的丢了，找不回来，如果redo log写了。bin log 没写，那么需要依靠bin log + redo log来恢复。如果 bin log也写了，光靠bin log 就能恢复，是这样理解吗？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/df/6d/44cf0de4.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Ivan</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，您好。mysql5.6以后的crash后的恢复，是不是只是用redo，而不会去查询binlog？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/7c/d5/7ae845fa.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>hb</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">能大概说下原理嘛 怎么个确认法</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 啥？</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/54/41/3d352f74.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>小金库so</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">有个问题请教老师，既然write pos和checkout都是往后推移并循环的，而且当write pos赶上checkout的时候要停下来，将checkout往后推进，是不是意味着，后续的更新请求都会等待，等checkout往后推到一定空间后，再继续执行。如果上述成立的话，在大量的更新或插入操作的时候，write pos可能会很快的追上checkout，从而再次产生等待的过程，这个是不是一个在性能上产生瓶颈。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 是的，所以1. 要设置大一点的innodb redolog的大小 2. 用好点的磁盘😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/7c/d5/7ae845fa.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>hb</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">关于崩溃恢复 数据库目标既然是保持数据一致可能还原也可能执行 对于数据库的客户端这时候是什么状态呢 对于这些没有收到成功答复的更新操作 客户端需要一直重试吗</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 代码里面要有确认的逻辑</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/ab/10/b812ff3e.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Hesher</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">看来恢复的过程是存储引擎来做的，server层肯定不会去动redo log。其他引擎，没有redo log，只靠bin log也能做备份恢复吧？跟InnoDB比优缺点在哪？看到其他同学的评论，恢复分为重启恢复和备份恢复，redo log的crash safe是为了做重启恢复吗？直接用binlog恢复不行吗，前提是bin log开启的情况下。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 1. 是的<br>2. Innodb没有binlog<br>3.这个问题问的同学有好几个，我加到答疑篇🤝</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/44/cc/3e62d111.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>justd</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">两种方式确定记录完整：    <br>1. redo log状态为 commit<br>2. redo log状态为prepare并且bin log记录完整 （提交commit之前）</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/de/d4/b83c4185.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>David.cui</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-23</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">我没有听明白孔乙己掌柜的粉板和账本怎么和redo log,binlog,磁盘数据对应起来。另外mysql的redolog和oracle 的redolg是名称一样但是用途不一样？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/28/8e/4c6c0ba2.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>TIMKeeper-s...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-22</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，我受益非浅。</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/d6/d4/0fa9ca6a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>grace_233</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-22</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，我有一个大大的问题想问。 上面的文章中有张 "update 语句执行流程" 的图我看懂了。但是我有一个疑惑。比如我在执行事务的时候，其实有两条sql语句：<br>1. update T set c=c+1 where ID=2;<br>2. commit;<br><br>我特别特别想知道，上面的 "update 语句执行流程" 图，哪些操作是在update T set c=c+1 where ID=2 语句发出后执行的，哪些操作是在commit语句发出之后执行的？<br><br>谢谢老师了~~~~~~~~~~</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/de/1c/60ff644d.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Fatal Error</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-22</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">write pos 是当前记录的位置<br>checkpoint 是当前要擦除的位置<br>请问老师，这个checkpoint 是不是就像图片一样，当写到3的时候，0已经被擦除了，并且checkpoint已经在1上面了。就是，checkpoint 是预先擦除一个文件的位置留给 write pos 写？<br></div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 对，但是并不保证能够多出一个文件，也有可能write pos追上来就接近chenckpoint,这两位置在同一个文件</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/a6/e2/01dadfb4.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>湖</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-22</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">若更新操作记录到redo log中，此时处于prepare状态， binlog也写入成功，但是在最后提交事务是失败会出现什么样的情况？事务会回滚？会做些什么事情呢？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/cb/53/262a8ce2.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>是我</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-22</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">因为redo log不是每个引擎都具备的，所以就需要binlog来进行辅助，不知道可以不可以这样理解？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 但是算先来后到的话，先有的binlog...</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/fa/8b/d7dd7cae.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>代小亮</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-22</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，两阶段提交过程中，如果是在redo log prepare状态，binlog已经写到磁盘上之后，数据库crash了，重启之后，binlog和redo log 不是也不一样吗？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTKq0aBhhSXg7qiaWQH81zmjAYPXwoiaJEoMOxwXZF7d2iazMyQCeYpT7DJmxy2Iny7qq3RRr0UjOnO5A/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>xiaoma2008</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-22</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请问一下，怎么根据id查询到page的？也就是说buffer pool中存的的page，怎么根据记录的id找到对应的page的呢？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/8c/38/f1f2227a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>伪装成学霸的...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-22</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">想请教一下 table 和  column的命名规则，怎样使比较推荐的方式。我看到作者是table 和 ID 是 大写， 其他的column是小写？ </div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 建议全部小写，作者给了错误示范，以后改正😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/03/c7/563345e1.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>wjz1991</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-22</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，问一个问题，客户端发起commit的时候，收到commit成功是在把事务写到innodb_log_buffer_size就返回成功，还是要刷到binlog后才返回成功啊</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 都要。而且不止写到log_buffer,还要写到redolog文件</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/16/93/c5be3aee.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Sea - fis...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-22</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">我的理解：<br>redoLog就是记录将要做什么，相当于缓存的作用，实在暂时保留未来要写盘的意图，等到空闲时写盘。redolog记录了当前阶段（可以理解为只要没有成功commit，redoLog都有记录。在回滚或提交后再清除这条记录）<br>binLog归档主要用来恢复数据，第一保证事务正常，RedoLog有记录binLog没有日志，事务回滚；当redoLog有binLog也有时就继续提交。第二 数据恢复的时候使用binLog<br>大神，指教一下理解的对不对<br>还有个问题，更新没有及时写盘，还处在与prepare阶段时。查询数据select * from xx limit 10时执行器检索磁盘查的的不包含刚刚更新的那条？会发生数据不同步？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://wx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJJeibN69icI9iapx9h2MtUX3zb2iaggw32w4GAmbUDibPp3ia5MPSznxGZeiadXibBbx6Y13iacDbTDBwKyibA/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>悟空</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-22</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，有没有什么直观的方法监控当前buffer pool淘汰了多少页、从磁盘读了多少页呢？谢谢</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/83/4b/0e96fcae.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>sky</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-22</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师好！<br>“与此类似，InnoDB 的 redo log 是固定大小的，比如可以配置为一组 4 个文件，每个文件的大小是 1GB，那么这块“粉板”总共就可以记录 4GB 的操作。”<br><br>这里无论配置多少组多少文件，它的总大小都不能超过4G吗 还是这个4G是可以配置的  还有关于这块的配置变量都有哪些呀 谢谢</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/45/c9/a4f7054f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>佳</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-21</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">那个redo log的日志说是物理的，并且是循环写，那一写满以后，原来的就要被擦除掉了，那万一日志发生崩溃，想要恢复到原来被擦除的日志信息的那部分还能恢复吗？那个时候的恢复是只能依靠binlog日志恢复吗？redo log日志在写满后擦除前会持久化原来的信息吗？redo log是怎么实现崩溃恢复的？是边写边做了持久化吗？然后一启动，自动加载崩溃前的保存到磁盘的状态来进行恢复的吗？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/j0n4JAfhd9wUicVeibMYcWQ3O4Y4dakC161f9rWM7cSicC7UMSSUsJ5hqibFjGmSB0dQDjfkjiavbBmUFroqHYquJRA/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>蒋日健</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-21</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">反反复复看了好多遍，最后的疑问是，redo log可以不要，因为别的引擎也没有这个日志，这时候，先写bin log，然后提交，之后返回，但是假如提交之前就异常退出了怎么办？有什么用来记录写入的bin log没生效么？这样重启后才知道应该删除这条bin log或者再执行一次提交。求老师解惑</div>  <!----></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>hellobfy</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-21</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">一。 同样都是调用引擎接口，  为什么写入新行操作算执行器的， 提交事务操作就算引擎的了？<br>具体描述如下：<br><br>update 语句时的内部流程时<br>2.执行器拿到引擎给的行数据，把这个值加上 1，比如原来是 <br>是 N，现在就是 N+1，得到新的一行数据，再调用引擎接口写入这行新数据。 <br><br>这里调用引擎接口时， 算执行器的操作<br><br>5.执行器调用引擎的提交事务接口，引擎把刚刚写入的 redo log 改成提交（commit）状态，更新完成。<br><br>这里调用引擎接口， 提交事务为什么就算引擎的操作了？ 跟上面是不是有冲突，还是因为什么原因呢？<br><br>二。 我对redolog的存在原因的理解： <br>redlog存在时为了数据库的内存操作的数据安全。 <br>虽然写日志有io成本， 但是比每条sql都直接操作硬盘的成本依然还是低， 。<br>所以综合来说，保证内存操作，然后日志硬盘io，最划算。<br><br>三。比较好奇redolog设计固定大小4g的历史原因。。<br><br><br>&nbsp;ps： 每次想您刚发出来时就好好读，有时候加班真的是不允许= =<br>&nbsp;第一时间读了提出疑惑， 应该是回复最积极的时候啦 哈哈哈。。 <br><br>文中 checkpoint和write 中间部分 描述确实有歧义，需要多想一下。<br><br>另外希望大家写评论时候都注意格式，评论是对文章的补充，格式更好，大家读起来也更轻松和更快<br><br><br><br><br><br><br><br><br></div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 一、其实真正做数据更新和事务维护的都是引擎。但是引擎接口是执行器来调用的，调用关系。<br><br>这里只需要明确，“加1” 这个操作是在server层的执行器做的就行啦<br><br>在这个流程里，逻辑计算在server, 引擎层做读写<br><br>二、理解正确<br><br>三、不是固定为4G哦，可以配置的，只是在现在普遍的大内存场景下，要支持稳定的写入性能，可以设置4G</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epyb06M55D5wXsDrsObicnNJtph90rsuKug7KYOJWleyGJrltDA2PAkp3jRAzIxFfUbnA96ic5TibLTQ/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>MrGuo</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-21</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">“1. 执行器先找引擎取 ID=2 这一行。ID 是主键，引擎直接用树搜索找到这一行。如果 ID=2 这一行所在的数据页本来就在内存中，就直接返回给执行器”  大神，请问这个数据页本来就在内存中 是 server端的缓存 吗？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: Innodb 内存</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/17/d1/5626f60f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>尼尼虾条</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-21</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redo log记录的是数据页 做了什么改动，而binlog在statement模式下记录的是sql语句<br>这两者有什么不同呢？个人的理解是 改动不就是sql的语句的实现吗？？请老师答疑，谢谢</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 我在答疑文章中说吧</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pv/uAA5BZG9iZQBkwAAAAAH/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgMDAwMDAwMDAwMBAQEBAQEBAgEBAgICAQICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDA//AABEIAO4A7gMBEQACEQEDEQH/xACGAAEAAgIDAQEBAAAAAAAAAAAABwgBBgIDBQQJCgEBAAAAAAAAAAAAAAAAAAAAABAAAgIBAwIDBAYECgkFAAAAAAECAwQRBQYhEjFBB1FhIhNxgTIUFgiRQnIjUmKC0jNjJBWVVqGx0ZLCQ1Nzk9NEdCUXEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwD+wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADKTbSSbbeiS6tt+CS82wPXp49v+TFSx9j3jIi+qlTtmbbF/Q4USTA4ZGxb3iRc8rZt1xoLxlkbfl0xX0yspikB5QAAAAAAAAAAAAAAAAAAAAAAAAAAAAHfjY2RmX1YuJRbk5N81XTRTCVltk34RhCCcpMCcuNejrnCvL5Pkyq1SktswrI98df1cvL0lFP2xq1/b8gJj2vYdj2SEYbVteJidq7fm11ReRJaafvMqzvybX+1Jgev3v2IB3v2IDwd14xx3fYyW57TiXWTT/tMa1TlJvzjl0fLyF166OWntAg3mPpNn7ZjX7jxdX7zVUlZLaZuuO5KvuXzHi2/u6cxwhq1DSFktFFdzYEJY+ZRkuyEHKF1M5V5GNdCVOTj2wk4TrvosUbK5wmmnqvFAfUAAAAAAAAAAAAAAAAAAAAAAAAfZt+Bl7pmY+34FE8jLyrFVTVDxlJ6ttt6RhCEU5Sk9FGKbfRAWx4ZwjA4liRskq8reL60svOcde3XRyxsTuWtWNF+L6Ssa1l5RiG6Nt+IGAAAABlSa/2AQz6pelGNy+izfePqG3cvxYd8LqmseveIVx0WLmyXbFZPatKrn7oT1ho4BUPG5FkYWRbt2+41mPlYt1mNkSdTrtpuqm4WV5WPonGdc4tPtXivs+YG203VZFcbaLIW1y6xnXJSi/dqvNea8UB2AAAAAAAAAAAAAAAAAAAAAAWd9LeIw2bbI77m1L+890qUqFNfFibfPSdUIp9Y25einJ+Kj2rppLUJUbberAwAAAAAADKbTAq7+YT08rvxvx5tFCWRjqqjkNVUf6fGfbTjbm4x8bcZ9tVr661uMnooSbCpuFuGXt9nzMW6UNWu+H2qrEvKdb+GXTz8V5NAb5tvJ8TL7asvtxL3ou5v+zzf8Wb61v3S6e9gbOnr1XVPqmvMAAAAAAAAAAAAAAAAAAANu4NsH4i5JgYNkO/Eqk83PX6v3PGcZTrl7sixxq93eBcSWi0jFJRikkl0S06JJLokkBxAAAAAAAAAdWTi42fiZWBmVQyMTNx7sXJosWsLqL65VXVSXi42VzaYH5k8w47fxPk288fv7m9tzbKqbJLR34diV2DkPwSeRh2wm15N6Aa0B7W277nbdpCMvn46/8Ab2tuMV/VT6yqf0fD7gN/27esHcko1T+Xfp1x7dI2e/sf2bV9HXTxSA9cAAAAAAAAAAAAAAAAAsN6K7Yq8LeN5nH478ivb6ZNdVXj1xyL+32xsnfBP3wAmoAAAAAAAAAAyno0wKd/mZ2OOPvfH+QVQ0W54GRt2S4ro79tthbTOb8520Zvav4tXuArEAAym0002mmmmno011TTXVNMDadt5Rk43bVmqWVStErNV94gv2norv5Wj94G94mdi51fzcW6Nsencl0nBvysg9JQf0rr5AfWAAAAAAAAAAAAAABbf0yxljcI2ppaSyXm5M/e7M6+EH/4a4gbyAAAAAAAAAAAID/MhhRyOCYGWkvmYHIMKfd5qnIw87Hsj7lK2db/AJIFGwAAAB3UZF+LZG7HtnTZHwnB6P3p+UovzT1TA3bbeVwn21blHsl4LJri3B++2tauH0x1XuQG412V3QjZVOFlc1rGcJKUZL2qUW0wOYAAAAAAAAAAAAXG4Hp+DNg08PuMf0/Os1/0gbUAAAAAAAAAAAIZ9f8At/8AzTO18f7y2rt/a++L/h1AoKAAAAAAD78Hc8zbp92Na4xb1nVL4qbP2oN6a6ea0fvA37bOSYeb21X6YmQ+nbOX7mb/AKu16JN+yWj8lqBsYAAAAAAAAAAAtr6Y5SyeE7XFPWeLPNxbPPRwzbrYL3aU2xA3sAAAAAAAAAAAQD+ZHOjj8G27DUv3mfyDEXbr40YuFnXWS9/bb8tfWBR0AAAAAAAAB6UN2zo4duD8+Use2MYpSbcqlGcZ6VT1Uoxl26NdY6N9AJeAAAAAAAAAALB+iu6KeNvOyzl8Vdte5UR16uF0I4uS17FXKqr65gTaAAAAAAAAAAZS1aQFN/zL77HK3/YuP1TUo7Tt92dkqL6Ryd0shGFc1/DrxsKMl7Fb7wKzAAAAAAAAAAE4AAAAAAAAAAG1cK378OcjwNxnJrFc3i56Wr1w8nSFsml1l8iXbYl5uCAuQ3GSjZCUZQnFSjKLUoyTWqlGS6OMk9U/MDiAAAAAAAAA+fMzcXa8HM3POtjRh4GNfl5N0/s1UY9crbZv26Qi9Eur8APzI5XyDI5TyPeOQZKlGzc822+Fcn3OjGWlWJja9dVjYtcK0/PtA14AAAAAAAAAAnAAAAAAAAAAAAWW9KuXw3Pb48dz7V/eG3V6YMpvSWXgVr4YRb+1dhR+HTxdWj69smBLbTT0YGAAAAAAAZSbYFUvzCeotbh+AtnvUn3VX8jvqlqo9jjbi7SpJ9Zd6jbd7NIR1+2kFSwAAAAAAAAAABOAAAAAAAAAAAA+nDzMnb8qjNw7p4+VjWxuourekq7IPVNeKafg09U10aaYFrOE88weV48MXJlXib5TD9/it9sMlRXxZOF3PWcGlrKHWVfvWkmG+OLXj+nyAwAAAAOSi39HtAgb1Z9ZMPiVGTx/jl1eXyeyEqr74dtuPsanHSVlz6wt3JJ/BV1UH8VnRKEwo1ddbkW25F9tl199k7brrZystttsk52WWWTblOyc222222wOsAAAAAAAAAAATgAAAAAAAAAAAAHZVbbRbXdRZZTdVONlVtU5V2Vzi9YzhODUoSi1qmnqgJq4z6wZWLGvE5JjzzqopQW44qhHMjFdE8iiThTk6ecouEtPFSYEx7ZyzjG8QUsDecKU5afuLbli5Cb8njZPyrn1emqTWvmBsXZqk009f0ae1NagHFRTlKSikm234JJattvRJJAaHyD1O4HxmFj3HkODdkwT/sO32x3LNc1/y5Y+G7fkSl5O1wj7wKxc6/MHve+13bdxWi3j222KVc86U4y3rIrfTSFlTdO2qSfX5TnYvKxdUBXaUpTlKUpOUpNylKTblKTerlJvVttvqwMAAAAAAAAAAAABOAAAAAAAAAAAAAAAHCyuu2Eq7YQsrmtJQnFShJexxaaYGv5O2bpiwb2Hd9xwIrV/c6s/Kop9rVUq7Y9mvslqtfNAaPuObvVk5Ubrm7ldOPjXm5WTd9DSusnGUX5NapgeUAAAAAAAAAAAAAAAAnAAAAAAAAAAA27ZODcn39QswttsrxZ6NZuY/umK4v8AXhO3Sd8f+3GYEn7b6KVxUZ7zvj10XfTttMYJe3ty8vu7l9NKA3HF9MuD4iXzMG7Omv18rNypN/TDGnj0P/dA9mviPDKlpHj22NL/AKmJC5/pu72wO38M8Q/y1s/+F4X8wB+GeIf5a2f/AAvC/mAdF/EOEZKisjiew3qL1irdn2+ztb8XHuqemoHzfgT09/yVxv8AwPbf/RA+e7049N79VPh+xxT86cCvH/Q8f5bX1Aa1uHoZ6X7gn8rasna7Ja62bfuefBpvzVeZbmY0dPdDQCN97/LJTJTs41yeafX5eLvWNGyL9nduGAoOP1YzAgrk/pZzjiUbLt02S+3Br1cty21rcMFQXjZbZQnbi1++6FYEegAAAAAAAAAE4AAAAAAAAbXxnhu98pu0wKPlYcJ9t+45HdDEp85RjLRyvuS/Ugm1qtdF1AsPx70741xtQutpW7blFJvKza4TjCa6642I+6nHSa1TffYv4QG7TyZvpHSC93j+kDobberbb9rerAwAAAAAAAAAym09U2n7U9GB3wyZrpLSa9/j+kCLOZejfDOZxtyaMeOwb1NSktw2ymuuFtj692dt6cMbLTk9ZSj8u1vxn5AU55x6bcn4Hkdu7Yqv262xwxN4w+63b8hvVxhObip4uQ4r+jsUZPR9vclqBoAAAAAAAAE4AAAAAAAl/gfppbvKq3ffo2Y20vSzGxNZVZG4x8VOb6Tow5eTWk7F9nRaSYWFrWPh0VYeBTVjY1EFXVXTCNddcF4RrhFKMV/rA6wAAAAAAAAAAAAAAAGcirE3HFv2/c8ajNwsquVWRRk1Quptrl4wtqnGUZx+ro+oFOPVf0Sv41HI5FxSFuZx+PddmbfrK/L2eHjK2uTcrMvboecnrZVHrPuinNBXUAAAAAAE4AAAAABMfprwGO7ShyDeqf8A6qmbeFi2r4dwtrk07rU/tYVM1pp4WTWj+FNSCwltvfpCC7a49El0108Onkl5IDoAAAAAAAAAAAAAAAAAAHdVaopwmlKqSalFrVaPo+j6NNeKApz62eksOPTt5bxrH02LJtT3PApj8G0ZF0tI5GPGP2dtyLJadvhTY0l8EoqIVvAAAAACcAAAABunBeKWcr3mGPYpx23E7Mjcro6rSnu0hjQl5XZUouK81FSl17dALZNVUVVYeLXCnHx64VV11JRrhXXFRhVCMdFGEIpJIDpAAAAAAAAAAAAAAAAAAAABzdePl49+Bm015GJl1WY99F0VZVbTdB1202QknGVdkJNNPp1A/Pj1U4DdwHktuJVGyey7gp5myZE9ZN4/clbh2Tf2sjAnJQl5yg4TendogjMAAAATgAAAZScmoxTlKTSjFJttt6JJLq22BcDhnHo8V47jYsoRW4ZSWVuE/GX3q2K/da+cMSvSC8m035sD3wAAAAAAAAAAAAAAAAAAAAAAGlepvDoc74dm4FdcZbvgqW4bPZolP79j1yax+56aV59XdVLr2qUlJ/ZQH5yyjKEpRlFxlFuMoyTUoyT0cZJ6NNNdUBgAAAnAAAAkT0x2NbzynGsuh34m1Qe5Xpr4ZWUyjHErfk28mUZaPxjBgWivn32P2R+FfV4v62B0gAAAAAAAAAAAAAAAAAAAAAAO6ifZYvZL4X9fg/qYFC/XHiseNc7zbsetV7fv8FvWKorSELsic4bhStPhTjmwnNRWijCyKAh0AAAnAAAAst6PbasPjuduso6W7lmShXLT7WNgxdVfX/5Nluv0ASUAAAAAAAAAAAAAAAAAAAAAAAAAIJ/Mfsi3Dh+179CGt+yblGu2en2cLdIrHu1a8vvtOOlr06gUlAAAJwAAALk8UxFt/D+P4yWjlt2LfNeGlmXD77an71bcwPXAAAAAAAAAAAAAAAAAAAAAAAAAGreoe3Ld/Tzl2E4qTWzZuVXF9dbtugtyoS97vxo6e8D82AAACcAAAC8VKrW3bcqX3UrFx1VJJqMq1RX8tpNJrWHh0A4gAAAAAAAAAAAAAAAAAAAAAAAADrzVTLZ93jkSUMd7fmK+ck3GFLxbVbJpJtqMNW+gH5ZgAAH/2Q==" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>风雪</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-21</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，是不是可以了理解redolog是为了保证binlog的日志记录有效，那redelog的prepare有什么用当没有写入binlog的时候，可以恢复数据吗，还是说当MySQL中断会清空redolog，那这样的话如果热的redolog做持久化了那是不是跟binlog一样可以恢复数据了</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/d2/7e/bd8c372a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>你有资格吗？</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-21</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师我在这块有疑问：1.在redo log的时候您说的是写磁盘会比较耗费时间，先写redo log然后innodb会在合适的时候写入磁盘，那么这innodb写入之前这时候有线程来读这别数据，是不是不会读到新数据？<br>2.为什么bln log无法crash-safe,讲道理也可以读日志文件来看啊？<br>求大佬解惑！！！</div>  <!----></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83ep9sZwlAz96kja8n3P0rTerYMLiaOtQEIxYYN1JKAffUMzXIRTHhvzSAqkeTpagnyxXtP3ppt74jxg/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>alvin li</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-21</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">对于写多的场景，或者业务本身对数据准确性比较敏感的场景，比如支付，应该备份频繁点比较好吧</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/e8/90/d63f8347.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>yushing</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-21</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">binlog写入成功，但在事务提交时crash时，导致redo log和binlog不一致了，老师在问答区提到这种情况下“崩溃恢复时，事务会自动提交”，那么崩溃恢复时redo log是怎么判断事务是需要提交还是回滚的呢？(因为还存在另一种情况是redo log prepare了，但binlog还未写入时crash了，这时崩溃恢复时，事务是应该回滚吧)</div>  <!----></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>有趣的灵魂</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-21</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">有一点没明白，redolog如果用完了，擦出的那一部分会保存到磁盘吗？如果redolog中的内容还没放到磁盘就被异常重启了，会不会丢失？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e2/33/688f6c9c.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>kitty猫</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-21</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，我是数据库新手，有个问题请问怎么解决，如果一个系统比较重要，对恢复库的时间比较敏感，当然是一天一全备最好，可是现在这个库每天备份已经要20小时，而且此系统使用率很高，备份的时候又会加大影响库的性能，该如何是好？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/6f/46/b28d4c45.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>张圆要坚强啊</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，有个问题不太理解，redo  log是存在磁盘中的吗？还是存在内存中？如果是存在于磁盘中，日志满了会再写一次磁盘，会不会影响性能？如果是在内存中，像突然断电这种情况会不会丢失更新？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/48/9e/4f895bfb.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>LyricTian</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师好，我在文章中，看到说，如果redo log被写满了，需要停下来将数据写入磁盘。这个时候，整个数据库是处于阻塞状态吗？当有大量数据涌入的时候，会存在丢失数据的风险吗？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 更新都会被堵住，但是不算数据丢失，因为事务根本就提交不了。<br><br>事务/数据丢失的定义应该是本应该存在的结果没了。但是这时候并没有告知客户端“成功”，也就不算“丢失”</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/f9/03/23706390.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>魔都浪子</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">innodb_flush_log_at_trx_commit为0，sync-binlog为1，刷盘后binlog已经传到了slave，commit后系统crashed，redo日志还没有来得及刷盘，这样会造成主从数据不一致吗？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/JKKWS6TzhncvAA0p0NDiaATPIvMicSM76vNAg9IG1ibibcJYPAiaicYjZfq4gAV8GRtcTpOibfRD8vzqHBtL0ibmhwQsbg/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>唐名之</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师我有疑问<br>1：当binlog写入成功后，系统发生carsh，undo 日志为prepare状态，那么binlog日志和undo日志逻辑不一致？系统重启该如何处理undo日志？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/01/1e/3aa8d7ec.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>柠檬</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redo个人理解为直接写操作记录 <br>binlog 理解为更详细的操作记录，包括更新详细的操作过程。<br>o通过archive log进行恢复<br>mySQL通过binlog进行恢复。<br>不理解的是大的更新语句，如果中断，如何进行回滚</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/3c/fa/e2990931.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>文敦复</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">看到老师评论中有："redolog是循环写的，不持久保存",redolog是在内存中的嘛，一直不持久化？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/88/26/b8c53cee.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>南辕北辙</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师您好，根据我的理解对于一个update 第一个阶段执行器调用引擎还是要去磁盘上找到ID=2这行数据（如果该数据页没有在内存中）。然后执行器进行N+1操作，引擎将这个新数据更新到内存中，并且将数据的更新操作到redo log。我的疑问就是为什么最开始还要去硬盘上去找呢，为什么不在粉板上直接写上ID=2的记录执行N+1,这样连账本都不用去翻了。现在的流程是不是 先是去磁盘上找到ID=2，但是更新完成以后在内存中以及redo log和binlog上，并没有实时的去更新到磁盘上。不知道有没有理解出错，望老师指点。。</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/08/13/68579217.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>M哥</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">为什么满足prepare和binlog完整就是可以恢复的，我理解的是，在redo阶段是找到CK 的LSN开始通过redo日志重做，这个阶段是不管有没有commit都是会重做一遍的，这个时候是包含一部分脏数据的，在crash recovery的undo阶段会通过binlog进行判断是否需要回滚，因为binlog是完整的，所以prepare的uredo日志记录是不会会滚的，也就是说事物已经完成了。这么理解不知道对不对</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/11/00/97770728.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>go</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">写入新行的意思是在磁盘上更新数据吗</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/99/af/d29273e2.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Eliefly</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">两种备份的影响的数据库恢复的时间，一天一备最坏的情况下只要重放一天的日志量，而且在查找开始重放的pos点也更容易，可能只需要找一个binlog文件，一周一备可能已经产生多隔binlog文件。<br>另有个疑问是，把innodb_flush_log_at_trx_commit 和 sync_binlog 都设置为1，这样可以保证最好的一致性，但这样一来不是有两次同步磁盘io吗，就相当于翻了两次账本，这好像比翻一次更影响性能？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/1b/91/66f0d38a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>花生</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">记录一些偏实践的东西：<br>// 配置文件etc/my.cnf中，下边两个参数为redo log单个文件大小 和 这一组有几个文件。如下配置为 一组2个文件，文件默认大小2G。<br>innodb-log-file-size                    = 2G<br>innodb-log-files-in-group            = 2<br><br>//上边配置的log文件位于 var目录中，两个文件命名如下，大小都是2G <br>var$ ll -h<br>-rw-rw---- 1 mysql mysql 2.0G Nov 20 10:58 ib_logfile0<br>-rw-rw---- 1 mysql mysql 2.0G Nov 12 12:55 ib_logfile1<br><br>这两个文件是在硬盘中申请的连续存储空间，配置好的mysql中，redo log会完全占用这一块的存储，所以不论文件中存储多少信息，占用空间都是固定的值2G.<br></div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 👍🏿</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/c9/46/094b06bf.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>菠菜</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">在crash的时候，如果可以对比repo bin 是否同时写入了，算作该条数据是否丢弃的条件，那为何还需要commit呢？是有其他考虑吗</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/cf/e0/f6819d03.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>鹏飞天下</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">默默的问一句，啥时候数据真正的落到磁盘，进去表中？？？是commit之后吗</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不是，“打烊的时候”和“粉板记不下”的时候这类时机</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/5d/7f/f22f9224.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>lzjun</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">按我的理解，redo存储的是这样的信息，“列c原来是1，现在是2”。至于是怎么来的，redolog不知道。而binlog存储的是信息是这条语句的原始逻辑，存储的是“我把表的c列执行了加1操作”这个逻辑，至于最终的值变成了什么，binlog是不知道的，而只有redolog知道</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/86/59/e8f58a2a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>LAMBO</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">两阶段提交听起来有点抽象，是否可以说得更通俗易懂点？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/79/53/3a824aed.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Terry</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">repo log的实现机制听起来像是循环队列。这样就限制了他的使用场景，不能够最为恢复数据的源，因为长度有限。所以恢复数据还的依靠binlog</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/ed/a1/d2953af8.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Together</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">组复制模式下，如果主库有大事务产生，主库在等待从库接收的过程中，不断有新的交易进来，因为主库还没有收到从库的ACK，所以主库无法commit，数据也无法写入数据文件，有可能导致write pos追上checkpoint吗？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/48/a3/d803d383.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>牛牛粑粑</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请问老师，崩溃恢复时，binlog完整是存储引擎判断的还是Server层判断的？个人感觉Server层应该是个无状态的，但是binlog又不是由存储引擎写入磁盘的，那么崩溃恢复时，是谁验证这个prepare状态的写入操作的binlog完整性呢？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/16/22/9c02761b.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>余向华|York</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-20</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">Binlog有两种模式，statement 格式的话是记sql语句， row格式会记录行的内容，记两条，更新前和更新后都有。<br>老师，我这里的疑问是如果是在开启了 statement 模式，也就说，在 server 层就已经完成了日志的备份了，数据库的存储引擎即使不是 InnoDB 引擎，也是拥有着 crash-fresh 能力，即使数据库异常重启了，把 binlog 给恢复，也不会丢数据，这样的理解对吗？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTI0qUU5bc3kVeO0ZTJliau1dHMZglMib72gelIgKXew4RFDdAHsicodWgdaCwSAWetIuVaFwIzb2fFHw/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>刘向伟</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">问一下老师，既然redolog和binlog都是为了保持一次事物的一致性，那么这两个文件写的顺序可以换吗？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/ae/c8/0ca41f70.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>liu</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">话说aurora是不是就只有redolog batch落盘，拿掉binlog</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/e7/b1/5c63be67.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>非礼勿言-非...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">如果binlog写入成功了，提交事务操作将redolog状态更新为commit时失败了或宕机了，这不就成了binlog写入成功，redolog失败吗</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e4/7d/7021c203.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>晓雯</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">既然redo log也可以恢复数据，那为什么都采用全备加binlog的方式？redo log是怎么恢复数据的，有什么限制条件吗？物理方式跟逻辑方式能讲一下吗 老师。</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/87/95/9d7f390f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>肉包肉包.z...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师您好，请问下，真正刷数据空间这个动作，是innodb引擎的行为还是mysql server的行为呢？是以redo-log为依据还是以binlog为依据呢？<br>特指正常的流程，并不是指从节点拉取binlog同步数据的流程。</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/f3/69/7039d03f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>书策稠浊</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">感觉有bin就不需要redo了，请老师指点一下。</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>爱做梦的咸鱼</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">那redo log如果改成追加写是不是就可以持久化了呢，此时如果一直用innodb是否不需要binlog了</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 全是innodb表的话理论上是可以的，不过现在官方还没这么做</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/12/b9/aab42878.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>风中追风</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，我有个地方不是很明白，innodb_flush_log_trx_commit跟sync_binlog的作用分别是将redolog跟binlog写到磁盘，难道默认情况下不是直接将这两个写到磁盘吗？还是这两个日志的内容是在内存里，只有配置了这两个参数才会写到磁盘</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/5c/c5/1231d633.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>梁中华</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">接着高枕的话题继续讨论一下，如果第三步用户不是想commit而是想rollback,但不巧在第三步的时候崩溃了，回复后根据redo log和binlog一致来自动commit?</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 如果用户执行rollback语句，整个事务就放弃了，不会进入“prepare”状态</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83erPLyDtvoV5IZgCic99zfauGySv4ArucibEmmIKugLnhSaOF0csrCriaiaGupwibMJdYs4DtZtKrvvRfEw/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>everyok22</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">有redo log , 那在查询的时候是不是就得读所有的redo log里的数据呢， 数据库是如何保证查询的效率的。索引是在什么时候写入的呢，跟redo log 一起写入的么。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不用，读内存就行了</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/fa/60/74a03dff.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>沙漠不二绿洲</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-19</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">林老师，感谢你让我从未如此清晰的理解了二阶段提交的原理和必要性。有个疑惑checkpoint是指redo buffer落盘的位置，还是指日志更新写到表中的位置（crash recovery的起始点），我在理解oracle的checkpoint是后者的。。就不知道他们俩是否都一样?</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: Write pos是redo buffer接下来要写的位置， crash recovery 的起点就是checkpoint. (Crash recovery起点，这个提法很赞👍🏿</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/cb/ab/1aac53bf.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>董航</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，如果更新了一条数据，数据还在redolog里面，后续根据这个更新数据查询的sql不就获取不到数据了吗</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/cb/ab/1aac53bf.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>董航</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">如果数据一直在redo log里面，那么如何查询最新的数据</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e0/67/6db879e4.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>phantom</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，那如果binlog已经记录，但redo进行commit失败，是否就是“前滚”？通过crash safe能够保证前滚到binlog记录的，redo prepare的状态？<br>另外，对于备份，在存储成本无需担心的情况下dba应该都会选择吧。毕竟追库时间一天以内啦。</div>  <!----></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>eric254</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">mysql的redo log有没有log buffer？对于高并发事务或者批量事务 如何优化redo文件的写入瓶颈？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 有buffer的，事务整个完成才学到redolog文件。redolog是顺序写</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/d9/b0/16b8afd9.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>恺</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师好。原文看了几遍，评论也学习一遍，笔记也做了。现在有几个问题想请教下：<br>1、redolog是固定大小的，譬如4GB，那么数据保存 在内存上 是怎么个体现法（大小，内容，数据结构等）<br>2、评论里的redolog写磁盘写了两次有点不太明白（是持久化一次，checkpoint操作一次吗？）<br>3、redolog里的待checkpoint数据在select操作上完全不理解。。。<br>4、redolog有点类型消息队列MQ（譬如rabbitmq、activemq之类）分担当前写压力；而binlog类似记录入参的格式化后能被执行的log4日志，这么理解对吗？<br>5、能不能组建一个微信群或是qq群，即方便学员交流，也可以把一些比较好的知识点或资料整理到群文件里面（方便大家更深入的学习）。谢谢老师🙏🙏</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 1.  后续文章会介绍到<br>2. Prepare写盘一次，commit写盘一次<br>3. 在内存里是对的<br>4. 有点近似，不是很精确哈<br>5. 我比较建议在评论区中讨论，这样大家都能看到，群的人数还是受限</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/0e/61/ae68f8eb.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>dream</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redo log  和  binlog  分别在什么位置呢？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e4/47/7d148d39.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>小娇</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">弱弱地问一句：老师，为什么binlog没有crash-safe的能力呢？不是写磁盘了吗？可以在重启后把宕机前的binlog中记录下来的异常事务sql语句执行一遍？<br></div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 一开始没这么设计，实际上现在的binlog也不够，奔溃恢复需要日志和引擎内存状态配合的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e5/39/951f89c8.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>信信</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师介绍了不用两阶段提交引发的不一致的的问题，但是没详细介绍用了两阶段提交，具体怎样工作的。看资料说是，崩溃恢复时，处于prepare 的事务会去查binlog ，如果有就继续提交事务，然后会去补充相应的redo log 。还有一点说的是prepare 标志记录在undo  log ，请老师指正。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 是这样的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/45/64/2b09a36b.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>风二中</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">林老师，好，有几个疑问：<br>1）文中‘’update 语句执行流程‘’示意图，是先修改数据，在记日志。不应该是先写日志（生成重做日志），在修改数据（缓存里）吗？<br>2）redo log两阶段提交具体是怎么实现呢？我理解就是直接记录哪个页面做了什么修改到redolog（硬盘日志文件）就结束了，已经落盘了，prepare，和commit怎么理解呢<br>谢谢了</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 1. 这两个其实是交叉发生的（对于一个有多次更新日志的事务来说），所以可以忽略先后。关键是他们都在“把日志写入redolog物理文件之前<br>2. 有了binlog, 需要两阶段</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/d9/b0/16b8afd9.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>恺</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师您好。如果有些基于MySQL文件系统的章节就好了，这样有利于“软硬”的结合。把每一块砖头都弄结实了，整体方能更坚固，不是么？!</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 慢慢来哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/87/c4/50c8a490.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>陈逸</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师你好，请教您一个问题，是实际工作中遇到的，就是在大数据量高并发情况下，如何保证实时表数据的无延时更新？具体场景是在车联网的一个项目里，车辆每30s上报一次数据，共有将近20万辆车，通过网关采集到这些数据后，经过解析器处理再入库，hbase和mysql各写一份，hbase作为历史数据存储库，mysql作为实时数据存储库，这些实时数据首先被垂直拆分成了将近十张表，然后每次有新数据上报都是直接根据车辆唯一vin码进行更新，使用replace语法，模拟测试的时候10万辆车就出现消息堆积和延时了，mysql是部署在32核128g的云服务器上，做了主备。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 10万辆一起发的话就是要求10万的TPS，估计只能拆了…</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>刘赛</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请教下，如果在binlog写入成功后出问题了，redo log 就没有进行commit了，此时系统是什么状态呢</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 崩溃恢复后事务提交。如果你是指这个瞬间，那就是“事务未完成”状态</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAibnPX9jW8kqLcIfibjic8GbkQkEUYyFKJkc39hZhibVlNrqwTjdLozkqibI2IwACd5YzofYickNxFnZg/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Sinyo</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，innodb_flush_log_at_trx_commit这个参数设置成 1，是不是等于binlog的归档了呢？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不是，这个但是是控制redolog的。 binlog存起来就有“归档”的功能</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/f9/03/23706390.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>魔都浪子</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-18</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redo日志在prepare阶段之后就已经刷盘啦？我按我的理解，innodb_flush_log_at_trx_commit 应该是控制在commit之后才会写磁盘啊？如果是没有问题，如果不是，binlog刷盘后是无法保证redolog刷盘的。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这个prepare已经是在你执行“COMMIT”语句里面了</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/7d/40/92bb705c.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>below zero</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">那个备份的问题，应该还是根据恢复时间快慢的需要来决定是一天一备还是一周一备。</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>kghch</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">数据库可用性，即宕机时的恢复速度</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/00/52/d1a1d0ab.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Jason 彭</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">影响的是RPO，一个是一天，一个是七天。请问老师，这个问题中，备份周期的设置是通过什么实现的？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这个是外部备份系统的工作</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/1NMAMj2T81BGLJhsnJ7IZL9BeP6LoX6ajukkTKficABoStaE6mAFHBibRQ3HiaG3VNJibVtqQy5m9RMibGfic62yibd7g/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>kali</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">1:取Id=2这行，是怎么知道这一行属于哪一个数据页的？<br>2:redo是记录某个数据页内容的变化？<br>3:binlog在row格式时，一直不明白是怎么记录的</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 1. InnoDB内部管理<br>2. 是<br>3. 这个我补充到答疑文章里面哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/73/16/e8a1de30.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Yang</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，我理解Redo log和Binlog都是记录数据页的变化，他俩最大的区别应该是Redo log是固定大小循环记，而Binlog是达到指定大小后归档这一点吧。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不是，  binlog做不到的</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>娃哈哈</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">如果多个并发修改都未提交时，数据库崩溃了，这个时候有多个redolog的prepare和binlog的记录已经完成，但是还没有提交，这时重启后会怎么操作呢？innodb会通过binlog和prepare成对，然后去commit吗？那客户端会收到事务完成的通知吗？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 客户端肯定是收不到了， 但是还是会commit</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>vo1d</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师你好，自学编程，刚接触mysql，最近碰到些问题想请教下老师。<br>1)我的数据表设计 id user ud,先做个多线程拿号登陆的功能，未避免拿到重复的号码，我百度到使用UPDATE $db SET ud=1, id=LAST_INSERT_ID(id) WHERE ud=0 LIMIT 1  ；SELECT user FROM $db WHERE ROW_COUNT()&gt;0 and id=LAST_INSERT_ID()；这两句来取号，但是效率很低，数据一大，mysql还容易崩溃。请问有更好的方法吗？谢谢。<br>2)我的第二个项目数据表设计 id user  info。数据利润  1，user1，1001;1002;1003。我想查询包含1001的数据，用like的话，数据少的话还可以接受，当百万数据的时候，就会很卡很慢。想请教老师有其他的方案吗？<br>新手，可能问题比较low，期待老师的解惑，谢谢。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 1. 你这个做法不好，应该先insert,拿到的这个last_insert_id就行<br><br>2. 如果有这种需求，最好不要把这些拆成单行。 或者创建另外一个表单独维护包含“1001”对应的集合</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/95/46/14cee147.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>hbprotoss</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">先写 redo log 后写 binlog 这个场景，个人感觉表述可以再修改一下。如果redo log先提交，那么主从复制的情况下，主库恢复是没问题的，但是由于没有binlog，从库数据就不一致了</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er17O1Y2B8WibUQgQDibrVvTPqwF6dF6bKJLWE7gg2M2mEgZ5cHicn6KUJYHp9gmJfuP4bqshCUxfnGA/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>凉快</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">有一段不太懂：<br>具体来说，当有一条记录需要更新的时候，InnoDB 引擎就会先把记录写到 redo log（粉板）里面，并更新内存，这个时候更新就算完成了。<br>这里所说的，并更新内存，值得是更新内存里面的数据吗？ 即id为2的数据，<br>另一个问题，按照前面所讲的分区，那内存里面最大存储的数据量是否为4个G？（即，老板一直没时间写入账本，小黑板记录的最大数据量）</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 1. 对，更新内存<br>2. 粉板记录的最多的更新记录是4G。 我们说的内存是放数据的内存，就是buffer_pool的大小</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/53/68/593703a5.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>dev4mobile</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">有没有这样的命令dump日志得到查询历史SQL语句？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 更新在binlog里面有记录，用mysqlbinlog工具可以，仅限更新语句</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/5c/89/f7fff085.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>张双星</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">我想问下，定时备份也是通过执行当前时间到上一次备份时间之间的binlog来完成的吗？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这个其实也是一种做法，不会大家用的更多的还是直接找个备库再全量备一次</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/89/e1/2f3cc2d6.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>布衣</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，redo log是prepare状态，写binlog时crash；以及binlog写成功，但是redolog更新为commit状态时crash；重启后的回复机制又是怎么做的呢？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 第一个回滚，第二个事务有效</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/5b/72/4f8a4297.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>阿May的海绵...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">1.单独依靠redologo无法做到指定某一点的恢复，是不是因为redologo是循环写的，如果要恢复的那一时刻被擦掉了，就无法知道这点的数据变动轨迹，而binlog是追加的方式，在文件完整的前提下，数据的变动轨迹都可以知晓？<br>2. 最后三步是 ①引擎写redolog，并处于prepare状态   ②执行器写binlog，成功后，发送commit<br>&nbsp;&nbsp;&nbsp;③引擎刚写入的redolog改变为commit状态<br>&nbsp;&nbsp;如果crash发生后  redolog =prepare   binlog没有对应写入记录，则回滚<br>&nbsp;&nbsp;如果crash发生后  redolog =prepare  binlog有对应写入记录，则提交<br>感觉有点像  1 &amp;&amp; 1= 1   1&amp;&amp;0=0   0&amp;&amp;1=0<br>3.binlog模式  ①记录sql语句    ②记录更新前后的行     一般是用哪种模式？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 1 对的<br>2 对的👍🏿<br>3 建议使用row格式，就是第二种</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/01/0c/72905a3a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>宇锋</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请问<br>1 binlog成功之后，更新redolog状态为commit出错了，好像还是会出现不一致。<br>2 可以说一下binlog的归档是什么意思?比如stament模式，他只是记录了原始更新sql,那他含有什么归档信息呢？</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/06/df/d0fe2300.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>刘文韬</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请问林老师，新行更新到内存与写redo log之间怎么保证一致性？如果在默认隔离级别（可重复读）下，是否此时的更新是写一块新内存？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 下一讲就讲MVCC😄 等周天晚上哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/f9/03/23706390.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>魔都浪子</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">“update 语句时的内部流程”中的步骤4后系统崩溃，产生的效果不是跟后面举的例子先写binlog后写redo log一样嘛？也就是说binlog已经写入磁盘，但是没有commit的时候发生crash，那么redolog没有机会写入磁盘，这样两阶段一样会产生两种不一致的日志。</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/f4/94/13379a7f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>肥龙</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，前面说的 “如果 write pos 追上 checkpoint，会擦出一部分数据”<br>擦出数据的多少的衡量标准是什么？也就是说，如果 write pos赶上了checkpoint，会擦出多少数据？这个是配置决定？还是mysql会随机擦出一部分？<br></div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/86/e3/28d1330a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>fsj</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师与同学在留言区互动真是太赞了，数据库小白用户也能看懂很大一部分，赞赞赞</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/fe/75/46742f12.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>liao xueqia...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">个人理解，redo包含已提交和未提交的数据，而binlog只包含已提交的数据，请老师确认</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Ethan</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师我想问一下为什么update的时候要把这个表所有的缓存都清空而不是只把更新的条目失效掉？</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/df/b3/4860a6bc.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>高小强</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">通俗易懂，期待老师下一篇的分享！</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e2/ff/ca3dec06.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>狗蛋</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-17</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">5.7不是已经改了吗？prepare阶段写redo log改到binlog三阶段写的flush阶段了?</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这个是实现上的，逻辑上的这三个操作都还在</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Nick</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">在一个大事物或长事物里，一边执行sql一边写redo log吗？未提交的事物也会写到redo log file吗？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 会先写一块内存，叫做log_buffer里面，在提交的时候再一次性写到磁盘</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/22/8a/93ee037f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Oren</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">讲的很好。👍</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/f8/b5/82b64369.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>阿涛</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">如果更新写入redolog后处于prepare状态，此时系统突然断电，那么binlog没有写入记录，重启后数据库的实际数据根据redolog更新了，但与binlog的语句记录不符，那么binlog怎么办？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不会，这时候事务会回滚，binlog也没有，所以是一致的</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Nr8o80t7TVwlXk7eoFYQpknWiayM5NbWKSf4DicTmYxGSoKoUwNurxjvDflgpZu6I9ChWdNr14gbABgq1ibP2cvWg/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>悟空</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">留言太多了，老师可以过滤下吗？把比较集中的代表性的问题，放出来</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 我觉得这些还是应该发出来。不过你可以选择一下，编辑会把好的评论和答复置顶。</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/f9/fa/62682d86.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>DotaSeven</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，我想模式redo_log成功，bin_log失败；或者反过来。该如何模拟呢？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这个稍微有点麻烦，最直接方法是GDB，停在两个函数中间，然后coredump出来</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/45/b4/ec66d499.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>oscarwin</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，还有一个疑问，update后先写入内存，然后写redo log，那么写入的这条数据在内存中的驻留时间是怎么处理的？是redo log写入磁盘后从内存中删除吗？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不会删除，除非内存不够用。不过在数据从内存删除之前，系统会保证它会被更新到磁盘数据上</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/45/b4/ec66d499.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>oscarwin</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">对思考题说说自己粗浅的理解，如果业务数据量非常大，那么一天一备要比一周一备会更好，因为一天一备相当于把备份的压力分散了，如果全部集中到一周后备份，那么备份的压力会很大。如果业务数据非常重要，一天一备也比一周一备更好，一旦出现了binlog日志被损坏的情况，最多也只丢失了一天的数据。但是，我感觉备份只要有binlog日志就可以，这样不需要占用主库的资源就可以完成备份，所以备份会影响哪些指标还思考不到</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/7a/0a/0ce5c232.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>吕</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">两步提交法，如果在binlog执行完crash，那这时事务处于未提交状态，是prepared的状态，这样会不会也导致恢复的时候数据不一致？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这时候是算提交成功的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/00/4e/6a23251c.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>小智e</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">那为什么两次提交可以确保一致性呢？小白勿喷</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这样问题比较难回答哈，你可以先理解下文章里面的反证的例子，返回想一个两阶段的崩溃的例子，看看哪里没想清楚再提出来</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/7a/0a/0ce5c232.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>吕</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">你好，关于提到的'数据页'这个词我没有太理解，是一种存储方式么？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: MySQL的记录是以“页”为单位存取的，默认大小16K。也就是说，你要访问磁盘中一个记录，不会只读这个记录，而会把它所在的16K数据一起读入内存</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/57/6e/dd0eee5f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>夜空中最亮的...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师写的很棒，收获很多，真的赚到了。</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/69/c6/a591b02a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>强哥</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0"> 一句话，redo日志用于保障，已提交事务的ACID特性。同时随机写改为顺序写，提升性能。这里缺少undolog的讲解吧？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 是，undolog在后面一篇：）</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/f7/9d/be04b331.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>落叶飞逝的恋</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">还有这两种日志可以在哪直观查看</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 都是文件，在数据库的data目录下，默认的，redolog是ib_log_file0这样的，binlog是xxx-bin.000001这样的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/f7/9d/be04b331.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>落叶飞逝的恋</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">一天一备份相比一周一备份而言，更加可靠。发生数据库异常，可以快速恢复。</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/f2/83/f2b7036b.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>lucia</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">讲解得很透彻</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>yy</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师 我想请教一下 两个控制日志写磁盘的性能参数 如果都设置1 会不会对io影响很大 对大并发也要设成1吗</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 一般这两个都建议设置成1（有时候称双1），除非你的系统IO撑不住了要临时应急</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/11/60/abb7bfe3.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>ThinkingQues...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">两阶段提交这块看的不是很明白。<br><br>那个过程4之后写入binlog之后如果系统crash了，没有把redo log标记为commit的话，它会怎么样呢。 处在prepare状态下。 <br><br>两阶段提交这个东西，在分布式理论中看到过多次，反复考虑它的过程，始终觉得并不能保证一致性啊。<br>求解答。<br></div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 崩溃恢复后算成功</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/14/5d/3870280f.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>极客童</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">我有个疑问，按照正常的两步提交，先写redo log，回来写bin log，然后再commit的时候故障重启没成功，这时候不是也会导致两者日志不一致的问题吗？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 不会的，看一下置顶文章的评论哈</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/10/8d/43edb2dd.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>守着云开</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">binlog里面有了 崩溃恢复的时候 redolog就会认可这个事务 这与binlog用于恢复数据的目的一致  可以这样理解吧</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 对</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83epfVZHmbUnsxU67FwotibOjM0Obc47VWMyRBmY06AjqTp0C96A8zhUULWjBerK3XtPC7Q8LVClzPxA/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>尼古拉斯·赵...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">在RTO上一天一备会比一周一备更有优势</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/14/00/e9/00fd2bd3.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>五云天北是神...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">坐等老师讲一讲详细的crash_recovery，尤其是undo和binlog对比事务链表的回滚那部分。谢谢</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 会在《MySQL重启一次要多久》里面提到，不过更多还是指出有这些过程，应用怎么处理… </p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/15/9f/44a9f51b.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>华仔</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">没有听懂两阶段提交的意思？是指阶段状态的提交，还是指redo日志的一次提交加binlog日志的一次提交呢。<br>是redo日志的两次状态提交么？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这个命名来源于redolog提交分成了两阶段</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/fa/32/04056740.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>©w©</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">有個疑問: pos和checkpoint的位置一開始是怎麼確定的呢?checkpoint什麼時候移動呢?應該怎麼移動?移動多少？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 一开始就是从头了，中间如果有重启，也从重启前的位置继续。 <br><br>移动就是向右，到末尾循环；<br><br>移动多少 取决于事务要写下多少的日志</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e7/7b/71da8283.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>似水流年</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">binlog感觉像oracle的归档日志，那么也有设置binlog日期的参数，这个参数是？默认值又是多少？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: expire_logs_days<br>默认是0 表示不自动删除；非零的话，单位是天</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/7f/88/c4263c58.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>五年</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">redo log 满血复活是怎么做到的呢.如果数据库 crash 掉, redo log 是保存到 crash 之前的最后一次提交, binlog 也是; 这时候数据库恢复的话,数据库本身为什么会丢什么数据呢...</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这样不算丢数据呀</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/DYAIOgq83er6NXib2NGaTAAEe2KCcibH2FiafOOD73kQdcuAMGrnRib5CDWXum0SWDOM9NnWicbUsDpghmxEmJtpk9w/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>tchz</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，假如有一条sql要把c的值从0更新为1，如果已经记了redo log，但是还没有记binlog，这个时候MySQL崩掉了，恢复的时候，存储引擎发现记了redo log,但是没记binlog，存储引擎会把事务回滚，也就是数据库里记的值还是0。如果server记了binlog，但是还没来得及提交事务，那么crash recovery的时候会把这个事务提交，那么数据库里的值就是1。是这个样子的吗？还有一个问题就是，如果是这样子的，因为redo log是引擎层的，binlog是server层的，那么他们之间是怎么交互的？如果不是这样的，那mysql的crash recovery是怎么做的？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 是你说的这样。<br><br>他们是在同一个执行流程里“按顺序执行”，这么交互的😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/32/23/5de4b29a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>滴答</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">有两个问题想请教老师：<br>1、redolog记录更新日志，当更新完一个表之后再进行查询，此时会将这个表的redolog刷到物理表中再进行查询吗？如果不是的话是如何保证数据最新？<br>2、数据恢复是以binlog的记录为准吗？如果要考虑redolog，那redolog如何帮助恢复？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 1. 不会。就直接从内存读走，内存是对的就行<br><br>2. 用binlog是用在备份恢复到过程中，这个过程就是用全量备份+binlog,你可以认为没redolog的帮助</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/de/29/71685b0b.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>BigMortal</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">那么在什么场景下，一天一备会比一周一备更有优势呢？或者说，它影响了这个数据库系统的哪个指标？<br>回答：故障发生，需要快速恢复，一周一备，需要应用一周的binlog，恢复时间会相对较长；不知道我的理解时候正确</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/4b/bc/86a9ac70.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>如是</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，既然通过binlog就能恢复数据，为什么还要用redolog？只是重启的时候需要根据备份数据再执行一次binlog,启动可能会耗时，但是大部分情况下都是正常的，这种情况也可以根据备份数据和binlog合并来适当减缓这个问题，不知道我的理解是不是哪有问题，还是redolog还在别的操作上使用。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 看一下置顶回复</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/07/c2/9066aee8.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Kam</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">感觉很深刻。评论也有干货。</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 谢谢表扬😄<br><br>嗯评论区我觉得是个很好的地方。有些点在正文展开就会打乱整体思路，不能无限细节；<br><br>评论区就是针对细节的，刚好补充</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAibnPX9jW8kqLcIfibjic8GbkQkEUYyFKJkc39hZhibVlNrqwTjdLozkqibI2IwACd5YzofYickNxFnZg/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Sinyo</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，是不是只能用bin log或redo log其中一个日志对数据库进行还原？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 置顶回复中说明了，看一下</p></div></div></li><li class="reJj6Thl_0"><img src="data:image/jpeg;base64,/9j/4QAYRXhpZgAASUkqAAgAAAAAAAAAAAAAAP/sABFEdWNreQABAAQAAABkAAD/4QOBaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLwA8P3hwYWNrZXQgYmVnaW49Iu+7vyIgaWQ9Ilc1TTBNcENlaGlIenJlU3pOVGN6a2M5ZCI/PiA8eDp4bXBtZXRhIHhtbG5zOng9ImFkb2JlOm5zOm1ldGEvIiB4OnhtcHRrPSJBZG9iZSBYTVAgQ29yZSA1LjYtYzE0MCA3OS4xNjA0NTEsIDIwMTcvMDUvMDYtMDE6MDg6MjEgICAgICAgICI+IDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+IDxyZGY6RGVzY3JpcHRpb24gcmRmOmFib3V0PSIiIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6YWE3YmZhMDItMzBhMC00MDg3LTg3MmYtOGMwMjMxNjNhZWRjIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOjk2MkUzQjA0QURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjk2MkUzQjAzQURCODExRThBRTUyQzg5RkRENTk1MzAzIiB4bXA6Q3JlYXRvclRvb2w9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE1IChNYWNpbnRvc2gpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Yzc5YTE0Y2UtYjA1Yy00NjkzLWEyZWYtOTFmOGJjNzQxNzY5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOmFhN2JmYTAyLTMwYTAtNDA4Ny04NzJmLThjMDIzMTYzYWVkYyIvPiA8L3JkZjpEZXNjcmlwdGlv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" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>爸爸回来了</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">恢复数据时，根据全量所在的pos开始由binlog恢复。假设你周天做恢复，使用的是周一的备份。那么你有周二周三周四周五周六的binlog要恢复。这个过程是可以很感人的(ಥ_ಥ)</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 作者碰到一个月一备，要跑20多天日志的，了解一下😭</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/a1/4b/254480d3.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>石建磊</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">两阶段提交那里不太懂，我理解是不是只要binlog保存成功，数据就能恢复，redolog 是不是就为了加快innodb引擎的写速度的?</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: Binlog写完就算，但是并不是用binlog恢复，恢复这个工作还是innodb做的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/cf/5c/d4e19eb6.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>安小依</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">更新完内存以后，mysql 会直接返回给客户端吗？还是说会等待 commit 成功才返回</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 必须等commit完成后</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/4f/78/c3d8ecb0.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>undifined</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师 如果 binlog 或者 redo log 在写入磁盘的过程中故障了怎么保障数据一致</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 整个事务回滚，数据也没有，日志也没有，也是一致的</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/Q0j4TwGTfTJAibnPX9jW8kqLcIfibjic8GbkQkEUYyFKJkc39hZhibVlNrqwTjdLozkqibI2IwACd5YzofYickNxFnZg/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Sinyo</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师以后可以提及一下BRIGHTHOUSE引擎么？谢谢！</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这个专栏应该不会涉及，主要涉及的还是大家碰到比较多的问题和概念</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e9/8e/6dc15a91.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>晨思暮语</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">丁老师你好，有个问题请帮忙答疑？就是如果innodb_flush_at_trx_commit与sync_binlog都是非1情况下，prepare阶段如何处理redo log，谢谢！</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 处理是一样的，只是不是1，会不会每次写完直接强制落盘</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/36/d2/c7357723.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>发条橙子 。</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，我现在有点搞不懂 mysql 缓存机制和 innodb缓存机制的关系 ，以及   redo日志也有缓存，如果在缓存中还没同步到 redo 日志里的时候，mysql 发生的 crash 时，是否更新记录就真的没了</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 会没了，但是没关系，因为redolog都没写完，表示你事务还没提交，中间出了错，本来就应该没的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e7/7b/71da8283.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>似水流年</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">是否在redo没写时重启数据库，会使事务丢失？这个交易也失败。怎样情况重启会出现数据库数据不一致呢？oracle都存在重启后数据不一致的情况。数据不一致后怎么恢复？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: Redolog没写，这个不算丢数据的。交易失败是预期的，也应该这样处理。就靠业务重试</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/34/5c/6b4757a0.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>倪大人</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">关于redolog prepare之后发生意外，通过binlog恢复时怎么处理的问题，我理解是这样的：通过binlog恢复时默认会把binlog中未提交的记录提交一下，这样这部分数据binlog跟redolog就对得上了。如果binlog中没有记录，redolog中未提交的记录会回滚，相当于这一次更新失败，这样两边也能对得上了。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 默认会把binlog中未提交的事务，稍微改一下，写成“默认会把binlog中已经完整写完的binlog事务” 。<br><br>嗯嗯解释很到位</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/5e/c1/cd721d46.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>_yiunia##...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">"前面我们说过，在一个表上有更新的时候，跟这个表有关的查询缓存会失效，所以这条语句就会把表 T 上所有缓存结果都清空。" 感觉不准确。。MySQL5.6开启缓存，第一次查询时间很长，第二次查询命中缓存时间很短，随意修改一行updated 时间，再次查询时间仍然很短。何解？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 恐怕是innodb buffet pool发挥的作用😄</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/47/65/cce8eb34.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>nimil</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">对于数据丢失时的恢复速度，如果一周一备相对于一天一备来说恢复速度肯定是要慢的，如果数据每天更新量不是很大，可以选择一周一备</div>  <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/f1/5f/6ac1c883.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>张良</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">回答上面李提出的问题：始终记住一点它们两个pos都是朝一个方向，按照一致的路径循环的。按图中所示，可写空间是从write pos到3，加上从0到check pos</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 👍🏿到位</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/12/78/e4/7978869e.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>对方正在输入...</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">回答问题：<br>1如果没有主从，无Binlog Server，建议至少每天一备份，库很小并发少，可以缩短备份周期，例如每小时备份一次。<br>2如果有主从，有Binlog Server，建议至少每周备份一次，库较小并发不算高，可以缩短备份周期，例如每天备份一次。<br>这里不区分有主从无Binlog Server的情况，是由于重要系统建议至少搭建主从复制，尽可能搭建Binlog Server(金融环境尤为重要)。</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 条理清晰的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/e2/cb/6bc95e09.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>喔～</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师，有点疑惑请教一下<br>对于 deferred 写操作，通过redo 来实现事务<br>对于 in-place 写操作，通过undo 来实现事务<br>那么对于redo与undo共存的日志体系，其目的与应用场景是怎样的？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: Redo和undo都在支持事务的，undo用于支持事务的隔离性（下一讲会介绍），redo支持持久性</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/14/50/c23cf47d.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>李</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">wirte pos 是当前记录的位置，一边写一边后移，写到第 3 号文件末尾后就回到 0 号文件开头。checkpoint 是当前要擦除的位置，也是往后推移并且循环的，擦除记录前要把记录更新到数据文件。<br><br>write pos 和 checkpoint 之间的是“粉板”上还空着的部分，可以用来记录新的操作。如果 write pos 追上 checkpoint，表示“粉板”满了，这时候不能再执行新的更新，得停下来先擦掉一些记录，把 checkpoint 推进一下。<br>这个看不明白，按上图看的话，是不是画反了，不然已经超过检查点好远了？<br>如果没画反，检查点不是应该擦掉检查点之间的数据吗，那和写点之间的距离就是刚写过的，怎么可以用来记录新的？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 看一下置顶评论哦</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/11/9b/ba/333b59e5.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Linuxer</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">请问用redolog恢复时还写binlog吗？反之呢？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 崩溃恢复过程不写binlog了，用binlog恢复实例（或搭建备库）的时候，是会写redolog的</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/e0/22/18aa3672.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>涂涂的爸爸</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">你好，这篇讲到了redo log 和binlog，后面会不会补充下bilog的组提交以及并发复制呢？感谢！</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这个专栏这类会涉及比较少，这个专栏我们会更偏“业务应用 和 与应用相关的原理” binlog组提交太底层了，对开发几乎完全透明…</p></div></div></li><li class="reJj6Thl_0"><img src="http://thirdwx.qlogo.cn/mmopen/vi_32/0FI2bUjegtznv7XPC9DB9RJaqiaMiamWkibibPOibuUC3DCvI7XMvBANr6sDjRNbc1jwPic9pIaFxrdaib88VqUJKXSTQ/132" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Chenl07</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">前面我们说过，在一个表上有更新的时候，跟这个表有关的查询缓存会失效，所以这条语句就会把表 T 上所有缓存结果都清空。<br><br>老师，这里所有缓存清空，包括数据缓存吗？</div>  <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 这里说的清空的就是所有跟这个表有关的query_cache</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/13/fe/68/e0bebd9a.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>高枕</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">老师最后留的问题 是不是会影响到binlog的指标？也就是说，如果一天一备，那么binlog就可以不用保留一天之前的信息了</div> <!----> <!----></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/10/c5/14/7f165bfe.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>@周祥兴</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">双写这个没有出现</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: 嗯这个比较底层，运维开发基本无感知，怕展开太多。（其实这篇正文内容已经多了😁</p></div></div></li><li class="reJj6Thl_0"><img src="https://static001.geekbang.org/account/avatar/00/0f/ab/10/b812ff3e.jpg" class="_2273kGdT_0"> <div class="_2CG0SquK_0"><div class="_304R4gla_0"><div><div class="_18Dng5rT_0"><span>Hesher</span> <!----></div> <div class="_1H1Z49Dr_0">2018-11-16</div></div> <div class="_2eMTs2JE_0"><div class="_2P4B1Hdm_0"><i class="iconfont"></i> <span class=""></span></div> <!----> <!----></div></div> <div class="_3M6kV3zb_0 _3D2NkqD6_0">当一周内redolog容量超过4G？</div> <!----> <div class="_2xNIY4NG_0"><p class="_33BLbmw4_0">作者回复: Redolog循环写，一周写超过4G没问题。 你要再看一下文章哈。</p></div></div></li></ul></div></div> <!----></div> <!----></div></div> <div class="_2sRsF5RP_0"></div></div><link rel="dns-prefetch" href="//cdn.mathjax.org"><script type="text/x-mathjax-config">MathJax.Hub.Config({
        showProcessingMessages: false,
        messageStyle: "none",
        tex2jax: {
          inlineMath: [['$','$'], ['\\(','\\)']],
          displayMath: [ ["$$","$$"] ],
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code', 'a']
        }
      });
      MathJax.Hub.Register.MessageHook("End Process", function (message) {
        var eve = new Event('mathjaxfini')
        window.dispatchEvent(eve)
      })</script><script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-103082599-6', 'auto');
      ga('send', 'pageview');</script><script>var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?022f847c4e3acd44d4a2481d9187f1e6";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();</script><!----></body><iframe id="__ToutiaoJSBridgeIframe_SetResult" style="display: none;"></iframe><iframe id="__ToutiaoJSBridgeIframe" style="display: none;"></iframe>